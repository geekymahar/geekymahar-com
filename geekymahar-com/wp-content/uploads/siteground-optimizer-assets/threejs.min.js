!function(b,a){"object"==typeof exports&&"undefined"!=typeof module?a(exports):"function"==typeof define&&define.amd?define(["exports"],a):a((b="undefined"!=typeof globalThis?globalThis:b||self).THREE={})}(this,function(a){"use strict";var gi,fQ,bA,dc,cN,cM,de,dm,bK,cQ,dq,L,dA,C,fz,fy,D,gw,cx,bT,ct,cs,aw,cr,cd,aK,Y,bi,bX,fx,fw,fv,fu,ft,fs,fr,fq,fk,fh,ch,cf,dL,bn,bm,cg,ek,ff,aR,dM,fb,fa,gx,gy,gA,dR,cj,bh,eW,E,cq,bW,eL,l,c,Q,bd,iv,q,aI,ix,G,b,eJ,gL,aF,aA,cA,ez,by,bP,ce,aX,aP,ba,cI,ep,er,a_,iF,aO,ay,eu,es,aU,ew,eq,ex,bG,o,bF,_,iG,iI,aG,eo,R,en,gO,gR,eE,iW,gX,bz,aD,d_,cG,i_,jd,g_,hj,hk,jx,ho,eK,jt,jr,am,ab,ax,eX,av,bL,bM,hK,eY,fd,fe,ai,hv,af,dI,e,fo,iV,s,dz,iT,iS,al,fH,bU,P,cw,B,hF,bR,fJ,aM,aL,aJ,fN,fP,fR,c$,c_,cZ,cY,cX,cW,fV,cT,bf,hH,bB,fS,bQ,dd,cF,cB,n,d,Z,hL,iu,it,hM,gI,hN,hO,hP,hQ,ev,jg,jp,jz,jA,iK,gu,gt,fp,b_,bu,cm,bZ,bY,bS,cC,gs,dv,cE,dn,gp,fF,go,dh,gn,gm,gk,gj,ib,gf,ge,hY,f$,gH,em,cR,ga,gb,gc,fU,cV,gg,gh,gl,fM,dg,dj,dE,ca,dJ,aT,cS,dN,dO,e$,cc,eZ,iA,aB,bg,jR,dU,dV,co,dW,cu,cv,ea,eb,ed,ee,eg,eA,J,iR,u,bt,hU,aa,dP,fc,fi,fj,fB,hG,fY,iX,iY,hD,hC,dD,hy,fm,hs,hr,hq,bc,hp,jq,be,js,eS,bo,hn,jw,bp,jy,hm,jB,jC,eI,jE,jj,jG,jH,jI,jJ,jK,jO,hh,ju,jo,hc,ha,g$,dY,gZ,gY,i$,aV,d$,eH,gW,iO,iN,gV,gU,iM,gT,iL,gS,eh,gP,iJ,el,x,iH,et,gN,aH,dX,gK,iE,iD,gJ,iC,gG,gF,iz,iy,ah,gE,gD,cy,an,bb,ir,eM,eQ,ck,gB,dQ,gz,e_,bk,bO,gq,id,ip,ij;void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(a){return"number"==typeof a&&isFinite(a)&&Math.floor(a)===a}),void 0===Math.sign&&(Math.sign=function(a){return a<0?-1:a>0?1:+a}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){var d,b,a,c;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(d=Object(e),b=1;b<arguments.length;b++)if(a=arguments[b],null!=a)for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d}),gi=function(c){var b,y=Object.prototype,d=y.hasOwnProperty,p="function"==typeof Symbol?Symbol:{},h=p.iterator||"@@iterator",D=p.asyncIterator||"@@asyncIterator",m=p.toStringTag||"@@toStringTag",A,E,B,j,a,t,u,i,f;function g(a,b,c){return Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}),a[b]}try{g({},"")}catch(a){g=function(a,b,c){return a[b]=c}}function w(d,b,e,f){var g=b&&b.prototype instanceof q?b:q,c=Object.create(g.prototype),h=new o(f||[]);return c._invoke=function(d,e,b){var c=A;return function(i,k){var h,g,f;if(c===B)throw new Error("Generator is already running");if(c===j){if("throw"===i)throw k;return v()}for(b.method=i,b.arg=k;;){if(h=b.delegate,h)if(g=z(h,b),g){if(g===a)continue;return g}if("next"===b.method)b.sent=b._sent=b.arg;else if("throw"===b.method){if(c===A)throw c=j,b.arg;b.dispatchException(b.arg)}else"return"===b.method&&b.abrupt("return",b.arg);if(c=B,f=r(d,e,b),"normal"===f.type){if(c=b.done?j:E,f.arg===a)continue;return{value:f.arg,done:b.done}}"throw"===f.type&&(c=j,b.method="throw",b.arg=f.arg)}}}(d,e,h),c}function r(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}c.wrap=w,A="suspendedStart",E="suspendedYield",B="executing",j="completed",a={};function q(){}function l(){}function e(){}t={},t[h]=function(){return this},u=Object.getPrototypeOf,i=u&&u(u(s([]))),i&&i!==y&&d.call(i,h)&&(t=i),f=e.prototype=q.prototype=Object.create(t);function x(a){["next","throw","return"].forEach(function(b){g(a,b,function(a){return this._invoke(b,a)})})}function k(e,b){function a(k,j,f,g){var h=r(e[k],e,j),i,c;if("throw"!==h.type)return i=h.arg,c=i.value,c&&"object"==typeof c&&d.call(c,"__await")?b.resolve(c.__await).then(function(b){a("next",b,f,g)},function(b){a("throw",b,f,g)}):b.resolve(c).then(function(a){i.value=a,f(i)},function(b){return a("throw",b,f,g)});g(h.arg)}var c;this._invoke=function(e,f){function d(){return new b(function(b,c){a(e,f,b,c)})}return c=c?c.then(d,d):d()}}function z(d,c){var g=d.iterator[c.method],f,e;if(g===b){if(c.delegate=null,"throw"===c.method){if(d.iterator.return&&(c.method="return",c.arg=b,z(d,c),"throw"===c.method))return a;c.method="throw",c.arg=new TypeError("The iterator does not provide a 'throw' method")}return a}return f=r(g,d.iterator,c.arg),"throw"===f.type?(c.method="throw",c.arg=f.arg,c.delegate=null,a):(e=f.arg,e?e.done?(c[d.resultName]=e.value,c.next=d.nextLoc,"return"!==c.method&&(c.method="next",c.arg=b),c.delegate=null,a):e:(c.method="throw",c.arg=new TypeError("iterator result is not an object"),c.delegate=null,a))}function C(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function n(b){var a=b.completion||{};a.type="normal",delete a.arg,b.completion=a}function o(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(C,this),this.reset(!0)}function s(a){var e,c,f;if(a){if(e=a[h],e)return e.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length))return c=-1,f=function e(){for(;++c<a.length;)if(d.call(a,c))return e.value=a[c],e.done=!1,e;return e.value=b,e.done=!0,e},f.next=f}return{next:v}}function v(){return{value:b,done:!0}}return l.prototype=f.constructor=e,e.constructor=l,l.displayName=g(e,m,"GeneratorFunction"),c.isGeneratorFunction=function(b){var a="function"==typeof b&&b.constructor;return!!a&&(a===l||"GeneratorFunction"===(a.displayName||a.name))},c.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,e):(a.__proto__=e,g(a,m,"GeneratorFunction")),a.prototype=Object.create(f),a},c.awrap=function(a){return{__await:a}},x(k.prototype),k.prototype[D]=function(){return this},c.AsyncIterator=k,c.async=function(e,d,f,g,a){void 0===a&&(a=Promise);var b=new k(w(e,d,f,g),a);return c.isGeneratorFunction(d)?b:b.next().then(function(a){return a.done?a.value:b.next()})},x(f),g(f,m,"Generator"),f[h]=function(){return this},f.toString=function(){return"[object Generator]"},c.keys=function(b){var a=[],c;for(c in b)a.push(c);return a.reverse(),function c(){for(;a.length;){var d=a.pop();if(d in b)return c.value=d,c.done=!1,c}return c.done=!0,c}},c.values=s,o.prototype={constructor:o,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=b,this.done=!1,this.delegate=null,this.method="next",this.arg=b,this.tryEntries.forEach(n),!c)for(var a in this)"t"===a.charAt(0)&&d.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=b)},stop:function(){this.done=!0;var a=this.tryEntries[0].completion;if("throw"===a.type)throw a.arg;return this.rval},dispatchException:function(j){var e,f,a,h,g,i;if(this.done)throw j;e=this;function c(c,a){return h.type="throw",h.arg=j,e.next=c,a&&(e.method="next",e.arg=b),!!a}for(f=this.tryEntries.length-1;f>=0;--f){if(a=this.tryEntries[f],h=a.completion,"root"===a.tryLoc)return c("end");if(a.tryLoc<=this.prev)if(g=d.call(a,"catchLoc"),i=d.call(a,"finallyLoc"),g&&i){{if(this.prev<a.catchLoc)return c(a.catchLoc,!0);if(this.prev<a.finallyLoc)return c(a.finallyLoc)}}else if(g){if(this.prev<a.catchLoc)return c(a.catchLoc,!0)}else{if(!i)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return c(a.finallyLoc)}}},abrupt:function(e,f){for(var g=this.tryEntries.length-1,c,b,h;g>=0;--g)if(c=this.tryEntries[g],c.tryLoc<=this.prev&&d.call(c,"finallyLoc")&&this.prev<c.finallyLoc){b=c;break}return b&&("break"===e||"continue"===e)&&b.tryLoc<=f&&f<=b.finallyLoc&&(b=null),h=b?b.completion:{},h.type=e,h.arg=f,b?(this.method="next",this.next=b.finallyLoc,a):this.complete(h)},complete:function(b,c){if("throw"===b.type)throw b.arg;return"break"===b.type||"continue"===b.type?this.next=b.arg:"return"===b.type?(this.rval=this.arg=b.arg,this.method="return",this.next="end"):"normal"===b.type&&c&&(this.next=c),a},finish:function(d){for(var c=this.tryEntries.length-1,b;c>=0;--c)if(b=this.tryEntries[c],b.finallyLoc===d)return this.complete(b.completion,b.afterLoc),n(b),a},catch:function(d){for(var a=this.tryEntries.length-1,b,c,e;a>=0;--a)if(b=this.tryEntries[a],b.tryLoc===d)return c=b.completion,"throw"===c.type&&(e=c.arg,n(b)),e;throw new Error("illegal catch attempt")},delegateYield:function(c,d,e){return this.delegate={iterator:s(c),resultName:d,nextLoc:e},"next"===this.method&&(this.arg=b),a}},c}("object"==typeof module?module.exports:{});try{regeneratorRuntime=gi}catch(a){Function("r","regeneratorRuntime = r")(gi)}fQ="125dev",bA=100,dc=300,cN=301,cM=302,de=303,dm=304,bK=306,cQ=307,dq=1e3,L=1001,dA=1002,C=1003,fz=1004,fy=1005,D=1006,gw=1007,cx=1008,bT=1009,ct=1012,cs=1014,aw=1015,cr=1016,cd=1020,aK=1022,Y=1023,bi=1026,bX=1027,fx=33776,fw=33777,fv=33778,fu=33779,ft=35840,fs=35841,fr=35842,fq=35843,fk=37492,fh=37496,ch=2300,cf=2301,dL=2302,bn=2400,bm=2401,cg=2402,ek=2500,ff=2501,aR=3e3,dM=3001,fb=3007,fa=3002,gx=3004,gy=3005,gA=3006,dR=7680,cj=35044,bh=35048,eW="300 es";function im(c,h,i,d,e,f,g){try{var a=c[f](g),b=a.value}catch(a){return void i(a)}a.done?h(b):Promise.resolve(b).then(d,e)}function io(d,c){for(var b=0,a;b<c.length;b++)a=c[b],a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}function eP(a,b,c){return b&&io(a.prototype,b),c&&io(a,c),a}function m(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function ap(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function jS(c,a){(null==a||a>c.length)&&(a=c.length);for(var b=0,d=new Array(a);b<a;b++)d[b]=c[b];return d}function kQ(a,d){var b,c;if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(b=function(a,c){if(a){if("string"==typeof a)return jS(a,c);var b=Object.prototype.toString.call(a).slice(8,-1);return"Object"===b&&a.constructor&&(b=a.constructor.name),"Map"===b||"Set"===b?Array.from(a):"Arguments"===b||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?jS(a,c):void 0}}(a))||d&&a&&"number"==typeof a.length)return b&&(a=b),c=0,function(){return c>=a.length?{done:!0}:{done:!1,value:a[c++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(b=a[Symbol.iterator]()).next.bind(b)}function aN(){}Object.assign(aN.prototype,{addEventListener:function(a,c){void 0===this._listeners&&(this._listeners={});var b=this._listeners;void 0===b[a]&&(b[a]=[]),-1===b[a].indexOf(c)&&b[a].push(c)},hasEventListener:function(a,c){if(void 0===this._listeners)return!1;var b=this._listeners;return void 0!==b[a]&&-1!==b[a].indexOf(c)},removeEventListener:function(c,d){var a,b;void 0!==this._listeners&&(a=this._listeners[c],void 0!==a&&(b=a.indexOf(d),-1!==b&&a.splice(b,1)))},dispatchEvent:function(b){var c,d,a,e;if(void 0!==this._listeners)if(c=this._listeners[b.type],void 0!==c){b.target=this;for(d=c.slice(0),a=0,e=d.length;a<e;a++)d[a].call(this,b)}}});for(E=[],cq=0;cq<256;cq++)E[cq]=(cq<16?"0":"")+cq.toString(16);eL=1234567,l={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var a=4294967295*Math.random()|0,b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(E[255&a]+E[a>>8&255]+E[a>>16&255]+E[a>>24&255]+"-"+E[255&b]+E[b>>8&255]+"-"+E[b>>16&15|64]+E[b>>24&255]+"-"+E[63&c|128]+E[c>>8&255]+"-"+E[c>>16&255]+E[c>>24&255]+E[255&d]+E[d>>8&255]+E[d>>16&255]+E[d>>24&255]).toUpperCase()},clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},euclideanModulo:function(b,a){return(b%a+a)%a},mapLinear:function(c,a,d,b,e){return b+(c-a)*(e-b)/(d-a)},lerp:function(b,c,a){return(1-a)*b+a*c},pingpong:function(b,a){return void 0===a&&(a=1),a-Math.abs(l.euclideanModulo(b,2*a)-a)},smoothstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*(3-2*a)},smootherstep:function(a,b,c){return a<=b?0:a>=c?1:(a=(a-b)/(c-b))*a*a*(a*(6*a-15)+10)},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},seededRandom:function(a){return void 0!==a&&(eL=a%2147483647),((eL=16807*eL%2147483647)-1)/2147483646},degToRad:function(a){return a*l.DEG2RAD},radToDeg:function(a){return a*l.RAD2DEG},isPowerOfTwo:function(a){return 0==(a&a-1)&&0!==a},ceilPowerOfTwo:function(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))},floorPowerOfTwo:function(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},setQuaternionFromProperEuler:function(g,c,o,e,n){var i=Math.cos,h=Math.sin,a=i(o/2),b=h(o/2),f=i((c+e)/2),d=h((c+e)/2),j=i((c-e)/2),k=h((c-e)/2),l=i((e-c)/2),m=h((e-c)/2);switch(n){case"XYX":g.set(a*d,b*j,b*k,a*f);break;case"YZY":g.set(b*k,a*d,b*j,a*f);break;case"ZXZ":g.set(b*j,b*k,a*d,a*f);break;case"XZX":g.set(a*d,b*m,b*l,a*f);break;case"YXY":g.set(b*l,a*d,b*m,a*f);break;case"ZYZ":g.set(b*m,b*l,a*d,a*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}},c=function(){function b(a,b){void 0===a&&(a=0),void 0===b&&(b=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=a,this.y=b}var a=b.prototype;return a.set=function(a,b){return this.x=a,this.y=b,this},a.setScalar=function(a){return this.x=a,this.y=a,this},a.setX=function(a){return this.x=a,this},a.setY=function(a){return this.y=a,this},a.setComponent=function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}return this},a.getComponent=function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},a.clone=function(){return new this.constructor(this.x,this.y)},a.copy=function(a){return this.x=a.x,this.y=a.y,this},a.add=function(a,b){return void 0!==b?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this)},a.addScalar=function(a){return this.x+=a,this.y+=a,this},a.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},a.addScaledVector=function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this},a.sub=function(a,b){return void 0!==b?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this)},a.subScalar=function(a){return this.x-=a,this.y-=a,this},a.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},a.multiply=function(a){return this.x*=a.x,this.y*=a.y,this},a.multiplyScalar=function(a){return this.x*=a,this.y*=a,this},a.divide=function(a){return this.x/=a.x,this.y/=a.y,this},a.divideScalar=function(a){return this.multiplyScalar(1/a)},a.applyMatrix3=function(d){var b=this.x,c=this.y,a=d.elements;return this.x=a[0]*b+a[3]*c+a[6],this.y=a[1]*b+a[4]*c+a[7],this},a.min=function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this},a.max=function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this},a.clamp=function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this},a.clampScalar=function(a,b){return this.x=Math.max(a,Math.min(b,this.x)),this.y=Math.max(a,Math.min(b,this.y)),this},a.clampLength=function(b,c){var a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(b,Math.min(c,a)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this},a.dot=function(a){return this.x*a.x+this.y*a.y},a.cross=function(a){return this.x*a.y-this.y*a.x},a.lengthSq=function(){return this.x*this.x+this.y*this.y},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.angle=function(){var a=Math.atan2(-this.y,-this.x)+Math.PI;return a},a.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},a.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},a.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},a.setLength=function(a){return this.normalize().multiplyScalar(a)},a.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},a.lerpVectors=function(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this},a.equals=function(a){return a.x===this.x&&a.y===this.y},a.fromArray=function(b,a){return void 0===a&&(a=0),this.x=b[a],this.y=b[a+1],this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a},a.fromBufferAttribute=function(a,b,c){return void 0!==c&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=a.getX(b),this.y=a.getY(b),this},a.rotateAround=function(a,b){var c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,this.y=e*d+f*c+a.y,this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this},eP(b,[{key:"width",get:function(){return this.x},set:function(a){this.x=a}},{key:"height",get:function(){return this.y},set:function(a){this.y=a}}]),b}(),Q=function(){function b(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var a=b.prototype;return a.set=function(b,c,d,j,e,f,g,h,i){var a=this.elements;return a[0]=b,a[1]=j,a[2]=g,a[3]=c,a[4]=e,a[5]=h,a[6]=d,a[7]=f,a[8]=i,this},a.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},a.clone=function(){return(new this.constructor).fromArray(this.elements)},a.copy=function(c){var a=this.elements,b=c.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],this},a.extractBasis=function(a,b,c){return a.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),c.setFromMatrix3Column(this,2),this},a.setFromMatrix4=function(b){var a=b.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this},a.multiply=function(a){return this.multiplyMatrices(this,a)},a.premultiply=function(a){return this.multiplyMatrices(a,this)},a.multiplyMatrices=function(w,v){var c=w.elements,a=v.elements,b=this.elements,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=a[0],p=a[3],q=a[6],r=a[1],s=a[4],t=a[7],u=a[2],e=a[5],d=a[8];return b[0]=f*o+g*r+h*u,b[3]=f*p+g*s+h*e,b[6]=f*q+g*t+h*d,b[1]=i*o+j*r+k*u,b[4]=i*p+j*s+k*e,b[7]=i*q+j*t+k*d,b[2]=l*o+m*r+n*u,b[5]=l*p+m*s+n*e,b[8]=l*q+m*t+n*d,this},a.multiplyScalar=function(a){var b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},a.determinant=function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h},a.invert=function(){var a=this.elements,e=a[0],c=a[1],d=a[2],f=a[3],g=a[4],h=a[5],k=a[6],j=a[7],i=a[8],l=i*g-h*j,m=h*k-i*f,n=j*f-g*k,o=e*l+c*m+d*n,b;return 0===o?this.set(0,0,0,0,0,0,0,0,0):(b=1/o,a[0]=l*b,a[1]=(d*j-i*c)*b,a[2]=(h*c-d*g)*b,a[3]=m*b,a[4]=(i*e-d*k)*b,a[5]=(d*f-h*e)*b,a[6]=n*b,a[7]=(c*k-j*e)*b,a[8]=(g*e-c*f)*b,this)},a.transpose=function(){var b,a=this.elements;return b=a[1],a[1]=a[3],a[3]=b,b=a[2],a[2]=a[6],a[6]=b,b=a[5],a[5]=a[7],a[7]=b,this},a.getNormalMatrix=function(a){return this.setFromMatrix4(a).copy(this).invert().transpose()},a.transposeIntoArray=function(a){var b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},a.setUvTransform=function(h,i,f,d,g,e,c){var a=Math.cos(g),b=Math.sin(g);return this.set(f*a,f*b,-f*(a*e+b*c)+e+h,-d*b,d*a,-d*(-b*e+a*c)+c+i,0,0,1),this},a.scale=function(b,c){var a=this.elements;return a[0]*=b,a[3]*=b,a[6]*=b,a[1]*=c,a[4]*=c,a[7]*=c,this},a.rotate=function(d){var b=Math.cos(d),c=Math.sin(d),a=this.elements,e=a[0],f=a[3],g=a[6],h=a[1],i=a[4],j=a[7];return a[0]=b*e+c*h,a[3]=b*f+c*i,a[6]=b*g+c*j,a[1]=-c*e+b*h,a[4]=-c*f+b*i,a[7]=-c*g+b*j,this},a.translate=function(b,c){var a=this.elements;return a[0]+=b*a[2],a[3]+=b*a[5],a[6]+=b*a[8],a[1]+=c*a[2],a[4]+=c*a[5],a[7]+=c*a[8],this},a.equals=function(b){for(var c=this.elements,d=b.elements,a=0;a<9;a++)if(c[a]!==d[a])return!1;return!0},a.fromArray=function(c,b){void 0===b&&(b=0);for(var a=0;a<9;a++)this.elements[a]=c[a+b];return this},a.toArray=function(a,b){void 0===a&&(a=[]),void 0===b&&(b=0);var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a},b}(),bd={getDataURL:function(a){var b,c;return/^data:/i.test(a.src)?a.src:"undefined"==typeof HTMLCanvasElement?a.src:(a instanceof HTMLCanvasElement?b=a:(void 0===bW&&(bW=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),bW.width=a.width,bW.height=a.height,c=bW.getContext("2d"),a instanceof ImageData?c.putImageData(a,0,0):c.drawImage(a,0,0,a.width,a.height),b=bW),b.width>2048||b.height>2048?b.toDataURL("image/jpeg",.6):b.toDataURL("image/png"))}},iv=0;function r(a,b,d,e,f,g,h,i,j,k){void 0===a&&(a=r.DEFAULT_IMAGE),void 0===b&&(b=r.DEFAULT_MAPPING),void 0===d&&(d=L),void 0===e&&(e=L),void 0===f&&(f=D),void 0===g&&(g=cx),void 0===h&&(h=Y),void 0===i&&(i=bT),void 0===j&&(j=1),void 0===k&&(k=aR),Object.defineProperty(this,"id",{value:iv++}),this.uuid=l.generateUUID(),this.name="",this.image=a,this.mipmaps=[],this.mapping=b,this.wrapS=d,this.wrapT=e,this.magFilter=f,this.minFilter=g,this.anisotropy=j,this.format=h,this.internalFormat=null,this.type=i,this.offset=new c(0,0),this.repeat=new c(1,1),this.center=new c(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Q,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=k,this.version=0,this.onUpdate=null}function gC(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?bd.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}r.DEFAULT_IMAGE=void 0,r.DEFAULT_MAPPING=dc,r.prototype=Object.assign(Object.create(aN.prototype),{constructor:r,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.name=a.name,this.image=a.image,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.encoding=a.encoding,this},toJSON:function(b){var e=void 0===b||"string"==typeof b,f,a,c,d,g;if(!e&&void 0!==b.textures[this.uuid])return b.textures[this.uuid];if(f={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment},void 0!==this.image){if(a=this.image,void 0===a.uuid&&(a.uuid=l.generateUUID()),!e&&void 0===b.images[a.uuid]){if(Array.isArray(a)){c=[];for(d=0,g=a.length;d<g;d++)a[d].isDataTexture?c.push(gC(a[d].image)):c.push(gC(a[d]))}else c=gC(a);b.images[a.uuid]={uuid:a.uuid,url:c}}f.image=a.uuid}return e||(b.textures[this.uuid]=f),f},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(a){if(this.mapping!==dc)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case dq:a.x=a.x-Math.floor(a.x);break;case L:a.x=a.x<0?0:1;break;case dA:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case dq:a.y=a.y-Math.floor(a.y);break;case L:a.y=a.y<0?0:1;break;case dA:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}}),Object.defineProperty(r.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),q=function(){function b(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=a,this.y=b,this.z=c,this.w=d}var a=b.prototype;return a.set=function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},a.setScalar=function(a){return this.x=a,this.y=a,this.z=a,this.w=a,this},a.setX=function(a){return this.x=a,this},a.setY=function(a){return this.y=a,this},a.setZ=function(a){return this.z=a,this},a.setW=function(a){return this.w=a,this},a.setComponent=function(b,a){switch(b){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+b)}return this},a.getComponent=function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},a.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},a.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this},a.add=function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},a.addScalar=function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},a.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},a.addScaledVector=function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this},a.sub=function(a,b){return void 0!==b?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},a.subScalar=function(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this},a.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},a.multiply=function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this},a.multiplyScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},a.applyMatrix4=function(f){var b=this.x,c=this.y,d=this.z,e=this.w,a=f.elements;return this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e,this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e,this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e,this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e,this},a.divideScalar=function(a){return this.multiplyScalar(1/a)},a.setAxisAngleFromQuaternion=function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},a.setAxisAngleFromRotationMatrix=function(x){var t,b,c,d,f=.01,n=.1,a=x.elements,q=a[0],i=a[4],j=a[8],k=a[1],s=a[5],e=a[9],g=a[2],h=a[6],r=a[10],p,m,o,u,v,w,l;return Math.abs(i-k)<f&&Math.abs(j-g)<f&&Math.abs(e-h)<f?Math.abs(i+k)<n&&Math.abs(j+g)<n&&Math.abs(e+h)<n&&Math.abs(q+s+r-3)<n?(this.set(1,0,0,0),this):(t=Math.PI,p=(q+1)/2,m=(s+1)/2,o=(r+1)/2,u=(i+k)/4,v=(j+g)/4,w=(e+h)/4,p>m&&p>o?p<f?(b=0,c=.707106781,d=.707106781):(c=u/(b=Math.sqrt(p)),d=v/b):m>o?m<f?(b=.707106781,c=0,d=.707106781):(b=u/(c=Math.sqrt(m)),d=w/c):o<f?(b=.707106781,c=.707106781,d=0):(b=v/(d=Math.sqrt(o)),c=w/d),this.set(b,c,d,t),this):(l=Math.sqrt((h-e)*(h-e)+(j-g)*(j-g)+(k-i)*(k-i)),Math.abs(l)<.001&&(l=1),this.x=(h-e)/l,this.y=(j-g)/l,this.z=(k-i)/l,this.w=Math.acos((q+s+r-1)/2),this)},a.min=function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this},a.max=function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},a.clamp=function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this.w=Math.max(a.w,Math.min(b.w,this.w)),this},a.clampScalar=function(a,b){return this.x=Math.max(a,Math.min(b,this.x)),this.y=Math.max(a,Math.min(b,this.y)),this.z=Math.max(a,Math.min(b,this.z)),this.w=Math.max(a,Math.min(b,this.w)),this},a.clampLength=function(b,c){var a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(b,Math.min(c,a)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},a.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},a.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.setLength=function(a){return this.normalize().multiplyScalar(a)},a.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},a.lerpVectors=function(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this.w=a.w+(b.w-a.w)*c,this},a.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},a.fromArray=function(b,a){return void 0===a&&(a=0),this.x=b[a],this.y=b[a+1],this.z=b[a+2],this.w=b[a+3],this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a},a.fromBufferAttribute=function(a,b,c){return void 0!==c&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},eP(b,[{key:"width",get:function(){return this.z},set:function(a){this.z=a}},{key:"height",get:function(){return this.w},set:function(a){this.w=a}}]),b}(),aI=function(c){function b(d,e,a){var b;return b=c.call(this)||this,Object.defineProperty(ap(b),"isWebGLRenderTarget",{value:!0}),b.width=d,b.height=e,b.scissor=new q(0,0,d,e),b.scissorTest=!1,b.viewport=new q(0,0,d,e),a=a||{},b.texture=new r(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),b.texture.image={},b.texture.image.width=d,b.texture.image.height=e,b.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,b.texture.minFilter=void 0!==a.minFilter?a.minFilter:D,b.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,b.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,b.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,b}m(b,c);var a=b.prototype;return a.setSize=function(a,b){this.width===a&&this.height===b||(this.width=a,this.height=b,this.texture.image.width=a,this.texture.image.height=b,this.dispose()),this.viewport.set(0,0,a,b),this.scissor.set(0,0,a,b)},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.width=a.width,this.height=a.height,this.viewport.copy(a.viewport),this.texture=a.texture.clone(),this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.depthTexture=a.depthTexture,this},a.dispose=function(){this.dispatchEvent({type:"dispose"})},b}(aN),ix=function(a){function b(c,d,e){var b;return b=a.call(this,c,d,e)||this,Object.defineProperty(ap(b),"isWebGLMultisampleRenderTarget",{value:!0}),b.samples=4,b}return m(b,a),b.prototype.copy=function(b){return a.prototype.copy.call(this,b),this.samples=b.samples,this},b}(aI),G=function(){function b(a,b,c,d){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=a,this._y=b,this._z=c,this._w=d}b.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)},b.slerpFlat=function(l,k,j,i,h,g,f){var a=j[i+0],d=j[i+1],c=j[i+2],b=j[i+3],t=h[g+0],s=h[g+1],q=h[g+2],p=h[g+3],e,n,u,v,r,w,m,o;(b!==p||a!==t||d!==s||c!==q)&&(e=1-f,n=a*t+d*s+c*q+b*p,u=n>=0?1:-1,v=1-n*n,v>Number.EPSILON&&(r=Math.sqrt(v),w=Math.atan2(r,n*u),e=Math.sin(e*w)/r,f=Math.sin(f*w)/r),m=f*u,(a=a*e+t*m,d=d*e+s*m,c=c*e+q*m,b=b*e+p*m,e===1-f)&&(o=1/Math.sqrt(a*a+d*d+c*c+b*b),a*=o,d*=o,c*=o,b*=o)),l[k]=a,l[k+1]=d,l[k+2]=c,l[k+3]=b},b.multiplyQuaternionsFlat=function(a,h,c,d,e,f){var g=c[d],b=c[d+1],i=c[d+2],j=c[d+3],k=e[f],l=e[f+1],m=e[f+2],n=e[f+3];return a[h]=g*n+j*k+b*m-i*l,a[h+1]=b*n+j*l+i*k-g*m,a[h+2]=i*n+j*m+g*l-b*k,a[h+3]=j*n-g*k-b*l-i*m,a};var a=b.prototype;return a.set=function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this._onChangeCallback(),this},a.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},a.copy=function(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this},a.setFromEuler=function(g,n){if(!g||!g.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var m=g._x,l=g._y,k=g._z,j=g._order,h=Math.cos,i=Math.sin,f=h(m/2),e=h(l/2),d=h(k/2),c=i(m/2),b=i(l/2),a=i(k/2);switch(j){case"XYZ":this._x=c*e*d+f*b*a,this._y=f*b*d-c*e*a,this._z=f*e*a+c*b*d,this._w=f*e*d-c*b*a;break;case"YXZ":this._x=c*e*d+f*b*a,this._y=f*b*d-c*e*a,this._z=f*e*a-c*b*d,this._w=f*e*d+c*b*a;break;case"ZXY":this._x=c*e*d-f*b*a,this._y=f*b*d+c*e*a,this._z=f*e*a+c*b*d,this._w=f*e*d-c*b*a;break;case"ZYX":this._x=c*e*d-f*b*a,this._y=f*b*d+c*e*a,this._z=f*e*a-c*b*d,this._w=f*e*d+c*b*a;break;case"YZX":this._x=c*e*d+f*b*a,this._y=f*b*d+c*e*a,this._z=f*e*a-c*b*d,this._w=f*e*d-c*b*a;break;case"XZY":this._x=c*e*d-f*b*a,this._y=f*b*d-c*e*a,this._z=f*e*a+c*b*d,this._w=f*e*d+c*b*a;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+j)}return!1!==n&&this._onChangeCallback(),this},a.setFromAxisAngle=function(a,d){var c=d/2,b=Math.sin(c);return this._x=a.x*b,this._y=a.y*b,this._z=a.z*b,this._w=Math.cos(c),this._onChangeCallback(),this},a.setFromRotationMatrix=function(p){var a=p.elements,c=a[0],k=a[4],g=a[8],f=a[1],b=a[5],h=a[9],i=a[2],j=a[6],d=a[10],o=c+b+d,m,n,l,e;return o>0?(m=.5/Math.sqrt(o+1),this._w=.25/m,this._x=(j-h)*m,this._y=(g-i)*m,this._z=(f-k)*m):c>b&&c>d?(n=2*Math.sqrt(1+c-b-d),this._w=(j-h)/n,this._x=.25*n,this._y=(k+f)/n,this._z=(g+i)/n):b>d?(l=2*Math.sqrt(1+b-c-d),this._w=(g-i)/l,this._x=(k+f)/l,this._y=.25*l,this._z=(h+j)/l):(e=2*Math.sqrt(1+d-c-b),this._w=(f-k)/e,this._x=(g+i)/e,this._y=(h+j)/e,this._z=.25*e),this._onChangeCallback(),this},a.setFromUnitVectors=function(a,b){var c=a.dot(b)+1;return c<1e-6?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0,this._w=c):(this._x=0,this._y=-a.z,this._z=a.y,this._w=c)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x,this._w=c),this.normalize()},a.angleTo=function(a){return 2*Math.acos(Math.abs(l.clamp(this.dot(a),-1,1)))},a.rotateTowards=function(a,c){var b=this.angleTo(a),d;return 0===b?this:(d=Math.min(1,c/b),this.slerp(a,d),this)},a.identity=function(){return this.set(0,0,0,1)},a.invert=function(){return this.conjugate()},a.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},a.dot=function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},a.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},a.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},a.normalize=function(){var a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this},a.multiply=function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},a.premultiply=function(a){return this.multiplyQuaternions(a,this)},a.multiplyQuaternions=function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this._onChangeCallback(),this},a.slerp=function(a,b){var g,d,e,f,c,l,h,k,m,i,j;return 0===b?this:1===b?this.copy(a):(g=this._x,d=this._y,e=this._z,f=this._w,c=f*a._w+g*a._x+d*a._y+e*a._z,c<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,c=-c):this.copy(a),c>=1)?(this._w=f,this._x=g,this._y=d,this._z=e,this):(l=1-c*c,l<=Number.EPSILON)?(h=1-b,this._w=h*f+b*this._w,this._x=h*g+b*this._x,this._y=h*d+b*this._y,this._z=h*e+b*this._z,this.normalize(),this._onChangeCallback(),this):(k=Math.sqrt(l),m=Math.atan2(k,c),i=Math.sin((1-b)*m)/k,j=Math.sin(b*m)/k,this._w=f*i+this._w*j,this._x=g*i+this._x*j,this._y=d*i+this._y*j,this._z=e*i+this._z*j,this._onChangeCallback(),this)},a.equals=function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},a.fromArray=function(b,a){return void 0===a&&(a=0),this._x=b[a],this._y=b[a+1],this._z=b[a+2],this._w=b[a+3],this._onChangeCallback(),this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a},a.fromBufferAttribute=function(a,b){return this._x=a.getX(b),this._y=a.getY(b),this._z=a.getZ(b),this._w=a.getW(b),this},a._onChange=function(a){return this._onChangeCallback=a,this},a._onChangeCallback=function(){},eP(b,[{key:"x",get:function(){return this._x},set:function(a){this._x=a,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(a){this._y=a,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(a){this._z=a,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(a){this._w=a,this._onChangeCallback()}}]),b}(),b=function(){function b(a,b,c){void 0===a&&(a=0),void 0===b&&(b=0),void 0===c&&(c=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=a,this.y=b,this.z=c}var a=b.prototype;return a.set=function(b,c,a){return void 0===a&&(a=this.z),this.x=b,this.y=c,this.z=a,this},a.setScalar=function(a){return this.x=a,this.y=a,this.z=a,this},a.setX=function(a){return this.x=a,this},a.setY=function(a){return this.y=a,this},a.setZ=function(a){return this.z=a,this},a.setComponent=function(b,a){switch(b){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+b)}return this},a.getComponent=function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},a.clone=function(){return new this.constructor(this.x,this.y,this.z)},a.copy=function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},a.add=function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b)):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this)},a.addScalar=function(a){return this.x+=a,this.y+=a,this.z+=a,this},a.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},a.addScaledVector=function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},a.sub=function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b)):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this)},a.subScalar=function(a){return this.x-=a,this.y-=a,this.z-=a,this},a.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},a.multiply=function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b)):(this.x*=a.x,this.y*=a.y,this.z*=a.z,this)},a.multiplyScalar=function(a){return this.x*=a,this.y*=a,this.z*=a,this},a.multiplyVectors=function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},a.applyEuler=function(a){return a&&a.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(gL.setFromEuler(a))},a.applyAxisAngle=function(a,b){return this.applyQuaternion(gL.setFromAxisAngle(a,b))},a.applyMatrix3=function(e){var b=this.x,c=this.y,d=this.z,a=e.elements;return this.x=a[0]*b+a[3]*c+a[6]*d,this.y=a[1]*b+a[4]*c+a[7]*d,this.z=a[2]*b+a[5]*c+a[8]*d,this},a.applyNormalMatrix=function(a){return this.applyMatrix3(a).normalize()},a.applyMatrix4=function(f){var b=this.x,c=this.y,d=this.z,a=f.elements,e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);return this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])*e,this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e,this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e,this},a.applyQuaternion=function(g){var h=this.x,e=this.y,f=this.z,c=g.x,d=g.y,a=g.z,b=g.w,i=b*h+d*f-a*e,j=b*e+a*h-c*f,k=b*f+c*e-d*h,l=-c*h-d*e-a*f;return this.x=i*b+l*-c+j*-a-k*-d,this.y=j*b+l*-d+k*-c-i*-a,this.z=k*b+l*-a+i*-d-j*-c,this},a.project=function(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)},a.unproject=function(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)},a.transformDirection=function(e){var b=this.x,c=this.y,d=this.z,a=e.elements;return this.x=a[0]*b+a[4]*c+a[8]*d,this.y=a[1]*b+a[5]*c+a[9]*d,this.z=a[2]*b+a[6]*c+a[10]*d,this.normalize()},a.divide=function(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this},a.divideScalar=function(a){return this.multiplyScalar(1/a)},a.min=function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this},a.max=function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},a.clamp=function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this},a.clampScalar=function(a,b){return this.x=Math.max(a,Math.min(b,this.x)),this.y=Math.max(a,Math.min(b,this.y)),this.z=Math.max(a,Math.min(b,this.z)),this},a.clampLength=function(b,c){var a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(b,Math.min(c,a)))},a.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},a.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},a.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},a.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},a.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},a.dot=function(a){return this.x*a.x+this.y*a.y+this.z*a.z},a.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},a.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},a.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},a.normalize=function(){return this.divideScalar(this.length()||1)},a.setLength=function(a){return this.normalize().multiplyScalar(a)},a.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this},a.lerpVectors=function(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this},a.cross=function(a,b){return void 0!==b?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b)):this.crossVectors(this,a)},a.crossVectors=function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},a.projectOnVector=function(a){var b=a.lengthSq(),c;return 0===b?this.set(0,0,0):(c=a.dot(this)/b,this.copy(a).multiplyScalar(c))},a.projectOnPlane=function(a){return eJ.copy(this).projectOnVector(a),this.sub(eJ)},a.reflect=function(a){return this.sub(eJ.copy(a).multiplyScalar(2*this.dot(a)))},a.angleTo=function(a){var b=Math.sqrt(this.lengthSq()*a.lengthSq()),c;return 0===b?Math.PI/2:(c=this.dot(a)/b,Math.acos(l.clamp(c,-1,1)))},a.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},a.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},a.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)},a.setFromSpherical=function(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)},a.setFromSphericalCoords=function(a,b,c){var d=Math.sin(b)*a;return this.x=d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this},a.setFromCylindrical=function(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)},a.setFromCylindricalCoords=function(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this},a.setFromMatrixPosition=function(b){var a=b.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this},a.setFromMatrixScale=function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this},a.setFromMatrixColumn=function(a,b){return this.fromArray(a.elements,4*b)},a.setFromMatrix3Column=function(a,b){return this.fromArray(a.elements,3*b)},a.equals=function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},a.fromArray=function(b,a){return void 0===a&&(a=0),this.x=b[a],this.y=b[a+1],this.z=b[a+2],this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},a.fromBufferAttribute=function(a,b,c){return void 0!==c&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this},a.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},b}(),eJ=new b,gL=new G,aF=function(){function c(a,c){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==a?a:new b(1/0,1/0,1/0),this.max=void 0!==c?c:new b(-1/0,-1/0,-1/0)}var a=c.prototype;return a.set=function(a,b){return this.min.copy(a),this.max.copy(b),this},a.setFromArray=function(b){for(var h=1/0,f=1/0,i=1/0,j=-1/0,k=-1/0,g=-1/0,a=0,l=b.length,c,d,e;a<l;a+=3)c=b[a],d=b[a+1],e=b[a+2],c<h&&(h=c),d<f&&(f=d),e<i&&(i=e),c>j&&(j=c),d>k&&(k=d),e>g&&(g=e);return this.min.set(h,f,i),this.max.set(j,k,g),this},a.setFromBufferAttribute=function(b){for(var h=1/0,f=1/0,i=1/0,j=-1/0,k=-1/0,g=-1/0,a=0,l=b.count,c,d,e;a<l;a++)c=b.getX(a),d=b.getY(a),e=b.getZ(a),c<h&&(h=c),d<f&&(f=d),e<i&&(i=e),c>j&&(j=c),d>k&&(k=d),e>g&&(g=e);return this.min.set(h,f,i),this.max.set(j,k,g),this},a.setFromPoints=function(b){this.makeEmpty();for(var a=0,c=b.length;a<c;a++)this.expandByPoint(b[a]);return this},a.setFromCenterAndSize=function(a,c){var b=cA.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this},a.setFromObject=function(a){return this.makeEmpty(),this.expandByObject(a)},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.min.copy(a.min),this.max.copy(a.max),this},a.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},a.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},a.getCenter=function(a){return void 0===a&&(console.warn("THREE.Box3: .getCenter() target is now required"),a=new b),this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},a.getSize=function(a){return void 0===a&&(console.warn("THREE.Box3: .getSize() target is now required"),a=new b),this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)},a.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},a.expandByVector=function(a){return this.min.sub(a),this.max.add(a),this},a.expandByScalar=function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},a.expandByObject=function(b){var a,d,c,e;b.updateWorldMatrix(!1,!1),a=b.geometry,void 0!==a&&(null===a.boundingBox&&a.computeBoundingBox(),ez.copy(a.boundingBox),ez.applyMatrix4(b.matrixWorld),this.union(ez));for(d=b.children,c=0,e=d.length;c<e;c++)this.expandByObject(d[c]);return this},a.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z)},a.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z},a.getParameter=function(a,c){return void 0===c&&(console.warn("THREE.Box3: .getParameter() target is now required"),c=new b),c.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},a.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z)},a.intersectsSphere=function(a){return this.clampPoint(a.center,cA),cA.distanceToSquared(a.center)<=a.radius*a.radius},a.intersectsPlane=function(a){var b,c;return a.normal.x>0?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),a.normal.y>0?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),a.normal.z>0?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant},a.intersectsTriangle=function(a){if(this.isEmpty())return!1;this.getCenter(cI),ep.subVectors(this.max,cI),by.subVectors(a.a,cI),bP.subVectors(a.b,cI),ce.subVectors(a.c,cI),aX.subVectors(bP,by),aP.subVectors(ce,bP),ba.subVectors(by,ce);var b=[0,-aX.z,aX.y,0,-aP.z,aP.y,0,-ba.z,ba.y,aX.z,0,-aX.x,aP.z,0,-aP.x,ba.z,0,-ba.x,-aX.y,aX.x,0,-aP.y,aP.x,0,-ba.y,ba.x,0];return!!gM(b,by,bP,ce,ep)&&!!gM(b=[1,0,0,0,1,0,0,0,1],by,bP,ce,ep)&&(er.crossVectors(aX,aP),gM(b=[er.x,er.y,er.z],by,bP,ce,ep))},a.clampPoint=function(c,a){return void 0===a&&(console.warn("THREE.Box3: .clampPoint() target is now required"),a=new b),a.copy(c).clamp(this.min,this.max)},a.distanceToPoint=function(a){return cA.copy(a).clamp(this.min,this.max).sub(a).length()},a.getBoundingSphere=function(a){return void 0===a&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(a.center),a.radius=.5*this.getSize(cA).length(),a},a.intersect=function(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this},a.union=function(a){return this.min.min(a.min),this.max.max(a.max),this},a.applyMatrix4=function(a){return this.isEmpty()||(aA[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),aA[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),aA[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),aA[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),aA[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),aA[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),aA[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),aA[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(aA)),this},a.translate=function(a){return this.min.add(a),this.max.add(a),this},a.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},c}();function gM(c,g,j,k,a){for(var b=0,h=c.length-3,i,d,e,f;b<=h;b+=3)if(a_.fromArray(c,b),i=a.x*Math.abs(a_.x)+a.y*Math.abs(a_.y)+a.z*Math.abs(a_.z),d=g.dot(a_),e=j.dot(a_),f=k.dot(a_),Math.max(-Math.max(d,e,f),Math.min(d,e,f))>i)return!1;return!0}aA=[new b,new b,new b,new b,new b,new b,new b,new b],cA=new b,ez=new aF,by=new b,bP=new b,ce=new b,aX=new b,aP=new b,ba=new b,cI=new b,ep=new b,er=new b,a_=new b,iF=new aF,aO=function(){function c(a,c){this.center=void 0!==a?a:new b,this.radius=void 0!==c?c:-1}var a=c.prototype;return a.set=function(a,b){return this.center.copy(a),this.radius=b,this},a.setFromPoints=function(a,e){var b=this.center,c,d,f;void 0!==e?b.copy(e):iF.setFromPoints(a).getCenter(b);for(c=0,d=0,f=a.length;d<f;d++)c=Math.max(c,b.distanceToSquared(a[d]));return this.radius=Math.sqrt(c),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.center.copy(a.center),this.radius=a.radius,this},a.isEmpty=function(){return this.radius<0},a.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},a.containsPoint=function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},a.distanceToPoint=function(a){return a.distanceTo(this.center)-this.radius},a.intersectsSphere=function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},a.intersectsBox=function(a){return a.intersectsSphere(this)},a.intersectsPlane=function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},a.clampPoint=function(c,a){var d=this.center.distanceToSquared(c);return void 0===a&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),a=new b),a.copy(c),d>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a},a.getBoundingBox=function(a){return void 0===a&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),a=new aF),this.isEmpty()?(a.makeEmpty(),a):(a.set(this.center,this.center),a.expandByScalar(this.radius),a)},a.applyMatrix4=function(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this},a.translate=function(a){return this.center.add(a),this},a.equals=function(a){return a.center.equals(this.center)&&a.radius===this.radius},c}(),ay=new b,eu=new b,es=new b,aU=new b,ew=new b,eq=new b,ex=new b,bG=function(){function c(a,c){this.origin=void 0!==a?a:new b,this.direction=void 0!==c?c:new b(0,0,-1)}var a=c.prototype;return a.set=function(a,b){return this.origin.copy(a),this.direction.copy(b),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this},a.at=function(c,a){return void 0===a&&(console.warn("THREE.Ray: .at() target is now required"),a=new b),a.copy(this.direction).multiplyScalar(c).add(this.origin)},a.lookAt=function(a){return this.direction.copy(a).sub(this.origin).normalize(),this},a.recast=function(a){return this.origin.copy(this.at(a,ay)),this},a.closestPointToPoint=function(d,a){void 0===a&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),a=new b),a.subVectors(d,this.origin);var c=a.dot(this.direction);return c<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(c).add(this.origin)},a.distanceToPoint=function(a){return Math.sqrt(this.distanceSqToPoint(a))},a.distanceSqToPoint=function(a){var b=ay.subVectors(a,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(a):(ay.copy(this.direction).multiplyScalar(b).add(this.origin),ay.distanceToSquared(a))},a.distanceSqToSegment=function(k,l,o,n){var b,a,g,i,c,e,f,d,h,j,m;return eu.copy(k).add(l).multiplyScalar(.5),es.copy(l).sub(k).normalize(),aU.copy(this.origin).sub(eu),c=.5*k.distanceTo(l),e=-this.direction.dot(es),f=aU.dot(this.direction),d=-aU.dot(es),h=aU.lengthSq(),j=Math.abs(1-e*e),j>0?(a=e*f-d,i=c*j,(b=e*d-f)>=0)?a>=-i?a<=i?(m=1/j,g=(b*=m)*(b+e*(a*=m)+2*f)+a*(e*b+a+2*d)+h):(a=c,g=-(b=Math.max(0,-(e*a+f)))*b+a*(a+2*d)+h):(a=-c,g=-(b=Math.max(0,-(e*a+f)))*b+a*(a+2*d)+h):a<=-i?g=-(b=Math.max(0,-(-e*c+f)))*b+(a=b>0?-c:Math.min(Math.max(-c,-d),c))*(a+2*d)+h:a<=i?(b=0,g=(a=Math.min(Math.max(-c,-d),c))*(a+2*d)+h):g=-(b=Math.max(0,-(e*c+f)))*b+(a=b>0?c:Math.min(Math.max(-c,-d),c))*(a+2*d)+h:(a=e>0?-c:c,g=-(b=Math.max(0,-(e*a+f)))*b+a*(a+2*d)+h),o&&o.copy(this.direction).multiplyScalar(b).add(this.origin),n&&n.copy(es).multiplyScalar(a).add(eu),g},a.intersectSphere=function(g,h){var a,d,e,f,b,c;return ay.subVectors(g.center,this.origin),a=ay.dot(this.direction),d=ay.dot(ay)-a*a,e=g.radius*g.radius,d>e?null:(f=Math.sqrt(e-d),b=a-f,c=a+f,b<0&&c<0?null:b<0?this.at(c,h):this.at(b,h))},a.intersectsSphere=function(a){return this.distanceSqToPoint(a.center)<=a.radius*a.radius},a.distanceToPlane=function(a){var b=a.normal.dot(this.direction),c;return 0===b?0===a.distanceToPoint(this.origin)?0:null:(c=-(this.origin.dot(a.normal)+a.constant)/b,c>=0?c:null)},a.intersectPlane=function(b,c){var a=this.distanceToPlane(b);return null===a?null:this.at(a,c)},a.intersectsPlane=function(a){var b=a.distanceToPoint(this.origin);return 0===b||a.normal.dot(this.direction)*b<0},a.intersectBox=function(c,l){var a,b,f,k,g,e,h=1/this.direction.x,i=1/this.direction.y,j=1/this.direction.z,d=this.origin;return h>=0?(a=(c.min.x-d.x)*h,b=(c.max.x-d.x)*h):(a=(c.max.x-d.x)*h,b=(c.min.x-d.x)*h),i>=0?(f=(c.min.y-d.y)*i,k=(c.max.y-d.y)*i):(f=(c.max.y-d.y)*i,k=(c.min.y-d.y)*i),a>k||f>b?null:((f>a||a!=a)&&(a=f),(k<b||b!=b)&&(b=k),j>=0?(g=(c.min.z-d.z)*j,e=(c.max.z-d.z)*j):(g=(c.max.z-d.z)*j,e=(c.min.z-d.z)*j),a>e||g>b?null:((g>a||a!=a)&&(a=g),(e<b||b!=b)&&(b=e),b<0?null:this.at(a>=0?a:b,l)))},a.intersectsBox=function(a){return null!==this.intersectBox(a,ay)},a.intersectTriangle=function(f,h,i,j,g){var b,a,c,d,e;if(ew.subVectors(h,f),eq.subVectors(i,f),ex.crossVectors(ew,eq),a=this.direction.dot(ex),a>0){if(j)return null;b=1}else{if(!(a<0))return null;b=-1,a=-a}return aU.subVectors(this.origin,f),c=b*this.direction.dot(eq.crossVectors(aU,eq)),c<0?null:(d=b*this.direction.dot(ew.cross(aU)),d<0)?null:c+d>a?null:(e=-b*aU.dot(ex),e<0?null:this.at(e/a,g))},a.applyMatrix4=function(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this},a.equals=function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},c}(),o=function(){function b(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var a=b.prototype;return a.set=function(q,i,c,d,e,f,g,h,b,j,k,l,m,n,o,p){var a=this.elements;return a[0]=q,a[4]=i,a[8]=c,a[12]=d,a[1]=e,a[5]=f,a[9]=g,a[13]=h,a[2]=b,a[6]=j,a[10]=k,a[14]=l,a[3]=m,a[7]=n,a[11]=o,a[15]=p,this},a.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},a.clone=function(){return(new b).fromArray(this.elements)},a.copy=function(c){var a=this.elements,b=c.elements;return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],this},a.copyPosition=function(c){var a=this.elements,b=c.elements;return a[12]=b[12],a[13]=b[13],a[14]=b[14],this},a.setFromMatrix3=function(b){var a=b.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this},a.extractBasis=function(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this},a.makeBasis=function(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this},a.extractRotation=function(c){var a=this.elements,b=c.elements,d=1/bF.setFromMatrixColumn(c,0).length(),e=1/bF.setFromMatrixColumn(c,1).length(),f=1/bF.setFromMatrixColumn(c,2).length();return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=0,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=0,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},a.makeRotationFromEuler=function(h){var a,r,k,j,f,d,g,b,e,c,l,m,n,o,p,q,i,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;return h&&h.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order."),a=this.elements,r=h.x,k=h.y,j=h.z,f=Math.cos(r),d=Math.sin(r),g=Math.cos(k),b=Math.sin(k),e=Math.cos(j),c=Math.sin(j),"XYZ"===h.order?(l=f*e,m=f*c,n=d*e,o=d*c,a[0]=g*e,a[4]=-g*c,a[8]=b,a[1]=m+n*b,a[5]=l-o*b,a[9]=-d*g,a[2]=o-l*b,a[6]=n+m*b,a[10]=f*g):"YXZ"===h.order?(p=g*e,q=g*c,i=b*e,s=b*c,a[0]=p+s*d,a[4]=i*d-q,a[8]=f*b,a[1]=f*c,a[5]=f*e,a[9]=-d,a[2]=q*d-i,a[6]=s+p*d,a[10]=f*g):"ZXY"===h.order?(t=g*e,u=g*c,v=b*e,w=b*c,a[0]=t-w*d,a[4]=-f*c,a[8]=v+u*d,a[1]=u+v*d,a[5]=f*e,a[9]=w-t*d,a[2]=-f*b,a[6]=d,a[10]=f*g):"ZYX"===h.order?(x=f*e,y=f*c,z=d*e,A=d*c,a[0]=g*e,a[4]=z*b-y,a[8]=x*b+A,a[1]=g*c,a[5]=A*b+x,a[9]=y*b-z,a[2]=-b,a[6]=d*g,a[10]=f*g):"YZX"===h.order?(B=f*g,C=f*b,D=d*g,E=d*b,a[0]=g*e,a[4]=E-B*c,a[8]=D*c+C,a[1]=c,a[5]=f*e,a[9]=-d*e,a[2]=-b*e,a[6]=C*c+D,a[10]=B-E*c):"XZY"===h.order&&(F=f*g,G=f*b,H=d*g,I=d*b,a[0]=g*e,a[4]=-c,a[8]=b*e,a[1]=F*c+I,a[5]=f*e,a[9]=G*c-H,a[2]=H*c-G,a[6]=d*e,a[10]=I*c+F),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},a.makeRotationFromQuaternion=function(a){return this.compose(iG,a,iI)},a.lookAt=function(c,d,b){var a=this.elements;return R.subVectors(c,d),0===R.lengthSq()&&(R.z=1),R.normalize(),aG.crossVectors(b,R),0===aG.lengthSq()&&(1===Math.abs(b.z)?R.x+=1e-4:R.z+=1e-4,R.normalize(),aG.crossVectors(b,R)),aG.normalize(),eo.crossVectors(R,aG),a[0]=aG.x,a[4]=eo.x,a[8]=R.x,a[1]=aG.y,a[5]=eo.y,a[9]=R.y,a[2]=aG.z,a[6]=eo.z,a[10]=R.z,this},a.multiply=function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},a.premultiply=function(a){return this.multiplyMatrices(a,this)},a.multiplyMatrices=function(K,J){var c=K.elements,a=J.elements,b=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=a[0],w=a[4],x=a[8],y=a[12],z=a[1],A=a[5],B=a[9],C=a[13],D=a[2],E=a[6],F=a[10],G=a[14],H=a[3],I=a[7],e=a[11],d=a[15];return b[0]=f*v+g*z+h*D+i*H,b[4]=f*w+g*A+h*E+i*I,b[8]=f*x+g*B+h*F+i*e,b[12]=f*y+g*C+h*G+i*d,b[1]=j*v+k*z+l*D+m*H,b[5]=j*w+k*A+l*E+m*I,b[9]=j*x+k*B+l*F+m*e,b[13]=j*y+k*C+l*G+m*d,b[2]=n*v+o*z+p*D+q*H,b[6]=n*w+o*A+p*E+q*I,b[10]=n*x+o*B+p*F+q*e,b[14]=n*y+o*C+p*G+q*d,b[3]=r*v+s*z+t*D+u*H,b[7]=r*w+s*A+t*E+u*I,b[11]=r*x+s*B+t*F+u*e,b[15]=r*y+s*C+t*G+u*d,this},a.multiplyScalar=function(a){var b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},a.determinant=function(){var a=this.elements,g=a[0],c=a[4],d=a[8],e=a[12],f=a[1],b=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14];return a[3]*(+e*h*k-d*i*k-e*b*l+c*i*l+d*b*m-c*h*m)+a[7]*(+g*h*m-g*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(+g*i*k-g*b*m-e*f*k+c*f*m+e*b*j-c*i*j)+a[15]*(-d*b*j-g*h*k+g*b*l+d*f*k-c*f*l+c*h*j)},a.transpose=function(){var b,a=this.elements;return b=a[1],a[1]=a[4],a[4]=b,b=a[2],a[2]=a[8],a[8]=b,b=a[6],a[6]=a[9],a[9]=b,b=a[3],a[3]=a[12],a[12]=b,b=a[7],a[7]=a[13],a[13]=b,b=a[11],a[11]=a[14],a[14]=b,this},a.setPosition=function(b,c,d){var a=this.elements;return b.isVector3?(a[12]=b.x,a[13]=b.y,a[14]=b.z):(a[12]=b,a[13]=c,a[14]=d),this},a.invert=function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],l=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],q=a[10],m=a[11],n=a[12],o=a[13],p=a[14],f=a[15],s=k*p*i-o*q*i+o*h*m-g*p*m-k*h*f+g*q*f,t=n*q*i-j*p*i-n*h*m+l*p*m+j*h*f-l*q*f,u=j*o*i-n*k*i+n*g*m-l*o*m-j*g*f+l*k*f,v=n*k*h-j*o*h-n*g*q+l*o*q+j*g*p-l*k*p,w=b*s+c*t+d*u+e*v,r;return 0===w?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(r=1/w,a[0]=s*r,a[1]=(o*q*e-k*p*e-o*d*m+c*p*m+k*d*f-c*q*f)*r,a[2]=(g*p*e-o*h*e+o*d*i-c*p*i-g*d*f+c*h*f)*r,a[3]=(k*h*e-g*q*e-k*d*i+c*q*i+g*d*m-c*h*m)*r,a[4]=t*r,a[5]=(j*p*e-n*q*e+n*d*m-b*p*m-j*d*f+b*q*f)*r,a[6]=(n*h*e-l*p*e-n*d*i+b*p*i+l*d*f-b*h*f)*r,a[7]=(l*q*e-j*h*e+j*d*i-b*q*i-l*d*m+b*h*m)*r,a[8]=u*r,a[9]=(n*k*e-j*o*e-n*c*m+b*o*m+j*c*f-b*k*f)*r,a[10]=(l*o*e-n*g*e+n*c*i-b*o*i-l*c*f+b*g*f)*r,a[11]=(j*g*e-l*k*e-j*c*i+b*k*i+l*c*m-b*g*m)*r,a[12]=v*r,a[13]=(j*o*d-n*k*d+n*c*q-b*o*q-j*c*p+b*k*p)*r,a[14]=(n*g*d-l*o*d-n*c*h+b*o*h+l*c*p-b*g*p)*r,a[15]=(l*k*d-j*g*d+j*c*h-b*k*h-l*c*q+b*g*q)*r,this)},a.scale=function(e){var a=this.elements,b=e.x,c=e.y,d=e.z;return a[0]*=b,a[4]*=c,a[8]*=d,a[1]*=b,a[5]*=c,a[9]*=d,a[2]*=b,a[6]*=c,a[10]*=d,a[3]*=b,a[7]*=c,a[11]*=d,this},a.getMaxScaleOnAxis=function(){var a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2],c=a[4]*a[4]+a[5]*a[5]+a[6]*a[6],d=a[8]*a[8]+a[9]*a[9]+a[10]*a[10];return Math.sqrt(Math.max(b,c,d))},a.makeTranslation=function(a,b,c){return this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this},a.makeRotationX=function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this},a.makeRotationY=function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this},a.makeRotationZ=function(a){var b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this},a.makeRotationAxis=function(h,j){var f=Math.cos(j),c=Math.sin(j),g=1-f,e=h.x,b=h.y,a=h.z,d=g*e,i=g*b;return this.set(d*e+f,d*b-c*a,d*a+c*b,0,d*b+c*a,i*b+f,i*a-c*e,0,d*a-c*b,i*a+c*e,g*a*a+f,0,0,0,0,1),this},a.makeScale=function(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this},a.makeShear=function(a,b,c){return this.set(1,b,c,0,a,1,c,0,a,b,1,0,0,0,0,1),this},a.compose=function(l,c,g){var a=this.elements,b=c._x,d=c._y,h=c._z,i=c._w,v=b+b,k=d+d,e=h+h,w=b*v,u=b*k,n=b*e,o=d*k,p=d*e,q=h*e,r=i*v,s=i*k,t=i*e,f=g.x,j=g.y,m=g.z;return a[0]=(1-(o+q))*f,a[1]=(u+t)*f,a[2]=(n-s)*f,a[3]=0,a[4]=(u-t)*j,a[5]=(1-(w+q))*j,a[6]=(p+r)*j,a[7]=0,a[8]=(n+s)*m,a[9]=(p-r)*m,a[10]=(1-(w+o))*m,a[11]=0,a[12]=l.x,a[13]=l.y,a[14]=l.z,a[15]=1,this},a.decompose=function(c,j,e){var a=this.elements,b=bF.set(a[0],a[1],a[2]).length(),h=bF.set(a[4],a[5],a[6]).length(),i=bF.set(a[8],a[9],a[10]).length(),d,f,g;return this.determinant()<0&&(b=-b),c.x=a[12],c.y=a[13],c.z=a[14],_.copy(this),d=1/b,f=1/h,g=1/i,_.elements[0]*=d,_.elements[1]*=d,_.elements[2]*=d,_.elements[4]*=f,_.elements[5]*=f,_.elements[6]*=f,_.elements[8]*=g,_.elements[9]*=g,_.elements[10]*=g,j.setFromRotationMatrix(_),e.x=b,e.y=h,e.z=i,this},a.makePerspective=function(g,d,e,f,b,c){void 0===c&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,h=2*b/(d-g),i=2*b/(e-f),j=(d+g)/(d-g),k=(e+f)/(e-f),l=-(c+b)/(c-b),m=-2*c*b/(c-b);return a[0]=h,a[4]=0,a[8]=j,a[12]=0,a[1]=0,a[5]=i,a[9]=k,a[13]=0,a[2]=0,a[6]=0,a[10]=l,a[14]=m,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},a.makeOrthographic=function(b,g,c,d,e,f){var a=this.elements,h=1/(g-b),i=1/(c-d),j=1/(f-e),k=(g+b)*h,l=(c+d)*i,m=(f+e)*j;return a[0]=2*h,a[4]=0,a[8]=0,a[12]=-k,a[1]=0,a[5]=2*i,a[9]=0,a[13]=-l,a[2]=0,a[6]=0,a[10]=-2*j,a[14]=-m,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},a.equals=function(b){for(var c=this.elements,d=b.elements,a=0;a<16;a++)if(c[a]!==d[a])return!1;return!0},a.fromArray=function(c,b){void 0===b&&(b=0);for(var a=0;a<16;a++)this.elements[a]=c[a+b];return this},a.toArray=function(a,b){void 0===a&&(a=[]),void 0===b&&(b=0);var c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a},b}(),bF=new b,_=new o,iG=new b(0,0,0),iI=new b(1,1,1),aG=new b,eo=new b,R=new b,en=function(){function c(a,b,d,e){void 0===a&&(a=0),void 0===b&&(b=0),void 0===d&&(d=0),void 0===e&&(e=c.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=a,this._y=b,this._z=d,this._order=e}var a=c.prototype;return a.set=function(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._order=d||this._order,this._onChangeCallback(),this},a.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},a.copy=function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this},a.setFromRotationMatrix=function(o,m,n){var e=l.clamp,a=o.elements,b=a[0],g=a[4],f=a[8],i=a[1],c=a[5],k=a[9],h=a[2],j=a[6],d=a[10];switch(m=m||this._order){case"XYZ":this._y=Math.asin(e(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-k,d),this._z=Math.atan2(-g,b)):(this._x=Math.atan2(j,c),this._z=0);break;case"YXZ":this._x=Math.asin(-e(k,-1,1)),Math.abs(k)<.9999999?(this._y=Math.atan2(f,d),this._z=Math.atan2(i,c)):(this._y=Math.atan2(-h,b),this._z=0);break;case"ZXY":this._x=Math.asin(e(j,-1,1)),Math.abs(j)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-g,c)):(this._y=0,this._z=Math.atan2(i,b));break;case"ZYX":this._y=Math.asin(-e(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(j,d),this._z=Math.atan2(i,b)):(this._x=0,this._z=Math.atan2(-g,c));break;case"YZX":this._z=Math.asin(e(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(-k,c),this._y=Math.atan2(-h,b)):(this._x=0,this._y=Math.atan2(f,d));break;case"XZY":this._z=Math.asin(-e(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(j,c),this._y=Math.atan2(f,b)):(this._x=Math.atan2(-k,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+m)}return this._order=m,!1!==n&&this._onChangeCallback(),this},a.setFromQuaternion=function(a,b,c){return gO.makeRotationFromQuaternion(a),this.setFromRotationMatrix(gO,b,c)},a.setFromVector3=function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},a.reorder=function(a){return gR.setFromEuler(this),this.setFromQuaternion(gR,a)},a.equals=function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},a.fromArray=function(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this._onChangeCallback(),this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a},a.toVector3=function(a){return a?a.set(this._x,this._y,this._z):new b(this._x,this._y,this._z)},a._onChange=function(a){return this._onChangeCallback=a,this},a._onChangeCallback=function(){},eP(c,[{key:"x",get:function(){return this._x},set:function(a){this._x=a,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(a){this._y=a,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(a){this._z=a,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(a){this._order=a,this._onChangeCallback()}}]),c}(),en.DefaultOrder="XYZ",en.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],gO=new o,gR=new G,eE=function(){function b(){this.mask=1}var a=b.prototype;return a.set=function(a){this.mask=1<<a|0},a.enable=function(a){this.mask|=1<<a|0},a.enableAll=function(){this.mask=-1},a.toggle=function(a){this.mask^=1<<a|0},a.disable=function(a){this.mask&=~(1<<a|0)},a.disableAll=function(){this.mask=0},a.test=function(a){return 0!=(this.mask&a.mask)},b}(),iW=0,gX=new b,bz=new G,aD=new o,d_=new b,cG=new b,i_=new b,jd=new G,g_=new b(1,0,0),hj=new b(0,1,0),hk=new b(0,0,1),jx={type:"added"},ho={type:"removed"};function g(){Object.defineProperty(this,"id",{value:iW++}),this.uuid=l.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=g.DefaultUp.clone();var d=new b,a=new en,c=new G,e=new b(1,1,1);a._onChange(function(){c.setFromEuler(a,!1)}),c._onChange(function(){a.setFromQuaternion(c,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:d},rotation:{configurable:!0,enumerable:!0,value:a},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:e},modelViewMatrix:{value:new o},normalMatrix:{value:new Q}}),this.matrix=new o,this.matrixWorld=new o,this.matrixAutoUpdate=g.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new eE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}g.DefaultUp=new b(0,1,0),g.DefaultMatrixAutoUpdate=!0,g.prototype=Object.assign(Object.create(aN.prototype),{constructor:g,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(a){return this.quaternion.premultiply(a),this},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(a,b){return bz.setFromAxisAngle(a,b),this.quaternion.multiply(bz),this},rotateOnWorldAxis:function(a,b){return bz.setFromAxisAngle(a,b),this.quaternion.premultiply(bz),this},rotateX:function(a){return this.rotateOnAxis(g_,a)},rotateY:function(a){return this.rotateOnAxis(hj,a)},rotateZ:function(a){return this.rotateOnAxis(hk,a)},translateOnAxis:function(a,b){return gX.copy(a).applyQuaternion(this.quaternion),this.position.add(gX.multiplyScalar(b)),this},translateX:function(a){return this.translateOnAxis(g_,a)},translateY:function(a){return this.translateOnAxis(hj,a)},translateZ:function(a){return this.translateOnAxis(hk,a)},localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(a){return a.applyMatrix4(aD.copy(this.matrixWorld).invert())},lookAt:function(a,c,d){a.isVector3?d_.copy(a):d_.set(a,c,d);var b=this.parent;this.updateWorldMatrix(!0,!1),cG.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aD.lookAt(cG,d_,this.up):aD.lookAt(d_,cG,this.up),this.quaternion.setFromRotationMatrix(aD),b&&(aD.extractRotation(b.matrixWorld),bz.setFromRotationMatrix(aD),this.quaternion.premultiply(bz.invert()))},add:function(a){if(arguments.length>1){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}return a===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",a),this):(a&&a.isObject3D?(null!==a.parent&&a.parent.remove(a),a.parent=this,this.children.push(a),a.dispatchEvent(jx)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this)},remove:function(b){var a,c;if(arguments.length>1){for(a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}return c=this.children.indexOf(b),-1!==c&&(b.parent=null,this.children.splice(c,1),b.dispatchEvent(ho)),this},clear:function(){for(var a=0,b;a<this.children.length;a++)b=this.children[a],b.parent=null,b.dispatchEvent(ho);return this.children.length=0,this},attach:function(a){return this.updateWorldMatrix(!0,!1),aD.copy(this.matrixWorld).invert(),null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),aD.multiply(a.parent.matrixWorld)),a.applyMatrix4(aD),a.updateWorldMatrix(!1,!1),this.add(a),this},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(c,d){var a,e,b;if(this[c]===d)return this;for(a=0,e=this.children.length;a<e;a++)if(b=this.children[a].getObjectByProperty(c,d),void 0!==b)return b},getWorldPosition:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),a=new b),this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),a=new G),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cG,a,i_),a},getWorldScale:function(a){return void 0===a&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),a=new b),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cG,jd,a),a},getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),a=new b),this.updateWorldMatrix(!0,!1);var c=this.matrixWorld.elements;return a.set(c[8],c[9],c[10]).normalize()},raycast:function(){},traverse:function(b){b(this);for(var c=this.children,a=0,d=c.length;a<d;a++)c[a].traverse(b)},traverseVisible:function(b){if(!1!==this.visible){b(this);for(var c=this.children,a=0,d=c.length;a<d;a++)c[a].traverseVisible(b)}},traverseAncestors:function(b){var a=this.parent;null!==a&&(b(a),a.traverseAncestors(b))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0);for(var c=this.children,b=0,d=c.length;b<d;b++)c[b].updateMatrixWorld(a)},updateWorldMatrix:function(d,e){var b=this.parent,c,a,f;if(!0===d&&null!==b&&b.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(c=this.children,a=0,f=c.length;a<f;a++)c[a].updateWorldMatrix(!1,!0)},toJSON:function(b){var m=void 0===b||"string"==typeof b,c={},a,k,f,h,v,w,l,g,x,j,i,u,q,r,s,t,p,o,n;m&&(b={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},c.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"}),a={};function d(c,a){return void 0===c[a.uuid]&&(c[a.uuid]=a.toJSON(b)),a.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints)if(a.geometry=d(b.geometries,this.geometry),k=this.geometry.parameters,void 0!==k&&void 0!==k.shapes)if(f=k.shapes,Array.isArray(f))for(h=0,v=f.length;h<v;h++)w=f[h],d(b.shapes,w);else d(b.shapes,f);if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(d(b.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(l=[],g=0,x=this.material.length;g<x;g++)l.push(d(b.materials,this.material[g]));a.material=l}else a.material=d(b.materials,this.material);if(this.children.length>0){a.children=[];for(j=0;j<this.children.length;j++)a.children.push(this.children[j].toJSON(b).object)}if(this.animations.length>0){a.animations=[];for(i=0;i<this.animations.length;i++)u=this.animations[i],a.animations.push(d(b.animations,u))}return m&&(q=e(b.geometries),r=e(b.materials),s=e(b.textures),t=e(b.images),p=e(b.shapes),o=e(b.skeletons),n=e(b.animations),q.length>0&&(c.geometries=q),r.length>0&&(c.materials=r),s.length>0&&(c.textures=s),t.length>0&&(c.images=t),p.length>0&&(c.shapes=p),o.length>0&&(c.skeletons=o),n.length>0&&(c.animations=n)),c.object=a,c;function e(a){var b=[],d,c;for(d in a)c=a[d],delete c.metadata,b.push(c);return b}},clone:function(a){return(new this.constructor).copy(this,a)},copy:function(a,c){var b,d;if(void 0===c&&(c=!0),this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.userData=JSON.parse(JSON.stringify(a.userData)),!0===c)for(b=0;b<a.children.length;b++)d=a.children[b],this.add(d.clone());return this}}),eK=new b,jt=new b,jr=new Q,am=function(){function c(a,c){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=void 0!==a?a:new b(1,0,0),this.constant=void 0!==c?c:0}var a=c.prototype;return a.set=function(a,b){return this.normal.copy(a),this.constant=b,this},a.setComponents=function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},a.setFromNormalAndCoplanarPoint=function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},a.setFromCoplanarPoints=function(a,b,c){var d=eK.subVectors(c,b).cross(jt.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(d,a),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},a.normalize=function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},a.negate=function(){return this.constant*=-1,this.normal.negate(),this},a.distanceToPoint=function(a){return this.normal.dot(a)+this.constant},a.distanceToSphere=function(a){return this.distanceToPoint(a.center)-a.radius},a.projectPoint=function(c,a){return void 0===a&&(console.warn("THREE.Plane: .projectPoint() target is now required"),a=new b),a.copy(this.normal).multiplyScalar(-this.distanceToPoint(c)).add(c)},a.intersectLine=function(a,c){var e,f,d;return void 0===c&&(console.warn("THREE.Plane: .intersectLine() target is now required"),c=new b),e=a.delta(eK),f=this.normal.dot(e),0===f?0===this.distanceToPoint(a.start)?c.copy(a.start):void 0:(d=-(a.start.dot(this.normal)+this.constant)/f,d<0||d>1?void 0:c.copy(e).multiplyScalar(d).add(a.start))},a.intersectsLine=function(a){var b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0},a.intersectsBox=function(a){return a.intersectsPlane(this)},a.intersectsSphere=function(a){return a.intersectsPlane(this)},a.coplanarPoint=function(a){return void 0===a&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),a=new b),a.copy(this.normal).multiplyScalar(-this.constant)},a.applyMatrix4=function(a,b){var c=b||jr.getNormalMatrix(a),d=this.coplanarPoint(eK).applyMatrix4(a),e=this.normal.applyMatrix3(c).normalize();return this.constant=-d.dot(e),this},a.translate=function(a){return this.constant-=a.dot(this.normal),this},a.equals=function(a){return a.normal.equals(this.normal)&&a.constant===this.constant},c}(),ab=new b,ax=new b,eX=new b,av=new b,bL=new b,bM=new b,hK=new b,eY=new b,fd=new b,fe=new b,ai=function(){function c(a,c,d){this.a=void 0!==a?a:new b,this.b=void 0!==c?c:new b,this.c=void 0!==d?d:new b}c.getNormal=function(e,c,f,a){void 0===a&&(console.warn("THREE.Triangle: .getNormal() target is now required"),a=new b),a.subVectors(f,c),ab.subVectors(e,c),a.cross(ab);var d=a.lengthSq();return d>0?a.multiplyScalar(1/Math.sqrt(d)):a.set(0,0,0)},c.getBarycoord=function(o,h,n,m,c){var g,a,i,j,k,l,e,f,d;return(ab.subVectors(m,h),ax.subVectors(n,h),eX.subVectors(o,h),g=ab.dot(ab),a=ab.dot(ax),i=ab.dot(eX),j=ax.dot(ax),k=ax.dot(eX),l=g*j-a*a,void 0===c&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),c=new b),0===l)?c.set(-2,-1,-1):(e=1/l,f=(j*i-a*k)*e,d=(g*k-a*i)*e,c.set(1-f-d,d,f))},c.containsPoint=function(a,b,c,d){return this.getBarycoord(a,b,c,d,av),av.x>=0&&av.y>=0&&av.x+av.y<=1},c.getUV=function(b,h,c,d,e,f,g,a){return this.getBarycoord(b,h,c,d,av),a.set(0,0),a.addScaledVector(e,av.x),a.addScaledVector(f,av.y),a.addScaledVector(g,av.z),a},c.isFrontFacing=function(b,a,c,d){return ab.subVectors(c,a),ax.subVectors(b,a),ab.cross(ax).dot(d)<0};var a=c.prototype;return a.set=function(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this},a.setFromPointsAndIndices=function(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this},a.getArea=function(){return ab.subVectors(this.c,this.b),ax.subVectors(this.a,this.b),.5*ab.cross(ax).length()},a.getMidpoint=function(a){return void 0===a&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),a=new b),a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},a.getNormal=function(a){return c.getNormal(this.a,this.b,this.c,a)},a.getPlane=function(a){return void 0===a&&(console.warn("THREE.Triangle: .getPlane() target is now required"),a=new am),a.setFromCoplanarPoints(this.a,this.b,this.c)},a.getBarycoord=function(a,b){return c.getBarycoord(a,this.a,this.b,this.c,b)},a.getUV=function(a,b,d,e,f){return c.getUV(a,this.a,this.b,this.c,b,d,e,f)},a.containsPoint=function(a){return c.containsPoint(a,this.a,this.b,this.c)},a.isFrontFacing=function(a){return c.isFrontFacing(this.a,this.b,this.c,a)},a.intersectsBox=function(a){return a.intersectsTriangle(this)},a.closestPointToPoint=function(p,d){var m,g,e,j,l,i,h,a,f,n,k,c,o,q,r;return void 0===d&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),d=new b),e=this.a,j=this.b,l=this.c,bL.subVectors(j,e),bM.subVectors(l,e),eY.subVectors(p,e),i=bL.dot(eY),h=bM.dot(eY),i<=0&&h<=0?d.copy(e):(fd.subVectors(p,j),a=bL.dot(fd),f=bM.dot(fd),a>=0&&f<=a)?d.copy(j):(n=i*f-a*h,n<=0&&i>=0&&a<=0)?(m=i/(i-a),d.copy(e).addScaledVector(bL,m)):(fe.subVectors(p,l),k=bL.dot(fe),c=bM.dot(fe),c>=0&&k<=c)?d.copy(l):(o=k*h-i*c,o<=0&&h>=0&&c<=0)?(g=h/(h-c),d.copy(e).addScaledVector(bM,g)):(q=a*c-k*f,q<=0&&f-a>=0&&k-c>=0)?(hK.subVectors(l,j),g=(f-a)/(f-a+(k-c)),d.copy(j).addScaledVector(hK,g)):(r=1/(q+o+n),m=o*r,g=n*r,d.copy(e).addScaledVector(bL,m).addScaledVector(bM,g))},a.equals=function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},c}(),hv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},af={h:0,s:0,l:0},dI={h:0,s:0,l:0};function hw(b,c,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?b+6*(c-b)*a:a<.5?c:a<2/3?b+6*(c-b)*(2/3-a):b}function hz(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function hE(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}e=function(){function b(a,b,c){return Object.defineProperty(this,"isColor",{value:!0}),void 0===b&&void 0===c?this.set(a):this.setRGB(a,b,c)}var a=b.prototype;return a.set=function(a){return a&&a.isColor?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),this},a.setScalar=function(a){return this.r=a,this.g=a,this.b=a,this},a.setHex=function(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this},a.setRGB=function(a,b,c){return this.r=a,this.g=b,this.b=c,this},a.setHSL=function(c,b,a){if(c=l.euclideanModulo(c,1),b=l.clamp(b,0,1),a=l.clamp(a,0,1),0===b)this.r=this.g=this.b=a;else{var d=a<=.5?a*(1+b):a+b-a*b,e=2*a-d;this.r=hw(e,d,c+1/3),this.g=hw(e,d,c),this.b=hw(e,d,c-1/3)}return this},a.setStyle=function(c){var d,a,k,e,h,i,j,b,g;function f(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+c+" will be ignored.")}if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(c))switch(k=d[1],e=d[2],k){case"rgb":case"rgba":if(a=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,f(a[4]),this;if(a=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,f(a[4]),this;break;case"hsl":case"hsla":if(a=/^(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(e))return h=parseFloat(a[1])/360,i=parseInt(a[2],10)/100,j=parseInt(a[3],10)/100,f(a[4]),this.setHSL(h,i,j)}else if(d=/^\#([A-Fa-f\d]+)$/.exec(c)){if(b=d[1],g=b.length,3===g)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===g)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}return c&&c.length>0?this.setColorName(c):this},a.setColorName=function(a){var b=hv[a];return void 0!==b?this.setHex(b):console.warn("THREE.Color: Unknown color "+a),this},a.clone=function(){return new this.constructor(this.r,this.g,this.b)},a.copy=function(a){return this.r=a.r,this.g=a.g,this.b=a.b,this},a.copyGammaToLinear=function(b,a){return void 0===a&&(a=2),this.r=Math.pow(b.r,a),this.g=Math.pow(b.g,a),this.b=Math.pow(b.b,a),this},a.copyLinearToGamma=function(b,a){void 0===a&&(a=2);var c=a>0?1/a:1;return this.r=Math.pow(b.r,c),this.g=Math.pow(b.g,c),this.b=Math.pow(b.b,c),this},a.convertGammaToLinear=function(a){return this.copyGammaToLinear(this,a),this},a.convertLinearToGamma=function(a){return this.copyLinearToGamma(this,a),this},a.copySRGBToLinear=function(a){return this.r=hz(a.r),this.g=hz(a.g),this.b=hz(a.b),this},a.copyLinearToSRGB=function(a){return this.r=hE(a.r),this.g=hE(a.g),this.b=hE(a.b),this},a.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},a.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},a.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},a.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},a.getHSL=function(f){var b,i,e,c,d,a,g,j,h;if(void 0===f&&(console.warn("THREE.Color: .getHSL() target is now required"),f={h:0,s:0,l:0}),e=this.r,c=this.g,d=this.b,a=Math.max(e,c,d),g=Math.min(e,c,d),j=(g+a)/2,g===a)b=0,i=0;else{switch(h=a-g,i=j<=.5?h/(a+g):h/(2-a-g),a){case e:b=(c-d)/h+(c<d?6:0);break;case c:b=(d-e)/h+2;break;case d:b=(e-c)/h+4}b/=6}return f.h=b,f.s=i,f.l=j,f},a.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},a.offsetHSL=function(a,b,c){return this.getHSL(af),af.h+=a,af.s+=b,af.l+=c,this.setHSL(af.h,af.s,af.l),this},a.add=function(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this},a.addColors=function(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this},a.addScalar=function(a){return this.r+=a,this.g+=a,this.b+=a,this},a.sub=function(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this},a.multiply=function(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this},a.multiplyScalar=function(a){return this.r*=a,this.g*=a,this.b*=a,this},a.lerp=function(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this},a.lerpColors=function(a,b,c){return this.r=a.r+(b.r-a.r)*c,this.g=a.g+(b.g-a.g)*c,this.b=a.b+(b.b-a.b)*c,this},a.lerpHSL=function(b,a){this.getHSL(af),b.getHSL(dI);var c=l.lerp(af.h,dI.h,a),d=l.lerp(af.s,dI.s,a),e=l.lerp(af.l,dI.l,a);return this.setHSL(c,d,e),this},a.equals=function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},a.fromArray=function(b,a){return void 0===a&&(a=0),this.r=b[a],this.g=b[a+1],this.b=b[a+2],this},a.toArray=function(a,b){return void 0===a&&(a=[]),void 0===b&&(b=0),a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a},a.fromBufferAttribute=function(a,b){return this.r=a.getX(b),this.g=a.getY(b),this.b=a.getZ(b),!0===a.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},a.toJSON=function(){return this.getHex()},b}(),e.NAMES=hv,e.prototype.r=1,e.prototype.g=1,e.prototype.b=1,fo=function(){function a(f,g,h,a,c,d){void 0===d&&(d=0),this.a=f,this.b=g,this.c=h,this.normal=a&&a.isVector3?a:new b,this.vertexNormals=Array.isArray(a)?a:[],this.color=c&&c.isColor?c:new e,this.vertexColors=Array.isArray(c)?c:[],this.materialIndex=d}var c=a.prototype;return c.clone=function(){return(new this.constructor).copy(this)},c.copy=function(a){var b,d,c,e;this.a=a.a,this.b=a.b,this.c=a.c,this.normal.copy(a.normal),this.color.copy(a.color),this.materialIndex=a.materialIndex;for(b=0,d=a.vertexNormals.length;b<d;b++)this.vertexNormals[b]=a.vertexNormals[b].clone();for(c=0,e=a.vertexColors.length;c<e;c++)this.vertexColors[c]=a.vertexColors[c].clone();return this},a}(),iV=0;function j(){Object.defineProperty(this,"id",{value:iV++}),this.uuid=l.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=bA,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=dR,this.stencilZFail=dR,this.stencilZPass=dR,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function W(a){j.call(this),this.type="MeshBasicMaterial",this.color=new e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(a)}j.prototype=Object.assign(Object.create(aN.prototype),{constructor:j,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(d){var c,a,b;if(void 0!==d)for(c in d)a=d[c],void 0!==a?"shading"!==c?(b=this[c],void 0!==b?b&&b.isColor?b.set(a):b&&b.isVector3&&a&&a.isVector3?b.copy(a):this[c]=a:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")):(console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a):console.warn("THREE.Material: '"+c+"' parameter is undefined.")},toJSON:function(b){var c=void 0===b||"string"==typeof b,a,e,f;c&&(b={textures:{},images:{}}),a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function d(a){var b=[],d,c;for(d in a)c=a[d],delete c.metadata,b.push(c);return b}return a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),void 0!==this.roughness&&(a.roughness=this.roughness),void 0!==this.metalness&&(a.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(a.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),void 0!==this.shininess&&(a.shininess=this.shininess),void 0!==this.clearcoat&&(a.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(b).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(b).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(b).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(b).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(b).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(b).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(b).uuid),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(b).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(b).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(b).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(b).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(b).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(b).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(b).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(b).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(b).uuid,a.reflectivity=this.reflectivity,a.refractionRatio=this.refractionRatio,void 0!==this.combine&&(a.combine=this.combine),void 0!==this.envMapIntensity&&(a.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(b).uuid),void 0!==this.size&&(a.size=this.size),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(a.blending=this.blending),!0===this.flatShading&&(a.flatShading=this.flatShading),0!==this.side&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),!0===this.transparent&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(a.rotation=this.rotation),!0===this.polygonOffset&&(a.polygonOffset=!0),0!==this.polygonOffsetFactor&&(a.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(a.linewidth=this.linewidth),void 0!==this.dashSize&&(a.dashSize=this.dashSize),void 0!==this.gapSize&&(a.gapSize=this.gapSize),void 0!==this.scale&&(a.scale=this.scale),!0===this.dithering&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(a.morphTargets=!0),!0===this.morphNormals&&(a.morphNormals=!0),!0===this.skinning&&(a.skinning=!0),!1===this.visible&&(a.visible=!1),!1===this.toneMapped&&(a.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),c&&(e=d(b.textures),f=d(b.images),e.length>0&&(a.textures=e),f.length>0&&(a.images=f)),a},clone:function(){return(new this.constructor).copy(this)},copy:function(a){var c,d,e,b;if(this.name=a.name,this.fog=a.fog,this.blending=a.blending,this.side=a.side,this.flatShading=a.flatShading,this.vertexColors=a.vertexColors,this.opacity=a.opacity,this.transparent=a.transparent,this.blendSrc=a.blendSrc,this.blendDst=a.blendDst,this.blendEquation=a.blendEquation,this.blendSrcAlpha=a.blendSrcAlpha,this.blendDstAlpha=a.blendDstAlpha,this.blendEquationAlpha=a.blendEquationAlpha,this.depthFunc=a.depthFunc,this.depthTest=a.depthTest,this.depthWrite=a.depthWrite,this.stencilWriteMask=a.stencilWriteMask,this.stencilFunc=a.stencilFunc,this.stencilRef=a.stencilRef,this.stencilFuncMask=a.stencilFuncMask,this.stencilFail=a.stencilFail,this.stencilZFail=a.stencilZFail,this.stencilZPass=a.stencilZPass,this.stencilWrite=a.stencilWrite,c=a.clippingPlanes,d=null,null!==c){e=c.length,d=new Array(e);for(b=0;b!==e;++b)d[b]=c[b].clone()}return this.clippingPlanes=d,this.clipIntersection=a.clipIntersection,this.clipShadows=a.clipShadows,this.shadowSide=a.shadowSide,this.colorWrite=a.colorWrite,this.precision=a.precision,this.polygonOffset=a.polygonOffset,this.polygonOffsetFactor=a.polygonOffsetFactor,this.polygonOffsetUnits=a.polygonOffsetUnits,this.dithering=a.dithering,this.alphaTest=a.alphaTest,this.premultipliedAlpha=a.premultipliedAlpha,this.visible=a.visible,this.toneMapped=a.toneMapped,this.userData=JSON.parse(JSON.stringify(a.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(j.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),W.prototype=Object.create(j.prototype),W.prototype.constructor=W,W.prototype.isMeshBasicMaterial=!0,W.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this},s=new b,dz=new c;function k(a,b,c){if(Array.isArray(a))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=a,this.itemSize=b,this.count=void 0!==a?a.length/b:0,this.normalized=!0===c,this.usage=cj,this.updateRange={offset:0,count:-1},this.version=0}function dy(a,b,c){k.call(this,new Int8Array(a),b,c)}function dx(a,b,c){k.call(this,new Uint8Array(a),b,c)}function dw(a,b,c){k.call(this,new Uint8ClampedArray(a),b,c)}function du(a,b,c){k.call(this,new Int16Array(a),b,c)}function cb(a,b,c){k.call(this,new Uint16Array(a),b,c)}function dt(a,b,c){k.call(this,new Int32Array(a),b,c)}function b$(a,b,c){k.call(this,new Uint32Array(a),b,c)}function ds(a,b,c){k.call(this,new Uint16Array(a),b,c)}function f(a,b,c){k.call(this,new Float32Array(a),b,c)}function dr(a,b,c){k.call(this,new Float64Array(a),b,c)}function iU(a){if(0===a.length)return-1/0;for(var c=a[0],b=1,d=a.length;b<d;++b)a[b]>c&&(c=a[b]);return c}Object.defineProperty(k.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(k.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(a){return this.usage=a,this},copy:function(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this},copyAt:function(b,c,d){b*=this.itemSize,d*=c.itemSize;for(var a=0,e=this.itemSize;a<e;a++)this.array[b+a]=c.array[d+a];return this},copyArray:function(a){return this.array.set(a),this},copyColorsArray:function(f){for(var c=this.array,d=0,b=0,g=f.length,a;b<g;b++)a=f[b],void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",b),a=new e),c[d++]=a.r,c[d++]=a.g,c[d++]=a.b;return this},copyVector2sArray:function(d){for(var e=this.array,f=0,a=0,g=d.length,b;a<g;a++)b=d[a],void 0===b&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",a),b=new c),e[f++]=b.x,e[f++]=b.y;return this},copyVector3sArray:function(f){for(var d=this.array,e=0,c=0,g=f.length,a;c<g;c++)a=f[c],void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",c),a=new b),d[e++]=a.x,d[e++]=a.y,d[e++]=a.z;return this},copyVector4sArray:function(e){for(var b=this.array,c=0,d=0,f=e.length,a;d<f;d++)a=e[d],void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),a=new q),b[c++]=a.x,b[c++]=a.y,b[c++]=a.z,b[c++]=a.w;return this},applyMatrix3:function(c){var a,d,b,e;if(2===this.itemSize)for(a=0,d=this.count;a<d;a++)dz.fromBufferAttribute(this,a),dz.applyMatrix3(c),this.setXY(a,dz.x,dz.y);else if(3===this.itemSize)for(b=0,e=this.count;b<e;b++)s.fromBufferAttribute(this,b),s.applyMatrix3(c),this.setXYZ(b,s.x,s.y,s.z);return this},applyMatrix4:function(b){for(var a=0,c=this.count;a<c;a++)s.x=this.getX(a),s.y=this.getY(a),s.z=this.getZ(a),s.applyMatrix4(b),this.setXYZ(a,s.x,s.y,s.z);return this},applyNormalMatrix:function(b){for(var a=0,c=this.count;a<c;a++)s.x=this.getX(a),s.y=this.getY(a),s.z=this.getZ(a),s.applyNormalMatrix(b),this.setXYZ(a,s.x,s.y,s.z);return this},transformDirection:function(b){for(var a=0,c=this.count;a<c;a++)s.x=this.getX(a),s.y=this.getY(a),s.z=this.getZ(a),s.transformDirection(b),this.setXYZ(a,s.x,s.y,s.z);return this},set:function(b,a){return void 0===a&&(a=0),this.array.set(b,a),this},getX:function(a){return this.array[a*this.itemSize]},setX:function(a,b){return this.array[a*this.itemSize]=b,this},getY:function(a){return this.array[a*this.itemSize+1]},setY:function(a,b){return this.array[a*this.itemSize+1]=b,this},getZ:function(a){return this.array[a*this.itemSize+2]},setZ:function(a,b){return this.array[a*this.itemSize+2]=b,this},getW:function(a){return this.array[a*this.itemSize+3]},setW:function(a,b){return this.array[a*this.itemSize+3]=b,this},setXY:function(a,b,c){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this},setXYZ:function(a,b,c,d){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a*=this.itemSize,this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this},onUpload:function(a){return this.onUploadCallback=a,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),dy.prototype=Object.create(k.prototype),dy.prototype.constructor=dy,dx.prototype=Object.create(k.prototype),dx.prototype.constructor=dx,dw.prototype=Object.create(k.prototype),dw.prototype.constructor=dw,du.prototype=Object.create(k.prototype),du.prototype.constructor=du,cb.prototype=Object.create(k.prototype),cb.prototype.constructor=cb,dt.prototype=Object.create(k.prototype),dt.prototype.constructor=dt,b$.prototype=Object.create(k.prototype),b$.prototype.constructor=b$,ds.prototype=Object.create(k.prototype),ds.prototype.constructor=ds,ds.prototype.isFloat16BufferAttribute=!0,f.prototype=Object.create(k.prototype),f.prototype.constructor=f,dr.prototype=Object.create(k.prototype),dr.prototype.constructor=dr,iT={Int8Array,Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dk(a,b){return new iT[a](b)}iS=0,al=new o,fH=new g,bU=new b,P=new aF,cw=new aF,B=new b;function i(){Object.defineProperty(this,"id",{value:iS++}),this.uuid=l.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}i.prototype=Object.assign(Object.create(aN.prototype),{constructor:i,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(a){return Array.isArray(a)?this.index=new(iU(a)>65535?b$:cb)(a,1):this.index=a,this},getAttribute:function(a){return this.attributes[a]},setAttribute:function(a,b){return this.attributes[a]=b,this},deleteAttribute:function(a){return delete this.attributes[a],this},hasAttribute:function(a){return void 0!==this.attributes[a]},addGroup:function(b,c,a){void 0===a&&(a=0),this.groups.push({start:b,count:c,materialIndex:a})},clearGroups:function(){this.groups=[]},setDrawRange:function(a,b){this.drawRange.start=a,this.drawRange.count=b},applyMatrix4:function(a){var b=this.attributes.position,c,e,d;return void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0),c=this.attributes.normal,void 0!==c&&(e=(new Q).getNormalMatrix(a),c.applyNormalMatrix(e),c.needsUpdate=!0),d=this.attributes.tangent,void 0!==d&&(d.transformDirection(a),d.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(a){return al.makeRotationX(a),this.applyMatrix4(al),this},rotateY:function(a){return al.makeRotationY(a),this.applyMatrix4(al),this},rotateZ:function(a){return al.makeRotationZ(a),this.applyMatrix4(al),this},translate:function(a,b,c){return al.makeTranslation(a,b,c),this.applyMatrix4(al),this},scale:function(a,b,c){return al.makeScale(a,b,c),this.applyMatrix4(al),this},lookAt:function(a){return fH.lookAt(a),fH.updateMatrix(),this.applyMatrix4(fH.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(bU).negate(),this.translate(bU.x,bU.y,bU.z),this},setFromPoints:function(c){for(var d=[],a=0,e=c.length,b;a<e;a++)b=c[a],d.push(b.x,b.y,b.z||0);return this.setAttribute("position",new f(d,3)),this},computeBoundingBox:function(){var a,c,d,e,f;if(null===this.boundingBox&&(this.boundingBox=new aF),a=this.attributes.position,c=this.morphAttributes.position,a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new b(-1/0,-1/0,-1/0),new b(1/0,1/0,1/0));if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),c)for(d=0,e=c.length;d<e;d++)f=c[d],P.setFromBufferAttribute(f),this.morphTargetsRelative?(B.addVectors(this.boundingBox.min,P.min),this.boundingBox.expandByPoint(B),B.addVectors(this.boundingBox.max,P.max),this.boundingBox.expandByPoint(B)):(this.boundingBox.expandByPoint(P.min),this.boundingBox.expandByPoint(P.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var a,c,f,g,o,l,d,i,k,h,m,j,n,e,p;if(null===this.boundingSphere&&(this.boundingSphere=new aO),a=this.attributes.position,c=this.morphAttributes.position,a&&a.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new b,1/0);if(a){if(f=this.boundingSphere.center,P.setFromBufferAttribute(a),c)for(g=0,o=c.length;g<o;g++)l=c[g],cw.setFromBufferAttribute(l),this.morphTargetsRelative?(B.addVectors(P.min,cw.min),P.expandByPoint(B),B.addVectors(P.max,cw.max),P.expandByPoint(B)):(P.expandByPoint(cw.min),P.expandByPoint(cw.max));P.getCenter(f);for(d=0,i=0,k=a.count;i<k;i++)B.fromBufferAttribute(a,i),d=Math.max(d,f.distanceToSquared(B));if(c)for(h=0,m=c.length;h<m;h++)for(j=c[h],n=this.morphTargetsRelative,e=0,p=j.count;e<p;e++)B.fromBufferAttribute(j,e),n&&(bU.fromBufferAttribute(a,e),B.add(bU)),d=Math.max(d,f.distanceToSquared(B));this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var I=this.index,a=this.attributes,d,s,L,v,H,o,l,i,t,z,p,q,y,e,g,u,n,f,x,J,D,B,j,K,m,E,r,G,w,O,F,C,h,M;if(null!==I&&void 0!==a.position&&void 0!==a.normal&&void 0!==a.uv){d=I.array,s=a.position.array,L=a.normal.array,v=a.uv.array,H=s.length/3,void 0===a.tangent&&this.setAttribute("tangent",new k(new Float32Array(4*H),4));for(o=a.tangent.array,l=[],i=[],t=0;t<H;t++)l[t]=new b,i[t]=new b;z=new b,p=new b,q=new b,y=new c,e=new c,g=new c,u=new b,n=new b,f=this.groups,0===f.length&&(f=[{start:0,count:d.length}]);for(x=0,J=f.length;x<J;++x)for(D=f[x],B=D.start,j=B,K=B+D.count;j<K;j+=3)N(d[j+0],d[j+1],d[j+2]);for(m=new b,E=new b,r=new b,G=new b,w=0,O=f.length;w<O;++w)for(F=f[w],C=F.start,h=C,M=C+F.count;h<M;h+=3)A(d[h+0]),A(d[h+1]),A(d[h+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function N(a,b,c){z.fromArray(s,3*a),p.fromArray(s,3*b),q.fromArray(s,3*c),y.fromArray(v,2*a),e.fromArray(v,2*b),g.fromArray(v,2*c),p.sub(z),q.sub(z),e.sub(y),g.sub(y);var d=1/(e.x*g.y-g.x*e.y);isFinite(d)&&(u.copy(p).multiplyScalar(g.y).addScaledVector(q,-e.y).multiplyScalar(d),n.copy(q).multiplyScalar(e.x).addScaledVector(p,-g.x).multiplyScalar(d),l[a].add(u),l[b].add(u),l[c].add(u),i[a].add(n),i[b].add(n),i[c].add(n))}function A(a){var b,c;r.fromArray(L,3*a),G.copy(r),b=l[a],m.copy(b),m.sub(r.multiplyScalar(r.dot(b))).normalize(),E.crossVectors(G,b),c=E.dot(i[a])<0?-1:1,o[4*a]=m.x,o[4*a+1]=m.y,o[4*a+2]=m.z,o[4*a+3]=c}},computeVertexNormals:function(){var l=this.index,d=this.getAttribute("position"),c,s,t,n,f,m,j,h,i,a,o,g,u,p,q,r,e,v;if(void 0!==d){if(c=this.getAttribute("normal"),void 0===c)c=new k(new Float32Array(3*d.count),3),this.setAttribute("normal",c);else for(s=0,t=c.count;s<t;s++)c.setXYZ(s,0,0,0);if(n=new b,f=new b,m=new b,j=new b,h=new b,i=new b,a=new b,o=new b,l)for(g=0,u=l.count;g<u;g+=3)p=l.getX(g+0),q=l.getX(g+1),r=l.getX(g+2),n.fromBufferAttribute(d,p),f.fromBufferAttribute(d,q),m.fromBufferAttribute(d,r),a.subVectors(m,f),o.subVectors(n,f),a.cross(o),j.fromBufferAttribute(c,p),h.fromBufferAttribute(c,q),i.fromBufferAttribute(c,r),j.add(a),h.add(a),i.add(a),c.setXYZ(p,j.x,j.y,j.z),c.setXYZ(q,h.x,h.y,h.z),c.setXYZ(r,i.x,i.y,i.z);else for(e=0,v=d.count;e<v;e+=3)n.fromBufferAttribute(d,e+0),f.fromBufferAttribute(d,e+1),m.fromBufferAttribute(d,e+2),a.subVectors(m,f),o.subVectors(n,f),a.cross(o),c.setXYZ(e+0,a.x,a.y,a.z),c.setXYZ(e+1,a.x,a.y,a.z),c.setXYZ(e+2,a.x,a.y,a.z);this.normalizeNormals(),c.needsUpdate=!0}},merge:function(a,d){var e,b,f,g,h,i,k,c,j;if(a&&a.isBufferGeometry){void 0===d&&(d=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.")),e=this.attributes;for(b in e)if(void 0!==a.attributes[b])for(f=e[b].array,g=a.attributes[b],h=g.array,i=g.itemSize*d,k=Math.min(h.length,f.length-i),c=0,j=i;c<k;c++,j++)f[j]=h[c];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",a)},normalizeNormals:function(){for(var b=this.attributes.normal,a=0,c=b.count;a<c;a++)B.fromBufferAttribute(b,a),B.normalize(),b.setXYZ(a,B.x,B.y,B.z)},toNonIndexed:function(){var a,j,f,m,q,g,h,n,l,c,p,o,e,d,r,b;function s(b,c){for(var h=b.array,a=b.itemSize,l=b.normalized,f=new h.constructor(c.length*a),g=0,i=0,d=0,j=c.length,e;d<j;d++){g=c[d]*a;for(e=0;e<a;e++)f[i++]=h[g++]}return new k(f,a,l)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;a=new i,j=this.index.array,f=this.attributes;for(m in f)q=s(f[m],j),a.setAttribute(m,q);g=this.morphAttributes;for(h in g){for(n=[],l=g[h],c=0,p=l.length;c<p;c++)o=s(l[c],j),n.push(o);a.morphAttributes[h]=n}a.morphTargetsRelative=this.morphTargetsRelative;for(e=this.groups,d=0,r=e.length;d<r;d++)b=e[d],a.addGroup(b.start,b.count,b.materialIndex);return a},toJSON:function(){var a={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}},b,c,d,o,n,g,m,j,r,k,l,h,f,s,e,p,q,i;if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){b=this.parameters;for(c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}},d=this.index,null!==d&&(a.data.index={type:d.array.constructor.name,array:Array.prototype.slice.call(d.array)}),o=this.attributes;for(n in o)g=o[n],m=g.toJSON(a.data),""!==g.name&&(m.name=g.name),a.data.attributes[n]=m;j={},r=!1;for(k in this.morphAttributes){for(l=this.morphAttributes[k],h=[],f=0,s=l.length;f<s;f++)e=l[f],p=e.toJSON(a.data),""!==e.name&&(p.name=e.name),h.push(p);h.length>0&&(j[k]=h,r=!0)}return r&&(a.data.morphAttributes=j,a.data.morphTargetsRelative=this.morphTargetsRelative),q=this.groups,q.length>0&&(a.data.groups=JSON.parse(JSON.stringify(q))),i=this.boundingSphere,null!==i&&(a.data.boundingSphere={center:i.center.toArray(),radius:i.radius}),a},clone:function(){return(new i).copy(this)},copy:function(a){var b,n,l,k,r,g,h,i,f,e,q,m,c,p,d,j,o;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,b={},this.name=a.name,n=a.index,null!==n&&this.setIndex(n.clone(b)),l=a.attributes;for(k in l)r=l[k],this.setAttribute(k,r.clone(b));g=a.morphAttributes;for(h in g){for(i=[],f=g[h],e=0,q=f.length;e<q;e++)i.push(f[e].clone(b));this.morphAttributes[h]=i}this.morphTargetsRelative=a.morphTargetsRelative;for(m=a.groups,c=0,p=m.length;c<p;c++)d=m[c],this.addGroup(d.start,d.count,d.materialIndex);return j=a.boundingBox,null!==j&&(this.boundingBox=j.clone()),o=a.boundingSphere,null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),hF=new o,bR=new bG,fJ=new aO,aM=new b,aL=new b,aJ=new b,fN=new b,fP=new b,fR=new b,c$=new b,c_=new b,cZ=new b,cY=new c,cX=new c,cW=new c,fV=new b,cT=new b;function t(a,b){void 0===a&&(a=new i),void 0===b&&(b=new W),g.call(this),this.type="Mesh",this.geometry=a,this.material=b,this.updateMorphTargets()}function fl(g,q,r,s,m,l,t,i,j,b,f,e){var n,h,p,a,k,d,o;if(aM.fromBufferAttribute(m,b),aL.fromBufferAttribute(m,f),aJ.fromBufferAttribute(m,e),n=g.morphTargetInfluences,q.morphTargets&&l&&n){c$.set(0,0,0),c_.set(0,0,0),cZ.set(0,0,0);for(h=0,p=l.length;h<p;h++)a=n[h],k=l[h],0!==a&&(fN.fromBufferAttribute(k,b),fP.fromBufferAttribute(k,f),fR.fromBufferAttribute(k,e),t?(c$.addScaledVector(fN,a),c_.addScaledVector(fP,a),cZ.addScaledVector(fR,a)):(c$.addScaledVector(fN.sub(aM),a),c_.addScaledVector(fP.sub(aL),a),cZ.addScaledVector(fR.sub(aJ),a)));aM.add(c$),aL.add(c_),aJ.add(cZ)}return g.isSkinnedMesh&&(g.boneTransform(b,aM),g.boneTransform(f,aL),g.boneTransform(e,aJ)),d=function(d,i,b,e,f,g,h,a){if(null===(1===i.side?e.intersectTriangle(h,g,f,!0,a):e.intersectTriangle(f,g,h,2!==i.side,a)))return null;cT.copy(a),cT.applyMatrix4(d.matrixWorld);var c=b.ray.origin.distanceTo(cT);return c<b.near||c>b.far?null:{distance:c,point:cT.clone(),object:d}}(g,q,r,s,aM,aL,aJ,fV),d&&(i&&(cY.fromBufferAttribute(i,b),cX.fromBufferAttribute(i,f),cW.fromBufferAttribute(i,e),d.uv=ai.getUV(fV,aM,aL,aJ,cY,cX,cW,new c)),j&&(cY.fromBufferAttribute(j,b),cX.fromBufferAttribute(j,f),cW.fromBufferAttribute(j,e),d.uv2=ai.getUV(fV,aM,aL,aJ,cY,cX,cW,new c)),o=new fo(b,f,e),ai.getNormal(aM,aL,aJ,o.normal),d.face=o),d}t.prototype=Object.assign(Object.create(g.prototype),{constructor:t,isMesh:!0,copy:function(a){return g.prototype.copy.call(this,a),void 0!==a.morphTargetInfluences&&(this.morphTargetInfluences=a.morphTargetInfluences.slice()),void 0!==a.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},a.morphTargetDictionary)),this.material=a.material,this.geometry=a.geometry,this},updateMorphTargets:function(){var b=this.geometry,d,e,c,a,g,h,f;if(b.isBufferGeometry){if(d=b.morphAttributes,e=Object.keys(d),e.length>0)if(c=d[e[0]],void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(a=0,g=c.length;a<g;a++)h=c[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=a}}else f=b.morphTargets,void 0!==f&&f.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(k,q){var b,a=this.geometry,e=this.material,v=this.matrixWorld,d,h,r,n,p,s,o,c,u,E,m,x,j,w,I,G,C,i,y,z,A,B,t,D,l,F,g,H,f,J;if(void 0!==e&&(null===a.boundingSphere&&a.computeBoundingSphere(),fJ.copy(a.boundingSphere),fJ.applyMatrix4(v),!1!==k.ray.intersectsSphere(fJ)&&(hF.copy(v).invert(),bR.copy(k.ray).applyMatrix4(hF),null===a.boundingBox||!1!==bR.intersectsBox(a.boundingBox))))if(a.isBufferGeometry){if(d=a.index,h=a.attributes.position,r=a.morphAttributes.position,n=a.morphTargetsRelative,p=a.attributes.uv,s=a.attributes.uv2,o=a.groups,c=a.drawRange,null!==d)if(Array.isArray(e))for(u=0,E=o.length;u<E;u++)for(m=o[u],x=e[m.materialIndex],j=Math.max(m.start,c.start),w=Math.min(m.start+m.count,c.start+c.count);j<w;j+=3)I=d.getX(j),G=d.getX(j+1),C=d.getX(j+2),(b=fl(this,x,k,bR,h,r,n,p,s,I,G,C))&&(b.faceIndex=Math.floor(j/3),b.face.materialIndex=m.materialIndex,q.push(b));else for(i=Math.max(0,c.start),y=Math.min(d.count,c.start+c.count);i<y;i+=3)z=d.getX(i),A=d.getX(i+1),B=d.getX(i+2),(b=fl(this,e,k,bR,h,r,n,p,s,z,A,B))&&(b.faceIndex=Math.floor(i/3),q.push(b));else if(void 0!==h)if(Array.isArray(e))for(t=0,D=o.length;t<D;t++)for(l=o[t],F=e[l.materialIndex],g=Math.max(l.start,c.start),H=Math.min(l.start+l.count,c.start+c.count);g<H;g+=3)(b=fl(this,F,k,bR,h,r,n,p,s,g,g+1,g+2))&&(b.faceIndex=Math.floor(g/3),b.face.materialIndex=l.materialIndex,q.push(b));else for(f=Math.max(0,c.start),J=Math.min(h.count,c.start+c.count);f<J;f+=3)(b=fl(this,e,k,bR,h,r,n,p,s,f,f+1,f+2))&&(b.faceIndex=Math.floor(f/3),q.push(b))}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}),bf=function(a){function c(c,d,e,g,h,i){var j,r,m,o,p,n,l,q;void 0===c&&(c=1),void 0===d&&(d=1),void 0===e&&(e=1),void 0===g&&(g=1),void 0===h&&(h=1),void 0===i&&(i=1),(j=a.call(this)||this).type="BoxGeometry",j.parameters={width:c,height:d,depth:e,widthSegments:g,heightSegments:h,depthSegments:i},r=ap(j),g=Math.floor(g),h=Math.floor(h),i=Math.floor(i),m=[],o=[],p=[],n=[],l=0,q=0;function k(x,v,u,K,I,s,k,w,i,h,H){for(var F=s/i,D=k/h,C=s/2,B=k/2,M=w/2,e=i+1,A=h+1,y=0,j=0,a=new b,f=0,E,g,G,d,c,J,t,L,z;f<A;f++)for(E=f*D-B,g=0;g<e;g++)G=g*F-C,a[x]=G*K,a[v]=E*I,a[u]=M,o.push(a.x,a.y,a.z),a[x]=0,a[v]=0,a[u]=w>0?1:-1,p.push(a.x,a.y,a.z),n.push(g/i),n.push(1-f/h),y+=1;for(d=0;d<h;d++)for(c=0;c<i;c++)J=l+c+e*d,t=l+c+e*(d+1),L=l+(c+1)+e*(d+1),z=l+(c+1)+e*d,m.push(J,t,z),m.push(t,L,z),j+=6;r.addGroup(q,j,H),q+=j,l+=y}return k("z","y","x",-1,-1,e,d,c,i,h,0),k("z","y","x",1,-1,e,d,-c,i,h,1),k("x","z","y",1,1,c,e,d,g,i,2),k("x","z","y",1,-1,c,e,-d,g,i,3),k("x","y","z",1,-1,c,d,e,g,h,4),k("x","y","z",-1,-1,c,d,-e,g,h,5),j.setIndex(m),j.setAttribute("position",new f(o,3)),j.setAttribute("normal",new f(p,3)),j.setAttribute("uv",new f(n,2)),j}return m(c,a),c}(i);function cP(e){var c={},b,d,a;for(b in e)for(d in c[b]={},e[b])a=e[b][d],a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture)?c[b][d]=a.clone():Array.isArray(a)?c[b][d]=a.slice():c[b][d]=a;return c}function K(b){for(var c={},a=0,d,e;a<b.length;a++){d=cP(b[a]);for(e in d)c[e]=d[e]}return c}hH={clone:cP,merge:K};function M(a){j.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==a&&(void 0!==a.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(a))}function az(){g.call(this),this.type="Camera",this.matrixWorldInverse=new o,this.projectionMatrix=new o,this.projectionMatrixInverse=new o}function A(a,b,c,d){void 0===a&&(a=50),void 0===b&&(b=1),void 0===c&&(c=.1),void 0===d&&(d=2e3),az.call(this),this.type="PerspectiveCamera",this.fov=a,this.zoom=1,this.near=c,this.far=d,this.focus=10,this.aspect=b,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}M.prototype=Object.create(j.prototype),M.prototype.constructor=M,M.prototype.isShaderMaterial=!0,M.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.fragmentShader=a.fragmentShader,this.vertexShader=a.vertexShader,this.uniforms=cP(a.uniforms),this.defines=Object.assign({},a.defines),this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.lights=a.lights,this.clipping=a.clipping,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.extensions=Object.assign({},a.extensions),this.glslVersion=a.glslVersion,this},M.prototype.toJSON=function(e){var b=j.prototype.toJSON.call(this,e),c,a,d,f;for(c in b.glslVersion=this.glslVersion,b.uniforms={},this.uniforms)a=this.uniforms[c].value,a&&a.isTexture?b.uniforms[c]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?b.uniforms[c]={type:"c",value:a.getHex()}:a&&a.isVector2?b.uniforms[c]={type:"v2",value:a.toArray()}:a&&a.isVector3?b.uniforms[c]={type:"v3",value:a.toArray()}:a&&a.isVector4?b.uniforms[c]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?b.uniforms[c]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?b.uniforms[c]={type:"m4",value:a.toArray()}:b.uniforms[c]={value:a};Object.keys(this.defines).length>0&&(b.defines=this.defines),b.vertexShader=this.vertexShader,b.fragmentShader=this.fragmentShader,d={};for(f in this.extensions)!0===this.extensions[f]&&(d[f]=!0);return Object.keys(d).length>0&&(b.extensions=d),b},az.prototype=Object.assign(Object.create(g.prototype),{constructor:az,isCamera:!0,copy:function(a,b){return g.prototype.copy.call(this,a,b),this.matrixWorldInverse.copy(a.matrixWorldInverse),this.projectionMatrix.copy(a.projectionMatrix),this.projectionMatrixInverse.copy(a.projectionMatrixInverse),this},getWorldDirection:function(a){void 0===a&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),a=new b),this.updateWorldMatrix(!0,!1);var c=this.matrixWorld.elements;return a.set(-c[8],-c[9],-c[10]).normalize()},updateMatrixWorld:function(a){g.prototype.updateMatrixWorld.call(this,a),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(a,b){g.prototype.updateWorldMatrix.call(this,a,b),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),A.prototype=Object.assign(Object.create(az.prototype),{constructor:A,isPerspectiveCamera:!0,copy:function(a,b){return az.prototype.copy.call(this,a,b),this.fov=a.fov,this.zoom=a.zoom,this.near=a.near,this.far=a.far,this.focus=a.focus,this.aspect=a.aspect,this.view=null===a.view?null:Object.assign({},a.view),this.filmGauge=a.filmGauge,this.filmOffset=a.filmOffset,this},setFocalLength:function(a){var b=.5*this.getFilmHeight()/a;this.fov=2*l.RAD2DEG*Math.atan(b),this.updateProjectionMatrix()},getFocalLength:function(){var a=Math.tan(.5*l.DEG2RAD*this.fov);return.5*this.getFilmHeight()/a},getEffectiveFOV:function(){return 2*l.RAD2DEG*Math.atan(Math.tan(.5*l.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(a,b,c,d,e,f){this.aspect=a/b,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var f=this.near,b=f*Math.tan(.5*l.DEG2RAD*this.fov)/this.zoom,c=2*b,d=this.aspect*c,e=-.5*d,a=this.view,g,h,i;null!==this.view&&this.view.enabled&&(g=a.fullWidth,h=a.fullHeight,e+=a.offsetX*d/g,b-=a.offsetY*c/h,d*=a.width/g,c*=a.height/h),i=this.filmOffset,0!==i&&(e+=f*i/this.getFilmWidth()),this.projectionMatrix.makePerspective(e,e+d,b,b-c,f,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(b){var a=g.prototype.toJSON.call(this,b);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,null!==this.view&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}}),bB=90;function bD(c,d,a){var e,f,h,i,j,k;g.call(this),this.type="CubeCamera",!0===a.isWebGLCubeRenderTarget?(this.renderTarget=a,e=new A(bB,1,c,d),e.layers=this.layers,e.up.set(0,-1,0),e.lookAt(new b(1,0,0)),this.add(e),f=new A(bB,1,c,d),f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new b(-1,0,0)),this.add(f),h=new A(bB,1,c,d),h.layers=this.layers,h.up.set(0,0,1),h.lookAt(new b(0,1,0)),this.add(h),i=new A(bB,1,c,d),i.layers=this.layers,i.up.set(0,0,-1),i.lookAt(new b(0,-1,0)),this.add(i),j=new A(bB,1,c,d),j.layers=this.layers,j.up.set(0,-1,0),j.lookAt(new b(0,0,1)),this.add(j),k=new A(bB,1,c,d),k.layers=this.layers,k.up.set(0,-1,0),k.lookAt(new b(0,0,-1)),this.add(k),this.update=function(b,c){var d,g,l;null===this.parent&&this.updateMatrixWorld(),d=b.xr.enabled,g=b.getRenderTarget(),b.xr.enabled=!1,l=a.texture.generateMipmaps,a.texture.generateMipmaps=!1,b.setRenderTarget(a,0),b.render(c,e),b.setRenderTarget(a,1),b.render(c,f),b.setRenderTarget(a,2),b.render(c,h),b.setRenderTarget(a,3),b.render(c,i),b.setRenderTarget(a,4),b.render(c,j),a.texture.generateMipmaps=l,b.setRenderTarget(a,5),b.render(c,k),b.setRenderTarget(g),b.xr.enabled=d}):console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.")}function aE(a,b,d,e,f,g,c,h,i,j){a=void 0!==a?a:[],b=void 0!==b?b:cN,c=void 0!==c?c:aK,r.call(this,a,b,d,e,f,g,c,h,i,j),this.flipY=!1,this._needsFlipEnvMap=!0}bD.prototype=Object.create(g.prototype),bD.prototype.constructor=bD,aE.prototype=Object.create(r.prototype),aE.prototype.constructor=aE,aE.prototype.isCubeTexture=!0,Object.defineProperty(aE.prototype,"images",{get:function(){return this.image},set:function(a){this.image=a}}),fS=function(b){function a(d,a,e){var c;return Number.isInteger(a)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),a=e),c=b.call(this,d,d,a)||this,Object.defineProperty(ap(c),"isWebGLCubeRenderTarget",{value:!0}),a=a||{},c.texture=new aE(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),c.texture._needsFlipEnvMap=!1,c}m(a,b);var c=a.prototype;return c.fromEquirectangularTexture=function(i,a){var d,e,f,g,c,b,h;return this.texture.type=a.type,this.texture.format=Y,this.texture.encoding=a.encoding,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter,d={tEquirect:{value:null}},e="\n\n				varying vec3 vWorldDirection;\n\n				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n				}\n\n				void main() {\n\n					vWorldDirection = transformDirection( position, modelMatrix );\n\n					#include <begin_vertex>\n					#include <project_vertex>\n\n				}\n			",f="\n\n				uniform sampler2D tEquirect;\n\n				varying vec3 vWorldDirection;\n\n				#include <common>\n\n				void main() {\n\n					vec3 direction = normalize( vWorldDirection );\n\n					vec2 sampleUV = equirectUv( direction );\n\n					gl_FragColor = texture2D( tEquirect, sampleUV );\n\n				}\n			",g=new bf(5,5,5),c=new M({name:"CubemapFromEquirect",uniforms:cP(d),vertexShader:e,fragmentShader:f,side:1,blending:0}),c.uniforms.tEquirect.value=a,b=new t(g,c),h=a.minFilter,a.minFilter===cx&&(a.minFilter=D),new bD(1,10,this).update(i,b),a.minFilter=h,b.geometry.dispose(),b.material.dispose(),this},c.clear=function(a,c,d,e){for(var f=a.getRenderTarget(),b=0;b<6;b++)a.setRenderTarget(this,b),a.clear(c,d,e);a.setRenderTarget(f)},a}(aI);function aW(c,d,i,j,e,f,g,h,a,b,k,l){r.call(this,null,f,g,h,a,b,j,e,k,l),this.image={data:c||null,width:d||1,height:i||1},this.magFilter=void 0!==a?a:C,this.minFilter=void 0!==b?b:C,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}aW.prototype=Object.create(r.prototype),aW.prototype.constructor=aW,aW.prototype.isDataTexture=!0,bQ=new aO,dd=new b,cF=function(){function b(a,b,c,d,e,f){this.planes=[void 0!==a?a:new am,void 0!==b?b:new am,void 0!==c?c:new am,void 0!==d?d:new am,void 0!==e?e:new am,void 0!==f?f:new am]}var a=b.prototype;return a.set=function(g,b,c,d,e,f){var a=this.planes;return a[0].copy(g),a[1].copy(b),a[2].copy(c),a[3].copy(d),a[4].copy(e),a[5].copy(f),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(b){for(var c=this.planes,a=0;a<6;a++)c[a].copy(b.planes[a]);return this},a.setFromProjectionMatrix=function(s){var c=this.planes,a=s.elements,o=a[0],k=a[1],j=a[2],b=a[3],h=a[4],i=a[5],g=a[6],e=a[7],l=a[8],m=a[9],n=a[10],d=a[11],p=a[12],q=a[13],r=a[14],f=a[15];return c[0].setComponents(b-o,e-h,d-l,f-p).normalize(),c[1].setComponents(b+o,e+h,d+l,f+p).normalize(),c[2].setComponents(b+k,e+i,d+m,f+q).normalize(),c[3].setComponents(b-k,e-i,d-m,f-q).normalize(),c[4].setComponents(b-j,e-g,d-n,f-r).normalize(),c[5].setComponents(b+j,e+g,d+n,f+r).normalize(),this},a.intersectsObject=function(b){var a=b.geometry;return null===a.boundingSphere&&a.computeBoundingSphere(),bQ.copy(a.boundingSphere).applyMatrix4(b.matrixWorld),this.intersectsSphere(bQ)},a.intersectsSprite=function(a){return bQ.center.set(0,0,0),bQ.radius=.7071067811865476,bQ.applyMatrix4(a.matrixWorld),this.intersectsSphere(bQ)},a.intersectsSphere=function(b){for(var c=this.planes,d=b.center,e=-b.radius,a=0;a<6;a++)if(c[a].distanceToPoint(d)<e)return!1;return!0},a.intersectsBox=function(a){for(var d=this.planes,c=0,b;c<6;c++)if(b=d[c],dd.x=b.normal.x>0?a.max.x:a.min.x,dd.y=b.normal.y>0?a.max.y:a.min.y,dd.z=b.normal.z>0?a.max.z:a.min.z,b.distanceToPoint(dd)<0)return!1;return!0},a.containsPoint=function(b){for(var c=this.planes,a=0;a<6;a++)if(c[a].distanceToPoint(b)<0)return!1;return!0},b}();function is(){var a=null,b=!1,c=null,d=null;function e(b,f){c(b,f),d=a.requestAnimationFrame(e)}return{start:function(){!0!==b&&null!==c&&(d=a.requestAnimationFrame(e),b=!0)},stop:function(){a.cancelAnimationFrame(d),b=!1},setAnimationLoop:function(a){c=a},setContext:function(b){a=b}}}function kk(a,d){var c=d.isWebGL2,b=new WeakMap;return{get:function(a){return a.isInterleavedBufferAttribute&&(a=a.data),b.get(a)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);var d=b.get(c);d&&(a.deleteBuffer(d.buffer),b.delete(c))},update:function(d,g){var f,e;d.isGLBufferAttribute?(f=b.get(d),(!f||f.version<d.version)&&b.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version})):(d.isInterleavedBufferAttribute&&(d=d.data),e=b.get(d),void 0===e?b.set(d,function(e,f){var b=e.array,h=e.usage,g=a.createBuffer(),d;return a.bindBuffer(f,g),a.bufferData(f,b,h),e.onUploadCallback(),d=5126,b instanceof Float32Array?d=5126:b instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):b instanceof Uint16Array?e.isFloat16BufferAttribute?c?d=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):d=5123:b instanceof Int16Array?d=5122:b instanceof Uint32Array?d=5125:b instanceof Int32Array?d=5124:b instanceof Int8Array?d=5120:b instanceof Uint8Array&&(d=5121),{buffer:g,type:d,bytesPerElement:b.BYTES_PER_ELEMENT,version:e.version}}(d,g)):e.version<d.version&&(!function(g,f,e){var d=f.array,b=f.updateRange;a.bindBuffer(e,g),-1===b.count?a.bufferSubData(e,0,d):(c?a.bufferSubData(e,b.offset*d.BYTES_PER_ELEMENT,d,b.offset,b.count):a.bufferSubData(e,b.offset*d.BYTES_PER_ELEMENT,d.subarray(b.offset,b.offset+b.count)),b.count=-1)}(e.buffer,d,g),e.version=d.version))}}}cB=function(a){function b(h,e,l,i){var b,y,x,j,k,g,v,w,A,p,q,r,o,n,u,m,C,d,c,z,s,B,t;void 0===h&&(h=1),void 0===e&&(e=1),void 0===l&&(l=1),void 0===i&&(i=1),(b=a.call(this)||this).type="PlaneGeometry",b.parameters={width:h,height:e,widthSegments:l,heightSegments:i};for(y=h/2,x=e/2,j=Math.floor(l),k=Math.floor(i),g=j+1,v=k+1,w=h/j,A=e/k,p=[],q=[],r=[],o=[],n=0;n<v;n++)for(u=n*A-x,m=0;m<g;m++)C=m*w-y,q.push(C,-u,0),r.push(0,0,1),o.push(m/j),o.push(1-n/k);for(d=0;d<k;d++)for(c=0;c<j;c++)z=c+g*d,s=c+g*(d+1),B=c+1+g*(d+1),t=c+1+g*d,p.push(z,s,t),p.push(s,B,t);return b.setIndex(p),b.setAttribute("position",new f(q,3)),b.setAttribute("normal",new f(r,3)),b.setAttribute("uv",new f(o,2)),b}return m(b,a),b}(i),n={alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n	if ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	return vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n	if( cutoffDistance > 0.0 ) {\n		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n	}\n	return distanceFalloff;\n#else\n	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n	}\n	return 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n	return ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n	return Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	return 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( incidentLight.direction + viewDir );\n	float dotNL = saturate( dot( normal, incidentLight.direction ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n	float D = D_GGX( alpha, dotNH );\n	return F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	return specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n	vec3 FssEss = F * brdf.x + brdf.y;\n	float Ess = brdf.x + brdf.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n	float dotNH = saturate( dot( geometry.normal, halfDir ) );\n	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n	vec3 F = F_Schlick( specularColor, dotLH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n	float invAlpha = 1.0 / roughness;\n	float cos2h = NoH * NoH;\n	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n	vec3 N = geometry.normal;\n	vec3 V = geometry.viewDir;\n	vec3 H = normalize( V + L );\n	float dotNH = saturate( dot( N, H ) );\n	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vUv );\n		vec2 dSTdy = dFdy( vUv );\n		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 );\n		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n		plane = clippingPlanes[ i ];\n		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n	}\n	#pragma unroll_loop_end\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		#pragma unroll_loop_start\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		#pragma unroll_loop_end\n		if ( clipped ) discard;\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n#ifdef CLEARCOAT\n	vec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	float distance = dot( planeNormal, point - pointOnPlane );\n	return - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n	return dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_maxMipLevel 8.0\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_maxTileSize 256.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n		vec2 f = fract( uv );\n		uv += 0.5 - f;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		if ( mipInt < cubeUV_maxMipLevel ) {\n			uv.y += 2.0 * cubeUV_maxTileSize;\n		}\n		uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n		uv *= texelSize;\n		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x += texelSize;\n		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.y += texelSize;\n		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		uv.x -= texelSize;\n		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n		vec3 tm = mix( tl, tr, f.x );\n		vec3 bm = mix( bl, br, f.x );\n		return mix( tm, bm, f.y );\n	}\n	#define r0 1.0\n	#define v0 0.339\n	#define m0 - 2.0\n	#define r1 0.8\n	#define v1 0.276\n	#define m1 - 1.0\n	#define r4 0.4\n	#define v4 0.046\n	#define m4 2.0\n	#define r5 0.305\n	#define v5 0.016\n	#define m5 3.0\n	#define r6 0.21\n	#define v6 0.0038\n	#define m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= r1 ) {\n			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n		} else if ( roughness >= r4 ) {\n			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n		} else if ( roughness >= r5 ) {\n			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n		} else if ( roughness >= r6 ) {\n			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vUv );\n	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n	return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n	float maxComponent = max( max( value.r, value.g ), value.b );\n	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n	M = ceil( M * 255.0 ) / 255.0;\n	return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n	float maxRGB = max( value.r, max( value.g, value.b ) );\n	float D = max( maxRange / maxRGB, 1.0 );\n	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n	vec4 vResult;\n	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n	vResult.w = fract( Le );\n	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n	return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n	float Le = value.z * 255.0 + value.w;\n	vec3 Xp_Y_XYZp;\n	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n	return vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifndef ENVMAP_TYPE_CUBE_UV\n		envColor = envMapTexelToLinear( envColor );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	uniform int maxMipLevel;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n	#ifdef ENVMAP_MODE_REFRACTION\n		uniform float refractionRatio;\n	#endif\n	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n		#else\n			vec4 envMapColor = vec4( 0.0 );\n		#endif\n		return PI * envMapColor.rgb * envMapIntensity;\n	}\n	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n		float maxMIPLevelScalar = float( maxMIPLevel );\n		float sigma = PI * roughness * roughness / ( 1.0 + roughness );\n		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n	}\n	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( -viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n		#else\n			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n		#endif\n		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n		#ifdef ENVMAP_TYPE_CUBE\n			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n			#ifdef TEXTURE_LOD_EXT\n				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n			#else\n				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n			#endif\n			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n		#elif defined( ENVMAP_TYPE_CUBE_UV )\n			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n		#endif\n		return envMapColor.rgb * envMapIntensity;\n	}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	fogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float fogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return texture2D( gradientMap, coord ).rgb;\n	#else\n		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n	#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n	vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n	vLightBack = vec3( 0.0 );\n	vIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n		dotNL = dot( geometry.normal, directLight.direction );\n		directLightColor_Diffuse = PI * directLight.color;\n		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n		#ifdef DOUBLE_SIDED\n			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		#ifdef DOUBLE_SIDED\n			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n		#endif\n	}\n	#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	return irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		directLight.color = directionalLight.color;\n		directLight.direction = directionalLight.direction;\n		directLight.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		directLight.color = pointLight.color;\n		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n		directLight.visible = ( directLight.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		directLight.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		float angleCos = dot( directLight.direction, spotLight.direction );\n		if ( angleCos > spotLight.coneCos ) {\n			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n			directLight.color = spotLight.color;\n			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n			directLight.visible = true;\n		} else {\n			directLight.color = vec3( 0.0 );\n			directLight.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n		float dotNL = dot( geometry.normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			irradiance *= PI;\n		#endif\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )	(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )	(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float specularRoughness;\n	vec3 specularColor;\n#ifdef CLEARCOAT\n	float clearcoat;\n	float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	vec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometry.normal;\n		vec3 viewDir = geometry.viewDir;\n		vec3 position = geometry.position;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.specularRoughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(		0, 1,		0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifndef PHYSICALLY_CORRECT_LIGHTS\n		irradiance *= PI;\n	#endif\n	#ifdef CLEARCOAT\n		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = ccDotNL * directLight.color;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			ccIrradiance *= PI;\n		#endif\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	#ifdef USE_SHEEN\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n			material.specularRoughness,\n			directLight.direction,\n			geometry,\n			material.sheenColor\n		);\n	#else\n		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n	#endif\n	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef CLEARCOAT\n		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n		float ccDotNL = ccDotNV;\n		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n	#else\n		float clearcoatDHR = 0.0;\n	#endif\n	float clearcoatInv = 1.0 - clearcoatDHR;\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n	geometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointDirectLightIrradiance( pointLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotDirectLightIrradiance( spotLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	irradiance += getLightProbeIrradiance( lightProbe, geometry );\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n		#ifndef PHYSICALLY_CORRECT_LIGHTS\n			lightMapIrradiance *= PI;\n		#endif\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n	#ifdef CLEARCOAT\n		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n		varying float vIsPerspective;\n	#else\n		uniform float logDepthBufFC;\n	#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n	#else\n		if ( isPerspectiveMatrix( projectionMatrix ) ) {\n			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n			gl_Position.z *= gl_Position.w;\n		}\n	#endif\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 texelColor = texture2D( map, vUv );\n	texelColor = mapTexelToLinear( texelColor );\n	diffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n	vec4 mapTexel = texture2D( map, uv );\n	diffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	uniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	uniform float morphTargetBaseInfluence;\n	#ifndef USE_MORPHNORMALS\n		uniform float morphTargetInfluences[ 8 ];\n	#else\n		uniform float morphTargetInfluences[ 4 ];\n	#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	transformed += morphTarget0 * morphTargetInfluences[ 0 ];\n	transformed += morphTarget1 * morphTargetInfluences[ 1 ];\n	transformed += morphTarget2 * morphTargetInfluences[ 2 ];\n	transformed += morphTarget3 * morphTargetInfluences[ 3 ];\n	#ifndef USE_MORPHNORMALS\n		transformed += morphTarget4 * morphTargetInfluences[ 4 ];\n		transformed += morphTarget5 * morphTargetInfluences[ 5 ];\n		transformed += morphTarget6 * morphTargetInfluences[ 6 ];\n		transformed += morphTarget7 * morphTargetInfluences[ 7 ];\n	#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#endif\n	#ifdef USE_TANGENT\n		vec3 tangent = normalize( vTangent );\n		vec3 bitangent = normalize( vBitangent );\n		#ifdef DOUBLE_SIDED\n			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		#endif\n		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n			mat3 vTBN = mat3( tangent, bitangent, normal );\n		#endif\n	#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	#ifdef USE_TANGENT\n		normal = normalize( vTBN * mapN );\n	#else\n		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n	#endif\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n		vec2 st0 = dFdx( vUv.st );\n		vec2 st1 = dFdy( vUv.st );\n		float scale = sign( st1.t * st0.s - st0.t * st1.s );\n		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n		vec3 N = normalize( surf_norm );\n		mat3 tsn = mat3( S, T, N );\n		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n		return normalize( tsn * mapN );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n	vec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	#ifdef USE_TANGENT\n		clearcoatNormal = normalize( vTBN * clearcoatMapN );\n	#else\n		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n	#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n	return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n		bool inFrustum = all( inFrustumVec );\n		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n		bool frustumTest = all( frustumTestVec );\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n							f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n							f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return shadow;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;\n		vec3 bd3D = normalize( lightToPosition );\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		vec4 shadowWorldPosition;\n	#endif\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n	#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	#ifdef BONE_TEXTURE\n		uniform highp sampler2D boneTexture;\n		uniform int boneTextureSize;\n		mat4 getBoneMatrix( const in float i ) {\n			float j = i * 4.0;\n			float x = mod( j, float( boneTextureSize ) );\n			float y = floor( j / float( boneTextureSize ) );\n			float dx = 1.0 / float( boneTextureSize );\n			float dy = 1.0 / float( boneTextureSize );\n			y = dy * ( y + 0.5 );\n			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n			mat4 bone = mat4( v1, v2, v3, v4 );\n			return bone;\n		}\n	#else\n		uniform mat4 boneMatrices[ MAX_BONES ];\n		mat4 getBoneMatrix( const in float i ) {\n			mat4 bone = boneMatrices[ int(i) ];\n			return bone;\n		}\n	#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,	1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n	totalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n	uniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n	varying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n	#ifdef UVS_VERTEX_ONLY\n		vec2 vUv;\n	#else\n		varying vec2 vUv;\n	#endif\n	uniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	varying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	attribute vec2 uv2;\n	varying vec2 vUv2;\n	uniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	vec3 vReflect = vWorldDirection;\n	#include <envmap_fragment>\n	gl_FragColor = envColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	vec4 texColor = texture2D( tEquirect, sampleUV );\n	gl_FragColor = mapTexelToLinear( texColor );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n	\n		vec4 lightMapTexel= texture2D( lightMap, vUv2 );\n		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_ENVMAP\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <emissivemap_fragment>\n	#ifdef DOUBLE_SIDED\n		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n	#else\n		reflectedLight.indirectDiffuse += vIndirectFront;\n	#endif\n	#include <lightmap_fragment>\n	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n	#ifdef DOUBLE_SIDED\n		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n	#else\n		reflectedLight.directDiffuse = vLightFront;\n	#endif\n	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n	varying vec3 vLightBack;\n	varying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <lights_lambert_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n		matcapColor = matcapTexelToLinear( matcapColor );\n	#else\n		vec4 matcapColor = vec4( 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#ifndef FLAT_SHADED\n		vNormal = normalize( transformedNormal );\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define REFLECTIVITY\n	#define CLEARCOAT\n	#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n	uniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n	uniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#ifdef TRANSMISSION\n		float totalTransmission = transmission;\n	#endif\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <transmissionmap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#ifdef TRANSMISSION\n		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n	#endif\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <uv2_vertex>\n	#include <color_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	varying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <color_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <begin_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	outgoingLight = diffuseColor.rgb;\n	gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n	#include <tonemapping_fragment>\n	#include <encodings_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}"},d={common:{diffuse:{value:new e(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Q},uv2Transform:{value:new Q},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new c(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new e(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new e(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Q}},sprite:{diffuse:{value:new e(15658734)},opacity:{value:1},center:{value:new c(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Q}}},Z={basic:{uniforms:K([d.common,d.specularmap,d.envmap,d.aomap,d.lightmap,d.fog]),vertexShader:n.meshbasic_vert,fragmentShader:n.meshbasic_frag},lambert:{uniforms:K([d.common,d.specularmap,d.envmap,d.aomap,d.lightmap,d.emissivemap,d.fog,d.lights,{emissive:{value:new e(0)}}]),vertexShader:n.meshlambert_vert,fragmentShader:n.meshlambert_frag},phong:{uniforms:K([d.common,d.specularmap,d.envmap,d.aomap,d.lightmap,d.emissivemap,d.bumpmap,d.normalmap,d.displacementmap,d.fog,d.lights,{emissive:{value:new e(0)},specular:{value:new e(1118481)},shininess:{value:30}}]),vertexShader:n.meshphong_vert,fragmentShader:n.meshphong_frag},standard:{uniforms:K([d.common,d.envmap,d.aomap,d.lightmap,d.emissivemap,d.bumpmap,d.normalmap,d.displacementmap,d.roughnessmap,d.metalnessmap,d.fog,d.lights,{emissive:{value:new e(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:n.meshphysical_vert,fragmentShader:n.meshphysical_frag},toon:{uniforms:K([d.common,d.aomap,d.lightmap,d.emissivemap,d.bumpmap,d.normalmap,d.displacementmap,d.gradientmap,d.fog,d.lights,{emissive:{value:new e(0)}}]),vertexShader:n.meshtoon_vert,fragmentShader:n.meshtoon_frag},matcap:{uniforms:K([d.common,d.bumpmap,d.normalmap,d.displacementmap,d.fog,{matcap:{value:null}}]),vertexShader:n.meshmatcap_vert,fragmentShader:n.meshmatcap_frag},points:{uniforms:K([d.points,d.fog]),vertexShader:n.points_vert,fragmentShader:n.points_frag},dashed:{uniforms:K([d.common,d.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:n.linedashed_vert,fragmentShader:n.linedashed_frag},depth:{uniforms:K([d.common,d.displacementmap]),vertexShader:n.depth_vert,fragmentShader:n.depth_frag},normal:{uniforms:K([d.common,d.bumpmap,d.normalmap,d.displacementmap,{opacity:{value:1}}]),vertexShader:n.normal_vert,fragmentShader:n.normal_frag},sprite:{uniforms:K([d.sprite,d.fog]),vertexShader:n.sprite_vert,fragmentShader:n.sprite_frag},background:{uniforms:{uvTransform:{value:new Q},t2D:{value:null}},vertexShader:n.background_vert,fragmentShader:n.background_frag},cube:{uniforms:K([d.envmap,{opacity:{value:1}}]),vertexShader:n.cube_vert,fragmentShader:n.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:n.equirect_vert,fragmentShader:n.equirect_frag},distanceRGBA:{uniforms:K([d.common,d.displacementmap,{referencePosition:{value:new b},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:n.distanceRGBA_vert,fragmentShader:n.distanceRGBA_frag},shadow:{uniforms:K([d.lights,d.fog,{color:{value:new e(0)},opacity:{value:1}}]),vertexShader:n.shadow_vert,fragmentShader:n.shadow_frag}};function kp(c,n,m,k,l){var b,a,d=new e(0),j=0,f=null,g=0,h=null;function i(a,b){m.buffers.color.setClear(a.r,a.g,a.b,b,l)}return{getClearColor:function(){return d},setClearColor:function(b,a){void 0===a&&(a=1),d.set(b),i(d,j=a)},getClearAlpha:function(){return j},setClearAlpha:function(a){i(d,j=a)},render:function(l,m,r,o){var e=!0===m.isScene?m.background:null,p,q;e&&e.isTexture&&(e=n.get(e)),p=c.xr,q=p.getSession&&p.getSession(),q&&"additive"===q.environmentBlendMode&&(e=null),null===e?i(d,j):e&&e.isColor&&(i(e,1),o=!0),(c.autoClear||o)&&c.clear(c.autoClearColor,c.autoClearDepth,c.autoClearStencil),e&&(e.isCubeTexture||e.isWebGLCubeRenderTarget||e.mapping===bK)?(void 0===a&&((a=new t(new bf(1,1,1),new M({name:"BackgroundCubeMaterial",uniforms:cP(Z.cube.uniforms),vertexShader:Z.cube.vertexShader,fragmentShader:Z.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(b,c,a){this.matrixWorld.copyPosition(a.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),k.update(a)),e.isWebGLCubeRenderTarget&&(e=e.texture),a.material.uniforms.envMap.value=e,a.material.uniforms.flipEnvMap.value=e.isCubeTexture&&e._needsFlipEnvMap?-1:1,f===e&&g===e.version&&h===c.toneMapping||(a.material.needsUpdate=!0,f=e,g=e.version,h=c.toneMapping),l.unshift(a,a.geometry,a.material,0,0,null)):e&&e.isTexture&&(void 0===b&&((b=new t(new cB(2,2),new M({name:"BackgroundMaterial",uniforms:cP(Z.background.uniforms),vertexShader:Z.background.vertexShader,fragmentShader:Z.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(b.material,"map",{get:function(){return this.uniforms.t2D.value}}),k.update(b)),b.material.uniforms.t2D.value=e,!0===e.matrixAutoUpdate&&e.updateMatrix(),b.material.uniforms.uvTransform.value.copy(e.matrix),f===e&&g===e.version&&h===c.toneMapping||(b.material.needsUpdate=!0,f=e,g=e.version,h=c.toneMapping),l.unshift(b,b.geometry,b.material,0,0,null))}}}function kq(a,k,g,d){var t=a.getParameter(34921),h=d.isWebGL2?null:k.get("OES_vertex_array_object"),s=d.isWebGL2||null!==h,c={},f=m(null),b=f;function l(b){return d.isWebGL2?a.bindVertexArray(b):h.bindVertexArrayOES(b)}function i(b){return d.isWebGL2?a.deleteVertexArray(b):h.deleteVertexArrayOES(b)}function m(e){for(var b=[],c=[],d=[],a=0;a<t;a++)b[a]=0,c[a]=0,d[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:b,enabledAttributes:c,attributeDivisors:d,object:e,attributes:{},index:null}}function n(){for(var c=b.newAttributes,a=0,d=c.length;a<d;a++)c[a]=0}function j(a){e(a,0)}function e(c,e){var h=b.newAttributes,f=b.enabledAttributes,g=b.attributeDivisors;h[c]=1,0===f[c]&&(a.enableVertexAttribArray(c),f[c]=1),g[c]!==e&&((d.isWebGL2?a:k.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](c,e),g[c]=e)}function q(){for(var e=b.newAttributes,d=b.enabledAttributes,c=0,f=d.length;c<f;c++)d[c]!==e[c]&&(a.disableVertexAttribArray(c),d[c]=0)}function o(c,e,b,h,f,g){!0!==d.isWebGL2||5124!==b&&5125!==b?a.vertexAttribPointer(c,e,b,h,f,g):a.vertexAttribIPointer(c,e,b,f,g)}function p(){r(),b!==f&&l((b=f).object)}function r(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:function(u,t,p,f,i){var r=!1,v,w;s?(v=function(j,g,k){var i=!0===k.wireframe,b=c[j.id],e,f;return void 0===b&&(b={},c[j.id]=b),e=b[g.id],void 0===e&&(e={},b[g.id]=e),f=e[i],void 0===f&&(f=m(d.isWebGL2?a.createVertexArray():h.createVertexArrayOES()),e[i]=f),f}(f,p,t),b!==v&&l((b=v).object),(r=function(h,i){var g=b.attributes,d=h.attributes,e=0,f,a,c;for(f in d){if(a=g[f],c=d[f],void 0===a)return!0;if(a.attribute!==c)return!0;if(a.data!==c.data)return!0;e++}return b.attributesNum!==e||b.index!==i}(f,i))&&function(h,i){var d={},e=h.attributes,f=0,g,a,c;for(g in e)a=e[g],c={},c.attribute=a,a.data&&(c.data=a.data),d[g]=c,f++;b.attributes=d,b.attributesNum=f,b.index=i}(f,i)):(w=!0===t.wireframe,b.geometry===f.id&&b.program===p.id&&b.wireframe===w||(b.geometry=f.id,b.program=p.id,b.wireframe=w,r=!0)),!0===u.isInstancedMesh&&(r=!0),null!==i&&g.update(i,34963),r&&(!function(A,I,H,l){var G,t,w,i,b,c,u,v,m,z,x,y,h,B,C,r,D,p,s,E,F,f;if(!1===d.isWebGL2&&(A.isInstancedMesh||l.isInstancedBufferGeometry)&&null===k.get("ANGLE_instanced_arrays"))return;n(),G=l.attributes,t=H.getAttributes(),w=I.defaultAttributeValues;for(i in t)if(b=t[i],b>=0)if(c=G[i],void 0!==c){if(u=c.normalized,v=c.itemSize,m=g.get(c),void 0===m)continue;z=m.buffer,x=m.type,y=m.bytesPerElement,c.isInterleavedBufferAttribute?(h=c.data,B=h.stride,C=c.offset,h&&h.isInstancedInterleavedBuffer?(e(b,h.meshPerAttribute),void 0===l._maxInstanceCount&&(l._maxInstanceCount=h.meshPerAttribute*h.count)):j(b),a.bindBuffer(34962,z),o(b,v,x,u,B*y,C*y)):(c.isInstancedBufferAttribute?(e(b,c.meshPerAttribute),void 0===l._maxInstanceCount&&(l._maxInstanceCount=c.meshPerAttribute*c.count)):j(b),a.bindBuffer(34962,z),o(b,v,x,u,0,0))}else if("instanceMatrix"===i){if(r=g.get(A.instanceMatrix),void 0===r)continue;D=r.buffer,p=r.type,e(b+0,1),e(b+1,1),e(b+2,1),e(b+3,1),a.bindBuffer(34962,D),a.vertexAttribPointer(b+0,4,p,!1,64,0),a.vertexAttribPointer(b+1,4,p,!1,64,16),a.vertexAttribPointer(b+2,4,p,!1,64,32),a.vertexAttribPointer(b+3,4,p,!1,64,48)}else if("instanceColor"===i){if(s=g.get(A.instanceColor),void 0===s)continue;E=s.buffer,F=s.type,e(b,1),a.bindBuffer(34962,E),a.vertexAttribPointer(b,3,F,!1,12,0)}else if(void 0!==w)if(f=w[i],void 0!==f)switch(f.length){case 2:a.vertexAttrib2fv(b,f);break;case 3:a.vertexAttrib3fv(b,f);break;case 4:a.vertexAttrib4fv(b,f);break;default:a.vertexAttrib1fv(b,f)}q()}(u,t,p,f),null!==i&&a.bindBuffer(34963,g.get(i).buffer))},reset:p,resetDefaultState:r,dispose:function(){var d,a,e,b,f;for(d in p(),c){a=c[d];for(e in a){b=a[e];for(f in b)i(b[f].object),delete b[f];delete a[e]}delete c[d]}},releaseStatesOfGeometry:function(d){var a,e,b,f;if(void 0!==c[d.id]){a=c[d.id];for(e in a){b=a[e];for(f in b)i(b[f].object),delete b[f];delete a[e]}delete c[d.id]}},releaseStatesOfProgram:function(d){var f,a,b,e;for(f in c)if(a=c[f],void 0!==a[d.id]){b=a[d.id];for(e in b)i(b[e].object),delete b[e];delete a[d.id]}},initAttributes:n,enableAttribute:j,disableUnusedAttributes:q}}function kv(b,d,c,e){var a,f=e.isWebGL2;this.setMode=function(b){a=b},this.render=function(e,d){b.drawArrays(a,e,d),c.update(d,a,1)},this.renderInstances=function(j,i,e){if(0!==e){var g,h;if(f)g=b,h="drawArraysInstanced";else if(h="drawArraysInstancedANGLE",null===(g=d.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");g[h](a,j,i,e),c.update(i,a,e)}}}function kx(a,i,d){var f,e,b,c,r,s,h,l,m,n,o,p,q,j,k;function g(b){if("highp"===b){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";b="mediump"}return"mediump"===b&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}return e="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&a instanceof WebGL2ComputeRenderingContext,b=void 0!==d.precision?d.precision:"highp",c=g(b),c!==b&&(console.warn("THREE.WebGLRenderer:",b,"not supported, using",c,"instead."),b=c),r=!0===d.logarithmicDepthBuffer,s=a.getParameter(34930),h=a.getParameter(35660),l=a.getParameter(3379),m=a.getParameter(34076),n=a.getParameter(34921),o=a.getParameter(36347),p=a.getParameter(36348),q=a.getParameter(36349),j=h>0,k=e||!!i.get("OES_texture_float"),{isWebGL2:e,getMaxAnisotropy:function(){if(void 0!==f)return f;var b=i.get("EXT_texture_filter_anisotropic");return f=null!==b?a.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:g,precision:b,logarithmicDepthBuffer:r,maxTextures:s,maxVertexTextures:h,maxTextureSize:l,maxCubemapSize:m,maxAttributes:n,maxVertexUniforms:o,maxVaryings:p,maxFragmentUniforms:q,vertexTextures:j,floatFragmentTextures:k,floatVertexTextures:j&&k,maxSamples:e?a.getParameter(36183):0}}function ky(k){var d=this,f=null,b=0,h=!1,c=!1,g=new am,i=new Q,a={value:null,needsUpdate:!1};function j(){a.value!==f&&(a.value=f,a.needsUpdate=b>0),d.numPlanes=b,d.numIntersection=0}function e(e,m,l,n){var c=null!==e?e.length:0,b=null,k,j,f,h;if(0!==c){if(b=a.value,!0!==n||null===b){k=l+4*c,j=m.matrixWorldInverse,i.getNormalMatrix(j),(null===b||b.length<k)&&(b=new Float32Array(k));for(f=0,h=l;f!==c;++f,h+=4)g.copy(e[f]).applyMatrix4(j,i),g.normal.toArray(b,h),b[h+3]=g.constant}a.value=b,a.needsUpdate=!0}return d.numPlanes=c,d.numIntersection=0,b}this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(a,c,d){var g=0!==a.length||c||0!==b||h;return h=c,f=e(a,d,0),b=a.length,g},this.beginShadows=function(){c=!0,e(null)},this.endShadows=function(){c=!1,j()},this.setState=function(d,q,r){var l=d.clippingPlanes,s=d.clipIntersection,p=d.clipShadows,o=k.get(d),m,n,g,i;if(!h||null===l||0===l.length||c&&!p)c?e(null):j();else{m=c?0:b,n=4*m,g=o.clippingState||null,a.value=g,g=e(l,q,n,r);for(i=0;i!==n;++i)g[i]=f[i];o.clippingState=g,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=m}}}function kD(b){var a=new WeakMap;function c(a,b){return b===de?a.mapping=cN:b===dm&&(a.mapping=cM),a}function d(e){var b=e.target,c;b.removeEventListener("dispose",d),c=a.get(b),void 0!==c&&(a.delete(b),c.dispose())}return{get:function(e){var h,f,i,j,g;if(e&&e.isTexture)if(h=e.mapping,h===de||h===dm)return a.has(e)?c(a.get(e).texture,e.mapping):(f=e.image,f&&f.height>0)?(i=b.getRenderList(),j=b.getRenderTarget(),g=new fS(f.height/2),g.fromEquirectangularTexture(b,e),a.set(e,g),b.setRenderTarget(j),b.setRenderList(i),e.addEventListener("dispose",d),c(g.texture,e.mapping)):null;return e},dispose:function(){a=new WeakMap}}}function kE(b){var c={};function a(d){if(void 0!==c[d])return c[d];var a;switch(d){case"WEBGL_depth_texture":a=b.getExtension("WEBGL_depth_texture")||b.getExtension("MOZ_WEBGL_depth_texture")||b.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=b.getExtension("WEBGL_compressed_texture_s3tc")||b.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=b.getExtension("WEBGL_compressed_texture_pvrtc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=b.getExtension(d)}return c[d]=a,a}return{has:function(b){return null!==a(b)},init:function(b){b.isWebGL2?a("EXT_color_buffer_float"):(a("WEBGL_depth_texture"),a("OES_texture_float"),a("OES_texture_half_float"),a("OES_texture_half_float_linear"),a("OES_standard_derivatives"),a("OES_element_index_uint"),a("OES_vertex_array_object"),a("ANGLE_instanced_arrays")),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float")},get:function(b){var c=a(b);return null===c&&console.warn("THREE.WebGLRenderer: "+b+" extension not supported."),c}}}function kG(h,a,e,g){var c={},b=new WeakMap;function d(i){var f=i.target,j,h;for(j in null!==f.index&&a.remove(f.index),f.attributes)a.remove(f.attributes[j]);f.removeEventListener("dispose",d),delete c[f.id],h=b.get(f),h&&(a.remove(h),b.delete(f)),g.releaseStatesOfGeometry(f),!0===f.isInstancedBufferGeometry&&delete f._maxInstanceCount,e.memory.geometries--}function f(g){var e=[],h=g.index,o=g.attributes.position,i=0,f,c,u,k,j,m,t,d,s,q,p,n,l,r;if(null!==h){f=h.array,i=h.version;for(c=0,u=f.length;c<u;c+=3)k=f[c+0],j=f[c+1],m=f[c+2],e.push(k,j,j,m,m,k)}else{t=o.array,i=o.version;for(d=0,s=t.length/3-1;d<s;d+=3)q=d+0,p=d+1,n=d+2,e.push(q,p,p,n,n,q)}l=new(iU(e)>65535?b$:cb)(e,1),l.version=i,r=b.get(g),r&&a.remove(r),b.set(g,l)}return{get:function(b,a){return!0===c[a.id]||(a.addEventListener("dispose",d),c[a.id]=!0,e.memory.geometries++),a},update:function(f){var c=f.attributes,g,d,h,e,b,i;for(g in c)a.update(c[g],34962);d=f.morphAttributes;for(h in d)for(e=d[h],b=0,i=e.length;b<i;b++)a.update(e[b],34962)},getWireframeAttribute:function(a){var c=b.get(a),d;return c?(d=a.index,null!==d&&c.version<d.version&&f(a)):f(a),b.get(a)}}}function kH(e,f,d,g){var a,c,b,h=g.isWebGL2;this.setMode=function(b){a=b},this.setIndex=function(a){c=a.type,b=a.bytesPerElement},this.render=function(g,f){e.drawElements(a,f,c,g*b),d.update(f,a,1)},this.renderInstances=function(l,k,g){if(0!==g){var i,j;if(h)i=e,j="drawElementsInstanced";else if(j="drawElementsInstancedANGLE",null===(i=f.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");i[j](a,k,c,l*b,g),d.update(k,a,g)}}}function kI(b){var a={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:a,programs:null,autoReset:!0,reset:function(){a.frame++,a.calls=0,a.triangles=0,a.points=0,a.lines=0},update:function(b,d,c){switch(a.calls++,d){case 4:a.triangles+=c*(b/3);break;case 1:a.lines+=c*(b/2);break;case 3:a.lines+=c*(b-1);break;case 2:a.lines+=c*b;break;case 0:a.points+=c*b;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function kJ(a,b){return a[0]-b[0]}function kK(a,b){return Math.abs(b[1])-Math.abs(a[1])}function kL(d){for(var e={},c=new Float32Array(8),a=[],b=0;b<8;b++)a[b]=[b,0];return{update:function(v,b,s,u){var n=v.morphTargetInfluences,p=void 0===n?0:n.length,h=e[b.id],l,i,q,g,m,k,r,f,t,j,o,w;if(void 0===h){h=[];for(l=0;l<p;l++)h[l]=[l,0];e[b.id]=h}for(i=0;i<p;i++)q=h[i],q[0]=i,q[1]=n[i];h.sort(kK);for(g=0;g<8;g++)g<p&&h[g][1]?(a[g][0]=h[g][0],a[g][1]=h[g][1]):(a[g][0]=Number.MAX_SAFE_INTEGER,a[g][1]=0);a.sort(kJ);for(m=s.morphTargets&&b.morphAttributes.position,k=s.morphNormals&&b.morphAttributes.normal,r=0,f=0;f<8;f++)t=a[f],j=t[0],o=t[1],j!==Number.MAX_SAFE_INTEGER&&o?(m&&b.getAttribute("morphTarget"+f)!==m[j]&&b.setAttribute("morphTarget"+f,m[j]),k&&b.getAttribute("morphNormal"+f)!==k[j]&&b.setAttribute("morphNormal"+f,k[j]),c[f]=o,r+=o):(m&&!0===b.hasAttribute("morphTarget"+f)&&b.deleteAttribute("morphTarget"+f),k&&!0===b.hasAttribute("morphNormal"+f)&&b.deleteAttribute("morphNormal"+f),c[f]=0);w=b.morphTargetsRelative?1:1-r,u.getUniforms().setValue(d,"morphTargetBaseInfluence",w),u.getUniforms().setValue(d,"morphTargetInfluences",c)}}}function kN(f,d,a,e){var b=new WeakMap;function c(d){var b=d.target;b.removeEventListener("dispose",c),a.remove(b.instanceMatrix),null!==b.instanceColor&&a.remove(b.instanceColor)}return{update:function(f){var h=e.render.frame,i=f.geometry,g=d.get(f,i);return b.get(g)!==h&&(d.update(g),b.set(g,h)),f.isInstancedMesh&&(!1===f.hasEventListener("dispose",c)&&f.addEventListener("dispose",c),a.update(f.instanceMatrix,34962),null!==f.instanceColor&&a.update(f.instanceColor,34962)),g},dispose:function(){b=new WeakMap}}}function cl(a,b,c,d){void 0===a&&(a=null),void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=1),r.call(this,null),this.image={data:a,width:b,height:c,depth:d},this.magFilter=C,this.minFilter=C,this.wrapR=L,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function cn(a,b,c,d){void 0===a&&(a=null),void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=1),r.call(this,null),this.image={data:a,width:b,height:c,depth:d},this.magFilter=C,this.minFilter=C,this.wrapR=L,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Z.physical={uniforms:K([Z.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new c(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new e(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:n.meshphysical_vert,fragmentShader:n.meshphysical_frag},cl.prototype=Object.create(r.prototype),cl.prototype.constructor=cl,cl.prototype.isDataTexture2DArray=!0,cn.prototype=Object.create(r.prototype),cn.prototype.constructor=cn,cn.prototype.isDataTexture3D=!0,hL=new r,iu=new cl,it=new cn,hM=new aE,gI=[],hN=[],hO=new Float32Array(16),hP=new Float32Array(9),hQ=new Float32Array(4);function cz(b,c,g){var d=b[0],e,a,f,h;if(d<=0||d>0)return b;if(e=c*g,a=gI[e],void 0===a&&(a=new Float32Array(e),gI[e]=a),0!==c){d.toArray(a,0);for(f=1,h=0;f!==c;++f)h+=g,b[f].toArray(a,h)}return a}function ad(b,c){if(b.length!==c.length)return!1;for(var a=0,d=b.length;a<d;a++)if(b[a]!==c[a])return!1;return!0}function U(c,b){for(var a=0,d=b.length;a<d;a++)c[a]=b[a]}function il(d,b){var a=hN[b],c;void 0===a&&(a=new Int32Array(b),hN[b]=a);for(c=0;c!==b;++c)a[c]=d.allocateTextureUnit();return a}function kV(c,a){var b=this.cache;b[0]!==a&&(c.uniform1f(this.addr,a),b[0]=a)}function kY(c,a){var b=this.cache;if(void 0!==a.x)b[0]===a.x&&b[1]===a.y||(c.uniform2f(this.addr,a.x,a.y),b[0]=a.x,b[1]=a.y);else{if(ad(b,a))return;c.uniform2fv(this.addr,a),U(b,a)}}function kZ(c,a){var b=this.cache;if(void 0!==a.x)b[0]===a.x&&b[1]===a.y&&b[2]===a.z||(c.uniform3f(this.addr,a.x,a.y,a.z),b[0]=a.x,b[1]=a.y,b[2]=a.z);else if(void 0!==a.r)b[0]===a.r&&b[1]===a.g&&b[2]===a.b||(c.uniform3f(this.addr,a.r,a.g,a.b),b[0]=a.r,b[1]=a.g,b[2]=a.b);else{if(ad(b,a))return;c.uniform3fv(this.addr,a),U(b,a)}}function k$(c,a){var b=this.cache;if(void 0!==a.x)b[0]===a.x&&b[1]===a.y&&b[2]===a.z&&b[3]===a.w||(c.uniform4f(this.addr,a.x,a.y,a.z,a.w),b[0]=a.x,b[1]=a.y,b[2]=a.z,b[3]=a.w);else{if(ad(b,a))return;c.uniform4fv(this.addr,a),U(b,a)}}function la(d,a){var b=this.cache,c=a.elements;if(void 0===c){if(ad(b,a))return;d.uniformMatrix2fv(this.addr,!1,a),U(b,a)}else{if(ad(b,c))return;hQ.set(c),d.uniformMatrix2fv(this.addr,!1,hQ),U(b,c)}}function lb(d,a){var b=this.cache,c=a.elements;if(void 0===c){if(ad(b,a))return;d.uniformMatrix3fv(this.addr,!1,a),U(b,a)}else{if(ad(b,c))return;hP.set(c),d.uniformMatrix3fv(this.addr,!1,hP),U(b,c)}}function le(d,a){var b=this.cache,c=a.elements;if(void 0===c){if(ad(b,a))return;d.uniformMatrix4fv(this.addr,!1,a),U(b,a)}else{if(ad(b,c))return;hO.set(c),d.uniformMatrix4fv(this.addr,!1,hO),U(b,c)}}function lf(d,e,b){var c=this.cache,a=b.allocateTextureUnit();c[0]!==a&&(d.uniform1i(this.addr,a),c[0]=a),b.safeSetTexture2D(e||hL,a)}function li(d,e,b){var c=this.cache,a=b.allocateTextureUnit();c[0]!==a&&(d.uniform1i(this.addr,a),c[0]=a),b.setTexture2DArray(e||iu,a)}function lj(d,e,b){var c=this.cache,a=b.allocateTextureUnit();c[0]!==a&&(d.uniform1i(this.addr,a),c[0]=a),b.setTexture3D(e||it,a)}function jX(d,e,b){var c=this.cache,a=b.allocateTextureUnit();c[0]!==a&&(d.uniform1i(this.addr,a),c[0]=a),b.safeSetTextureCube(e||hM,a)}function kj(c,a){var b=this.cache;b[0]!==a&&(c.uniform1i(this.addr,a),b[0]=a)}function lk(c,a){var b=this.cache;ad(b,a)||(c.uniform2iv(this.addr,a),U(b,a))}function lh(c,a){var b=this.cache;ad(b,a)||(c.uniform3iv(this.addr,a),U(b,a))}function lg(c,a){var b=this.cache;ad(b,a)||(c.uniform4iv(this.addr,a),U(b,a))}function kU(c,a){var b=this.cache;b[0]!==a&&(c.uniform1ui(this.addr,a),b[0]=a)}function kT(a,b){a.uniform1fv(this.addr,b)}function kS(a,b){a.uniform1iv(this.addr,b)}function kR(a,b){a.uniform2iv(this.addr,b)}function lm(a,b){a.uniform3iv(this.addr,b)}function kP(a,b){a.uniform4iv(this.addr,b)}function kw(a,b){var c=cz(b,this.size,2);a.uniform2fv(this.addr,c)}function kt(a,b){var c=cz(b,this.size,3);a.uniform3fv(this.addr,c)}function kn(a,b){var c=cz(b,this.size,4);a.uniform4fv(this.addr,c)}function ki(a,b){var c=cz(b,this.size,4);a.uniformMatrix2fv(this.addr,!1,c)}function kh(a,b){var c=cz(b,this.size,9);a.uniformMatrix3fv(this.addr,!1,c)}function kg(a,b){var c=cz(b,this.size,16);a.uniformMatrix4fv(this.addr,!1,c)}function kf(f,b,c){var d=b.length,e=il(c,d),a;f.uniform1iv(this.addr,e);for(a=0;a!==d;++a)c.safeSetTexture2D(b[a]||hL,e[a])}function ke(f,b,c){var d=b.length,e=il(c,d),a;f.uniform1iv(this.addr,e);for(a=0;a!==d;++a)c.safeSetTextureCube(b[a]||hM,e[a])}function kd(a,b,c){this.id=a,this.addr=c,this.cache=[],this.setValue=function(a){switch(a){case 5126:return kV;case 35664:return kY;case 35665:return kZ;case 35666:return k$;case 35674:return la;case 35675:return lb;case 35676:return le;case 5124:case 35670:return kj;case 35667:case 35671:return lk;case 35668:case 35672:return lh;case 35669:case 35673:return lg;case 5125:return kU;case 35678:case 36198:case 36298:case 36306:case 35682:return lf;case 35679:case 36299:case 36307:return lj;case 35680:case 36300:case 36308:case 36293:return jX;case 36289:case 36303:case 36311:case 36292:return li}}(b.type)}function ja(b,a,c){this.id=b,this.addr=c,this.cache=[],this.size=a.size,this.setValue=function(a){switch(a){case 5126:return kT;case 35664:return kw;case 35665:return kt;case 35666:return kn;case 35674:return ki;case 35675:return kh;case 35676:return kg;case 5124:case 35670:return kS;case 35667:case 35671:return kR;case 35668:case 35672:return lm;case 35669:case 35673:return kP;case 35678:case 36198:case 36298:case 36306:case 35682:return kf;case 35680:case 36300:case 36308:case 36293:return ke}}(a.type)}function jb(a){this.id=a,this.seq=[],this.map={}}ja.prototype.updateCache=function(a){var b=this.cache;a instanceof Float32Array&&b.length!==a.length&&(this.cache=new Float32Array(a.length)),U(b,a)},jb.prototype.setValue=function(g,d,e){for(var c=this.seq,a=0,f=c.length,b;a!==f;++a)b=c[a],b.setValue(g,d[b.id],e)},ev=/(\w+)(\])?(\[|\.)?/g;function jc(b,a){b.seq.push(a),b.map[a.id]=a}function j_(c,g,b){var h=c.name,k=h.length,f,i,a,j,d,e;for(ev.lastIndex=0;;){if(f=ev.exec(h),i=ev.lastIndex,a=f[1],j="]"===f[2],d=f[3],j&&(a|=0),void 0===d||"["===d&&i+2===k){jc(b,void 0===d?new kd(a,c,g):new ja(a,c,g));break}e=b.map[a],void 0===e&&jc(b,e=new jb(a)),b=e}}function a$(b,c){var e,a,d;this.seq=[],this.map={};for(e=b.getProgramParameter(c,35718),a=0;a<e;++a)d=b.getActiveUniform(c,a),j_(d,b.getUniformLocation(c,d.name),this)}function jf(a,c,d){var b=a.createShader(c);return a.shaderSource(b,d),a.compileShader(b),b}a$.prototype.setValue=function(b,c,d,e){var a=this.map[c];void 0!==a&&a.setValue(b,d,e)},a$.prototype.setOptional=function(c,d,a){var b=d[a];void 0!==b&&this.setValue(c,a,b)},a$.upload=function(h,c,e,f){for(var a=0,g=c.length,b,d;a!==g;++a)b=c[a],d=e[b.id],!1!==d.needsUpdate&&b.setValue(h,d.value,f)},a$.seqWithValue=function(b,e){for(var c=[],a=0,f=b.length,d;a!==f;++a)d=b[a],d.id in e&&c.push(d);return c},jg=0;function jh(a){switch(a){case aR:return["Linear","( value )"];case dM:return["sRGB","( value )"];case fa:return["RGBE","( value )"];case gx:return["RGBM","( value, 7.0 )"];case gy:return["RGBM","( value, 16.0 )"];case gA:return["RGBD","( value, 256.0 )"];case fb:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}function ji(a,b,d){var e=a.getShaderParameter(b,35713),c=a.getShaderInfoLog(b).trim();return e&&""===c?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+d+"\n"+c+function(c){for(var b=c.split("\n"),a=0;a<b.length;a++)b[a]=a+1+": "+b[a];return b.join("\n")}(a.getShaderSource(b))}function ei(b,c){var a=jh(c);return"vec4 "+b+"( vec4 value ) { return "+a[0]+"ToLinear"+a[1]+"; }"}function j$(c,b){var a;switch(b){case 1:a="Linear";break;case 2:a="Reinhard";break;case 3:a="OptimizedCineon";break;case 4:a="ACESFilmic";break;case 5:a="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",b),a="Linear"}return"vec3 "+c+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function ef(a){return""!==a}function jk(b,a){return b.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,a.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,a.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,a.numPointLightShadows)}function jm(b,a){return b.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}jp=/^[ \t]*#include +<([\w\d./]+)>/gm;function hV(a){return a.replace(jp,jV)}function jV(c,a){var b=n[a];if(void 0===b)throw new Error("Can not resolve #include <"+a+">");return hV(b)}jz=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,jA=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jD(a){return a.replace(jA,jP).replace(jz,jU)}function jU(a,b,c,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),jP(a,b,c,d)}function jP(f,c,d,e){for(var b="",a=parseInt(c);a<parseInt(d);a++)b+=e.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return b}function jQ(a){var b="precision "+a.precision+" float;\nprecision "+a.precision+" int;";return"highp"===a.precision?b+="\n#define HIGH_PRECISION":"mediump"===a.precision?b+="\n#define MEDIUM_PRECISION":"lowp"===a.precision&&(b+="\n#define LOW_PRECISION"),b}function jT(k,G,a,F){var e,f,t,u,m,b=k.getContext(),E=a.defines,g=a.vertexShader,d=a.fragmentShader,y=function(b){var a="SHADOWMAP_TYPE_BASIC";return 1===b.shadowMapType?a="SHADOWMAP_TYPE_PCF":2===b.shadowMapType?a="SHADOWMAP_TYPE_PCF_SOFT":3===b.shadowMapType&&(a="SHADOWMAP_TYPE_VSM"),a}(a),D=function(b){var a="ENVMAP_TYPE_CUBE";if(b.envMap)switch(b.envMapMode){case cN:case cM:a="ENVMAP_TYPE_CUBE";break;case bK:case cQ:a="ENVMAP_TYPE_CUBE_UV"}return a}(a),w=function(a){var b="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case cM:case cQ:b="ENVMAP_MODE_REFRACTION"}return b}(a),C=function(b){var a="ENVMAP_BLENDING_NONE";if(b.envMap)switch(b.combine){case 0:a="ENVMAP_BLENDING_MULTIPLY";break;case 1:a="ENVMAP_BLENDING_MIX";break;case 2:a="ENVMAP_BLENDING_ADD"}return a}(a),A=k.gammaFactor>0?k.gammaFactor:1,r=a.isWebGL2?"":function(a){return[a.extensionDerivatives||a.envMapCubeUV||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||"physical"===a.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ef).join("\n")}(a),j=function(a){var b=[],c,d;for(c in a)d=a[c],!1!==d&&b.push("#define "+c+" "+d);return b.join("\n")}(E),c=b.createProgram(),q=a.glslVersion?"#version "+a.glslVersion+"\n":"",p,o,B,h,i,l,x,s,z,v,H,I;return a.isRawShaderMaterial?((e=[j].filter(ef).join("\n")).length>0&&(e+="\n"),(f=[r,j].filter(ef).join("\n")).length>0&&(f+="\n")):(e=[jQ(a),"#define SHADER_NAME "+a.shaderName,j,a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+w:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+y:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(ef).join("\n"),f=[r,jQ(a),"#define SHADER_NAME "+a.shaderName,j,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+A,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+D:"",a.envMap?"#define "+w:"",a.envMap?"#define "+C:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.sheen?"#define USE_SHEEN":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+y:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==a.toneMapping?"#define TONE_MAPPING":"",0!==a.toneMapping?n.tonemapping_pars_fragment:"",0!==a.toneMapping?j$("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",n.encodings_pars_fragment,a.map?ei("mapTexelToLinear",a.mapEncoding):"",a.matcap?ei("matcapTexelToLinear",a.matcapEncoding):"",a.envMap?ei("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMap?ei("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.lightMap?ei("lightMapTexelToLinear",a.lightMapEncoding):"",(t="linearToOutputTexel",u=a.outputEncoding,m=jh(u),"vec4 "+t+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"),a.depthPacking?"#define DEPTH_PACKING "+a.depthPacking:"","\n"].filter(ef).join("\n")),g=jm(g=jk(g=hV(g),a),a),d=jm(d=jk(d=hV(d),a),a),g=jD(g),d=jD(d),a.isWebGL2&&!0!==a.isRawShaderMaterial&&(q="#version 300 es\n",e=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+e,f=["#define varying in",a.glslVersion===eW?"":"out highp vec4 pc_fragColor;",a.glslVersion===eW?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+f),B=q+f+d,h=jf(b,35633,q+e+g),i=jf(b,35632,B),(b.attachShader(c,h),b.attachShader(c,i),void 0!==a.index0AttributeName?b.bindAttribLocation(c,0,a.index0AttributeName):!0===a.morphTargets&&b.bindAttribLocation(c,0,"position"),b.linkProgram(c),k.debug.checkShaderErrors)&&(l=b.getProgramInfoLog(c).trim(),x=b.getShaderInfoLog(h).trim(),s=b.getShaderInfoLog(i).trim(),z=!0,v=!0,!1===b.getProgramParameter(c,35714)?(z=!1,H=ji(b,h,"vertex"),I=ji(b,i,"fragment"),console.error("THREE.WebGLProgram: shader error: ",b.getError(),"35715",b.getProgramParameter(c,35715),"gl.getProgramInfoLog",l,H,I)):""!==l?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",l):""!==x&&""!==s||(v=!1),v&&(this.diagnostics={runnable:z,programLog:l,vertexShader:{log:x,prefix:e},fragmentShader:{log:s,prefix:f}})),b.deleteShader(h),b.deleteShader(i),this.getUniforms=function(){return void 0===p&&(p=new a$(b,c)),p},this.getAttributes=function(){return void 0===o&&(o=function(a,b){for(var d={},f=a.getProgramParameter(b,35721),c=0,e;c<f;c++)e=a.getActiveAttrib(b,c).name,d[e]=a.getAttribLocation(b,e);return d}(b,c)),o},this.destroy=function(){F.releaseStatesOfProgram(this),b.deleteProgram(c),this.program=void 0},this.name=a.shaderName,this.id=jg++,this.cacheKey=G,this.usedTimes=1,this.program=c,this.vertexShader=h,this.fragmentShader=i,this}function jY(a,o,f,c,l,h){var b=[],e=c.isWebGL2,p=c.logarithmicDepthBuffer,j=c.floatVertexTextures,m=c.maxVertexUniforms,n=c.vertexTextures,g=c.precision,k={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},i=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function d(a){var b;return a&&a.isTexture?b=a.encoding:a&&a.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),b=a.texture.encoding):b=aR,b}return{getParameters:function(b,i,A,v,q){var s,t,u=v.fog,z=b.isMeshStandardMaterial?v.environment:null,l=o.get(b.envMap||z),r=k[b.type],w=q.isSkinnedMesh?function(c){var a=c.skeleton.bones,d,e,b;return j?1024:(d=m,e=Math.floor((d-20)/4),b=Math.min(e,a.length),b<a.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+a.length+" bones. This GPU supports "+b+"."),0):b)}(q):0,x,y;return null!==b.precision&&(g=c.getMaxPrecision(b.precision))!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",g,"instead."),r?(x=Z[r],s=x.vertexShader,t=x.fragmentShader):(s=b.vertexShader,t=b.fragmentShader),y=a.getRenderTarget(),{isWebGL2:e,shaderID:r,shaderName:b.type,vertexShader:s,fragmentShader:t,defines:b.defines,isRawShaderMaterial:!0===b.isRawShaderMaterial,glslVersion:b.glslVersion,precision:g,instancing:!0===q.isInstancedMesh,instancingColor:!0===q.isInstancedMesh&&null!==q.instanceColor,supportsVertexTextures:n,outputEncoding:null!==y?d(y.texture):a.outputEncoding,map:!!b.map,mapEncoding:d(b.map),matcap:!!b.matcap,matcapEncoding:d(b.matcap),envMap:!!l,envMapMode:l&&l.mapping,envMapEncoding:d(l),envMapCubeUV:!!l&&(l.mapping===bK||l.mapping===cQ),lightMap:!!b.lightMap,lightMapEncoding:d(b.lightMap),aoMap:!!b.aoMap,emissiveMap:!!b.emissiveMap,emissiveMapEncoding:d(b.emissiveMap),bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,objectSpaceNormalMap:1===b.normalMapType,tangentSpaceNormalMap:0===b.normalMapType,clearcoatMap:!!b.clearcoatMap,clearcoatRoughnessMap:!!b.clearcoatRoughnessMap,clearcoatNormalMap:!!b.clearcoatNormalMap,displacementMap:!!b.displacementMap,roughnessMap:!!b.roughnessMap,metalnessMap:!!b.metalnessMap,specularMap:!!b.specularMap,alphaMap:!!b.alphaMap,gradientMap:!!b.gradientMap,sheen:!!b.sheen,transmissionMap:!!b.transmissionMap,combine:b.combine,vertexTangents:b.normalMap&&b.vertexTangents,vertexColors:b.vertexColors,vertexUvs:!!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatMap||b.clearcoatRoughnessMap||b.clearcoatNormalMap||b.displacementMap||b.transmissionMap),uvsVertexOnly:!(b.map||b.bumpMap||b.normalMap||b.specularMap||b.alphaMap||b.emissiveMap||b.roughnessMap||b.metalnessMap||b.clearcoatNormalMap||b.transmissionMap||!b.displacementMap),fog:!!u,useFog:b.fog,fogExp2:u&&u.isFogExp2,flatShading:b.flatShading,sizeAttenuation:b.sizeAttenuation,logarithmicDepthBuffer:p,skinning:b.skinning&&w>0,maxBones:w,useVertexTexture:j,morphTargets:b.morphTargets,morphNormals:b.morphNormals,maxMorphTargets:a.maxMorphTargets,maxMorphNormals:a.maxMorphNormals,numDirLights:i.directional.length,numPointLights:i.point.length,numSpotLights:i.spot.length,numRectAreaLights:i.rectArea.length,numHemiLights:i.hemi.length,numDirLightShadows:i.directionalShadowMap.length,numPointLightShadows:i.pointShadowMap.length,numSpotLightShadows:i.spotShadowMap.length,numClippingPlanes:h.numPlanes,numClipIntersection:h.numIntersection,dithering:b.dithering,shadowMapEnabled:a.shadowMap.enabled&&A.length>0,shadowMapType:a.shadowMap.type,toneMapping:b.toneMapped?a.toneMapping:0,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:b.premultipliedAlpha,alphaTest:b.alphaTest,doubleSided:2===b.side,flipSided:1===b.side,depthPacking:void 0!==b.depthPacking&&b.depthPacking,index0AttributeName:b.index0AttributeName,extensionDerivatives:b.extensions&&b.extensions.derivatives,extensionFragDepth:b.extensions&&b.extensions.fragDepth,extensionDrawBuffers:b.extensions&&b.extensions.drawBuffers,extensionShaderTextureLOD:b.extensions&&b.extensions.shaderTextureLOD,rendererExtensionFragDepth:e||f.has("EXT_frag_depth"),rendererExtensionDrawBuffers:e||f.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:e||f.has("EXT_shader_texture_lod"),customProgramCacheKey:b.customProgramCacheKey()}},getProgramCacheKey:function(b){var c=[],e,d;if(b.shaderID?c.push(b.shaderID):(c.push(b.fragmentShader),c.push(b.vertexShader)),void 0!==b.defines)for(e in b.defines)c.push(e),c.push(b.defines[e]);if(!1===b.isRawShaderMaterial){for(d=0;d<i.length;d++)c.push(b[i[d]]);c.push(a.outputEncoding),c.push(a.gammaFactor)}return c.push(b.customProgramCacheKey),c.join()},getUniforms:function(b){var a,c=k[b.type],d;return c?(d=Z[c],a=hH.clone(d.uniforms)):a=b.uniforms,a},acquireProgram:function(g,e){for(var c,d=0,h=b.length,f;d<h;d++)if(f=b[d],f.cacheKey===e){++(c=f).usedTimes;break}return void 0===c&&(c=new jT(a,e,g,l),b.push(c)),c},releaseProgram:function(a){if(0==--a.usedTimes){var c=b.indexOf(a);b[c]=b[b.length-1],b.pop(),a.destroy()}},programs:b}}function jZ(){var a=new WeakMap;return{get:function(c){var b=a.get(c);return void 0===b&&(b={},a.set(c,b)),b},remove:function(b){a.delete(b)},update:function(b,c,d){a.get(b)[c]=d},dispose:function(){a=new WeakMap}}}function ka(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function kc(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function iZ(g){var d=[],c=0,a=[],b=[],f={id:-1};function e(b,h,e,i,j,k){var a=d[c],l=g.get(e);return void 0===a?(a={id:b.id,object:b,geometry:h,material:e,program:l.program||f,groupOrder:i,renderOrder:b.renderOrder,z:j,group:k},d[c]=a):(a.id=b.id,a.object=b,a.geometry=h,a.material=e,a.program=l.program||f,a.groupOrder=i,a.renderOrder=b.renderOrder,a.z=j,a.group=k),c++,a}return{opaque:a,transparent:b,init:function(){c=0,a.length=0,b.length=0},push:function(d,f,c,g,h,i){var j=e(d,f,c,g,h,i);(!0===c.transparent?b:a).push(j)},unshift:function(d,f,c,g,h,i){var j=e(d,f,c,g,h,i);(!0===c.transparent?b:a).unshift(j)},finish:function(){for(var b=c,e=d.length,a;b<e;b++){if(a=d[b],null===a.id)break;a.id=null,a.object=null,a.geometry=null,a.material=null,a.program=null,a.group=null}},sort:function(c,d){a.length>1&&a.sort(c||ka),b.length>1&&b.sort(d||kc)}}}function kl(b){var a=new WeakMap;return{get:function(d,e){var c,f=a.get(d);return void 0===f?(c=new iZ(b),a.set(d,new WeakMap),a.get(d).set(e,c)):void 0===(c=f.get(e))&&(c=new iZ(b),f.set(e,c)),c},dispose:function(){a=new WeakMap}}}function km(){var a={};return{get:function(d){if(void 0!==a[d.id])return a[d.id];var c;switch(d.type){case"DirectionalLight":c={direction:new b,color:new e};break;case"SpotLight":c={position:new b,direction:new b,color:new e,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new b,color:new e,distance:0,decay:0};break;case"HemisphereLight":c={direction:new b,skyColor:new e,groundColor:new e};break;case"RectAreaLight":c={color:new e,position:new b,halfWidth:new b,halfHeight:new b}}return a[d.id]=c,c}}}iK=0;function jW(a,b){return(b.castShadow?1:0)-(a.castShadow?1:0)}function kM(k,m){for(var g,e=new km,i=(g={},{get:function(a){if(void 0!==g[a.id])return g[a.id];var b;switch(a.type){case"DirectionalLight":case"SpotLight":b={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new c};break;case"PointLight":b={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new c,shadowCameraNear:1,shadowCameraFar:1e3}}return g[a.id]=b,b}}),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},l=0,f,j,h;l<9;l++)a.probe.push(new b);return f=new b,j=new o,h=new o,{setup:function(G){for(var K=0,J=0,H=0,E=0,g,h,j,o,v,q,r,s,D,M,b,w,f,L,F,z,I,B,t,n,y,u,x,A,p,l,C,c;E<9;E++)a.probe[E].set(0,0,0);g=0,h=0,j=0,o=0,v=0,q=0,r=0,s=0,G.sort(jW);for(D=0,M=G.length;D<M;D++)if(b=G[D],w=b.color,f=b.intensity,L=b.distance,F=b.shadow&&b.shadow.map?b.shadow.map.texture:null,b.isAmbientLight)K+=w.r*f,J+=w.g*f,H+=w.b*f;else if(b.isLightProbe)for(z=0;z<9;z++)a.probe[z].addScaledVector(b.sh.coefficients[z],f);else b.isDirectionalLight?(I=e.get(b),(I.color.copy(b.color).multiplyScalar(b.intensity),b.castShadow)&&(B=b.shadow,t=i.get(b),t.shadowBias=B.bias,t.shadowNormalBias=B.normalBias,t.shadowRadius=B.radius,t.shadowMapSize=B.mapSize,a.directionalShadow[g]=t,a.directionalShadowMap[g]=F,a.directionalShadowMatrix[g]=b.shadow.matrix,q++),a.directional[g]=I,g++):b.isSpotLight?(n=e.get(b),(n.position.setFromMatrixPosition(b.matrixWorld),n.color.copy(w).multiplyScalar(f),n.distance=L,n.coneCos=Math.cos(b.angle),n.penumbraCos=Math.cos(b.angle*(1-b.penumbra)),n.decay=b.decay,b.castShadow)&&(y=b.shadow,u=i.get(b),u.shadowBias=y.bias,u.shadowNormalBias=y.normalBias,u.shadowRadius=y.radius,u.shadowMapSize=y.mapSize,a.spotShadow[j]=u,a.spotShadowMap[j]=F,a.spotShadowMatrix[j]=b.shadow.matrix,s++),a.spot[j]=n,j++):b.isRectAreaLight?(x=e.get(b),x.color.copy(w).multiplyScalar(f),x.halfWidth.set(.5*b.width,0,0),x.halfHeight.set(0,.5*b.height,0),a.rectArea[o]=x,o++):b.isPointLight?(A=e.get(b),(A.color.copy(b.color).multiplyScalar(b.intensity),A.distance=b.distance,A.decay=b.decay,b.castShadow)&&(p=b.shadow,l=i.get(b),l.shadowBias=p.bias,l.shadowNormalBias=p.normalBias,l.shadowRadius=p.radius,l.shadowMapSize=p.mapSize,l.shadowCameraNear=p.camera.near,l.shadowCameraFar=p.camera.far,a.pointShadow[h]=l,a.pointShadowMap[h]=F,a.pointShadowMatrix[h]=b.shadow.matrix,r++),a.point[h]=A,h++):b.isHemisphereLight&&(C=e.get(b),C.skyColor.copy(b.color).multiplyScalar(f),C.groundColor.copy(b.groundColor).multiplyScalar(f),a.hemi[v]=C,v++);o>0&&(m.isWebGL2||!0===k.has("OES_texture_float_linear")?(a.rectAreaLTC1=d.LTC_FLOAT_1,a.rectAreaLTC2=d.LTC_FLOAT_2):!0===k.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=d.LTC_HALF_1,a.rectAreaLTC2=d.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=K,a.ambient[1]=J,a.ambient[2]=H,c=a.hash,c.directionalLength===g&&c.pointLength===h&&c.spotLength===j&&c.rectAreaLength===o&&c.hemiLength===v&&c.numDirectionalShadows===q&&c.numPointShadows===r&&c.numSpotShadows===s||(a.directional.length=g,a.spot.length=j,a.rectArea.length=o,a.point.length=h,a.hemi.length=v,a.directionalShadow.length=q,a.directionalShadowMap.length=q,a.pointShadow.length=r,a.pointShadowMap.length=r,a.spotShadow.length=s,a.spotShadowMap.length=s,a.directionalShadowMatrix.length=q,a.pointShadowMatrix.length=r,a.spotShadowMatrix.length=s,c.directionalLength=g,c.pointLength=h,c.spotLength=j,c.rectAreaLength=o,c.hemiLength=v,c.numDirectionalShadows=q,c.numPointShadows=r,c.numSpotShadows=s,a.version=iK++)},setupView:function(n,s){for(var q=0,p=0,o=0,m=0,l=0,c=s.matrixWorldInverse,i=0,t=n.length,b,g,e,d,r,k;i<t;i++)b=n[i],b.isDirectionalLight?(g=a.directional[q],g.direction.setFromMatrixPosition(b.matrixWorld),f.setFromMatrixPosition(b.target.matrixWorld),g.direction.sub(f),g.direction.transformDirection(c),q++):b.isSpotLight?(e=a.spot[o],e.position.setFromMatrixPosition(b.matrixWorld),e.position.applyMatrix4(c),e.direction.setFromMatrixPosition(b.matrixWorld),f.setFromMatrixPosition(b.target.matrixWorld),e.direction.sub(f),e.direction.transformDirection(c),o++):b.isRectAreaLight?(d=a.rectArea[m],d.position.setFromMatrixPosition(b.matrixWorld),d.position.applyMatrix4(c),h.identity(),j.copy(b.matrixWorld),j.premultiply(c),h.extractRotation(j),d.halfWidth.set(.5*b.width,0,0),d.halfHeight.set(0,.5*b.height,0),d.halfWidth.applyMatrix4(h),d.halfHeight.applyMatrix4(h),m++):b.isPointLight?(r=a.point[p],r.position.setFromMatrixPosition(b.matrixWorld),r.position.applyMatrix4(c),p++):b.isHemisphereLight&&(k=a.hemi[l],k.direction.setFromMatrixPosition(b.matrixWorld),k.direction.transformDirection(c),k.direction.normalize(),l++)},state:a}}function iw(d,e){var b=new kM(d,e),a=[],c=[];return{init:function(){a.length=0,c.length=0},state:{lightsArray:a,shadowsArray:c,lights:b},setupLights:function(){b.setup(a)},setupLightsView:function(c){b.setupView(a,c)},pushLight:function(b){a.push(b)},pushShadow:function(a){c.push(a)}}}function kO(b,c){var a=new WeakMap;return{get:function(d,f){var e;return void 0===f&&(f=0),!1===a.has(d)?(e=new iw(b,c),a.set(d,[]),a.get(d).push(e)):f>=a.get(d).length?(e=new iw(b,c),a.get(d).push(e)):e=a.get(d)[f],e},dispose:function(){a=new WeakMap}}}function bl(a){j.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(a)}function bx(a){j.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new b,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(a)}bl.prototype=Object.create(j.prototype),bl.prototype.constructor=bl,bl.prototype.isMeshDepthMaterial=!0,bl.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.depthPacking=a.depthPacking,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this},bx.prototype=Object.create(j.prototype),bx.prototype.constructor=bx,bx.prototype.isMeshDistanceMaterial=!0,bx.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.referencePosition.copy(a.referencePosition),this.nearDistance=a.nearDistance,this.farDistance=a.farDistance,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.map=a.map,this.alphaMap=a.alphaMap,this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this};function ik(a,u,f){var s=new cF,b=new c,d=new c,p=new q,o=[],n=[],m={},z={0:1,1:0,2:2},e=new M({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new c},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean * HALF_SAMPLE_RATE;\n	squared_mean = squared_mean * HALF_SAMPLE_RATE;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),g=e.clone(),r,j,h;g.defines.HORIZONTAL_PASS=1,r=new i,r.setAttribute("position",new k(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3)),j=new t(r,e),h=this;function y(b,c){var d=u.update(j);e.uniforms.shadow_pass.value=b.map.texture,e.uniforms.resolution.value=b.mapSize,e.uniforms.radius.value=b.radius,a.setRenderTarget(b.mapPass),a.clear(),a.renderBufferDirect(c,null,d,e,j,null),g.uniforms.shadow_pass.value=b.mapPass.texture,g.uniforms.resolution.value=b.mapSize,g.uniforms.radius.value=b.radius,a.setRenderTarget(b.map),a.clear(),a.renderBufferDirect(c,null,d,g,j,null)}function w(b,c,e){var d=b<<0|c<<1|e<<2,a=o[d];return void 0===a&&(a=new bl({depthPacking:3201,morphTargets:b,skinning:c}),o[d]=a),a}function x(b,c,e){var d=b<<0|c<<1|e<<2,a=n[d];return void 0===a&&(a=new bx({morphTargets:b,skinning:c}),n[d]=a),a}function v(e,i,c,g,r,p,q){var b=null,o=w,h=e.customDepthMaterial,n,j,k,l,d,f;return!0===g.isPointLight&&(o=x,h=e.customDistanceMaterial),void 0===h?(n=!1,!0===c.morphTargets&&(n=i.morphAttributes&&i.morphAttributes.position&&i.morphAttributes.position.length>0),j=!1,!0===e.isSkinnedMesh&&(!0===c.skinning?j=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e)),b=o(n,j,!0===e.isInstancedMesh)):b=h,a.localClippingEnabled&&!0===c.clipShadows&&0!==c.clippingPlanes.length&&(k=b.uuid,l=c.uuid,d=m[k],void 0===d&&(d={},m[k]=d),f=d[l],void 0===f&&(f=b.clone(),d[l]=f),b=f),b.visible=c.visible,b.wireframe=c.wireframe,b.side=3===q?null!==c.shadowSide?c.shadowSide:c.side:null!==c.shadowSide?c.shadowSide:z[c.side],b.clipShadows=c.clipShadows,b.clippingPlanes=c.clippingPlanes,b.clipIntersection=c.clipIntersection,b.wireframeLinewidth=c.wireframeLinewidth,b.linewidth=c.linewidth,!0===g.isPointLight&&!0===b.isMeshDistanceMaterial&&(b.referencePosition.setFromMatrixPosition(g.matrixWorld),b.nearDistance=r,b.farDistance=p),b}function l(b,r,c,m,h){var d,e,j,i,o,k,g,p,q,n,f,t;if(!1!==b.visible){if(b.layers.test(r.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&3===h)&&(!b.frustumCulled||s.intersectsObject(b)))if(b.modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,b.matrixWorld),d=u.update(b),e=b.material,Array.isArray(e)){for(j=d.groups,i=0,o=j.length;i<o;i++)k=j[i],g=e[k.materialIndex],g&&g.visible&&(p=v(b,d,g,m,c.near,c.far,h),a.renderBufferDirect(c,null,d,p,b,k))}else e.visible&&(q=v(b,d,e,m,c.near,c.far,h),a.renderBufferDirect(c,null,d,q,b,null));for(n=b.children,f=0,t=n.length;f<t;f++)l(n[f],r,c,m,h)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(o,z,u){var t,r,q,g,m,x,e,c,i,n,v,w,j,k;if(!1!==h.enabled&&(!1!==h.autoUpdate||!1!==h.needsUpdate)&&0!==o.length){t=a.getRenderTarget(),r=a.getActiveCubeFace(),q=a.getActiveMipmapLevel(),g=a.state,g.setBlending(0),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);for(m=0,x=o.length;m<x;m++)if(e=o[m],c=e.shadow,void 0!==c){if(!1!==c.autoUpdate||!1!==c.needsUpdate){b.copy(c.mapSize),i=c.getFrameExtents(),(b.multiply(i),d.copy(c.mapSize),(b.x>f||b.y>f)&&(b.x>f&&(d.x=Math.floor(f/i.x),b.x=d.x*i.x,c.mapSize.x=d.x),b.y>f&&(d.y=Math.floor(f/i.y),b.y=d.y*i.y,c.mapSize.y=d.y)),null===c.map&&!c.isPointLightShadow&&3===this.type)&&(n={minFilter:D,magFilter:D,format:Y},c.map=new aI(b.x,b.y,n),c.map.texture.name=e.name+".shadowMap",c.mapPass=new aI(b.x,b.y,n),c.camera.updateProjectionMatrix()),null===c.map&&(v={minFilter:C,magFilter:C,format:Y},c.map=new aI(b.x,b.y,v),c.map.texture.name=e.name+".shadowMap",c.camera.updateProjectionMatrix()),a.setRenderTarget(c.map),a.clear();for(w=c.getViewportCount(),j=0;j<w;j++)k=c.getViewport(j),p.set(d.x*k.x,d.y*k.y,d.x*k.z,d.y*k.w),g.viewport(p),c.updateMatrices(e,j),s=c.getFrustum(),l(z,u,c.camera,e,this.type);c.isPointLightShadow||3!==this.type||y(c,u),c.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",e,"has no shadow.");h.needsUpdate=!1,a.setRenderTarget(t,r,q)}}}function kW(a,S,R){var z,b,Q=R.isWebGL2,t=new function(){var b=!1,c=new q,d=null,e=new q(0,0,0,0);return{setMask:function(c){d===c||b||(a.colorMask(c,c,c,c),d=c)},setLocked:function(a){b=a},setClear:function(d,f,g,b,h){!0===h&&(d*=b,f*=b,g*=b),c.set(d,f,g,b),!1===e.equals(c)&&(a.clearColor(d,f,g,b),e.copy(c))},reset:function(){b=!1,d=null,e.set(-1,0,0,0)}}},f=new function(){var b=!1,e=null,f=null,g=null;return{setTest:function(a){a?c(2929):d(2929)},setMask:function(c){e===c||b||(a.depthMask(c),e=c)},setFunc:function(b){if(f!==b){if(b)switch(b){case 0:a.depthFunc(512);break;case 1:a.depthFunc(519);break;case 2:a.depthFunc(513);break;case 3:a.depthFunc(515);break;case 4:a.depthFunc(514);break;case 5:a.depthFunc(518);break;case 6:a.depthFunc(516);break;case 7:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);f=b}},setLocked:function(a){b=a},setClear:function(b){g!==b&&(a.clearDepth(b),g=b)},reset:function(){b=!1,e=null,f=null,g=null}}},g=new function(){var b=!1,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null;return{setTest:function(a){b||(a?c(2960):d(2960))},setMask:function(c){e===c||b||(a.stencilMask(c),e=c)},setFunc:function(b,c,d){f===b&&g===c&&h===d||(a.stencilFunc(b,c,d),f=b,g=c,h=d)},setOp:function(b,c,d){i===b&&j===c&&k===d||(a.stencilOp(b,c,d),i=b,j=c,k=d)},setLocked:function(a){b=a},setClear:function(b){l!==b&&(a.clearStencil(b),l=b)},reset:function(){b=!1,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null}}},j={},I=null,l=null,n=null,k=null,o=null,p=null,i=null,s=null,y=null,u=!1,F=null,E=null,C=null,D=null,A=null,T=a.getParameter(35661),H=!1,x=0,m=a.getParameter(7938),e,v,N,M,J,h,B,r;-1!==m.indexOf("WebGL")?(x=parseFloat(/^WebGL (\d)/.exec(m)[1]),H=x>=1):-1!==m.indexOf("OpenGL ES")&&(x=parseFloat(/^OpenGL ES (\d)/.exec(m)[1]),H=x>=2),e=null,v={},N=new q,M=new q;function L(b,e,f){var g=new Uint8Array(4),d=a.createTexture(),c;a.bindTexture(b,d),a.texParameteri(b,10241,9728),a.texParameteri(b,10240,9728);for(c=0;c<f;c++)a.texImage2D(e+c,0,6408,1,1,0,6408,5121,g);return d}J={};function c(b){!0!==j[b]&&(a.enable(b),j[b]=!0)}function d(b){!1!==j[b]&&(a.disable(b),j[b]=!1)}J[3553]=L(3553,3553,1),J[34067]=L(34067,34069,6),t.setClear(0,0,0,1),f.setClear(1),g.setClear(0),c(2929),f.setFunc(3),G(!1),O(1),c(2884),w(0),h=((z={})[100]=32774,z[101]=32778,z[102]=32779,z),Q?(h[103]=32775,h[104]=32776):(B=S.get("EXT_blend_minmax"),null!==B&&(h[103]=B.MIN_EXT,h[104]=B.MAX_EXT)),r=((b={})[200]=0,b[201]=1,b[202]=768,b[204]=770,b[210]=776,b[208]=774,b[206]=772,b[203]=769,b[205]=771,b[209]=775,b[207]=773,b);function w(b,j,m,q,e,f,g,t){if(0!==b){if(l||(c(3042),l=!0),5===b)e=e||j,f=f||m,g=g||q,j===k&&e===i||(a.blendEquationSeparate(h[j],h[e]),k=j,i=e),m===o&&q===p&&f===s&&g===y||(a.blendFuncSeparate(r[m],r[q],r[f],r[g]),o=m,p=q,s=f,y=g),n=b,u=null;else if(b!==n||t!==u){if(k===bA&&i===bA||(a.blendEquation(32774),k=bA,i=bA),t)switch(b){case 1:a.blendFuncSeparate(1,771,1,771);break;case 2:a.blendFunc(1,1);break;case 3:a.blendFuncSeparate(0,0,769,771);break;case 4:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}else switch(b){case 1:a.blendFuncSeparate(770,771,1,771);break;case 2:a.blendFunc(770,1);break;case 3:a.blendFunc(0,769);break;case 4:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",b)}o=null,p=null,s=null,y=null,n=b,u=t}}else l&&(d(3042),l=!1)}function G(b){F!==b&&(b?a.frontFace(2304):a.frontFace(2305),F=b)}function O(b){0!==b?(c(2884),b!==E&&(1===b?a.cullFace(1029):2===b?a.cullFace(1028):a.cullFace(1032))):d(2884),E=b}function P(f,b,e){f?(c(32823),D===b&&A===e||(a.polygonOffset(b,e),D=b,A=e)):d(32823)}function K(b){void 0===b&&(b=33984+T-1),e!==b&&(a.activeTexture(b),e=b)}return{buffers:{color:t,depth:f,stencil:g},enable:c,disable:d,useProgram:function(b){return I!==b&&(a.useProgram(b),I=b,!0)},setBlending:w,setMaterial:function(a,h){var b,e;2===a.side?d(2884):c(2884),b=1===a.side,h&&(b=!b),G(b),1===a.blending&&!1===a.transparent?w(0):w(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha,a.premultipliedAlpha),f.setFunc(a.depthFunc),f.setTest(a.depthTest),f.setMask(a.depthWrite),t.setMask(a.colorWrite),e=a.stencilWrite,g.setTest(e),e&&(g.setMask(a.stencilWriteMask),g.setFunc(a.stencilFunc,a.stencilRef,a.stencilFuncMask),g.setOp(a.stencilFail,a.stencilZFail,a.stencilZPass)),P(a.polygonOffset,a.polygonOffsetFactor,a.polygonOffsetUnits)},setFlipSided:G,setCullFace:O,setLineWidth:function(b){b!==C&&(H&&a.lineWidth(b),C=b)},setPolygonOffset:P,setScissorTest:function(a){a?c(3089):d(3089)},activeTexture:K,bindTexture:function(c,d){null===e&&K();var b=v[e];void 0===b&&(b={type:void 0,texture:void 0},v[e]=b),b.type===c&&b.texture===d||(a.bindTexture(c,d||J[c]),b.type=c,b.texture=d)},unbindTexture:function(){var b=v[e];void 0!==b&&void 0!==b.type&&(a.bindTexture(b.type,null),b.type=void 0,b.texture=void 0)},compressedTexImage2D:function(){try{a.compressedTexImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texImage2D:function(){try{a.texImage2D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},texImage3D:function(){try{a.texImage3D.apply(a,arguments)}catch(a){console.error("THREE.WebGLState:",a)}},scissor:function(b){!1===N.equals(b)&&(a.scissor(b.x,b.y,b.z,b.w),N.copy(b))},viewport:function(b){!1===M.equals(b)&&(a.viewport(b.x,b.y,b.z,b.w),M.copy(b))},reset:function(){j={},e=null,v={},I=null,l=null,n=null,k=null,o=null,p=null,i=null,s=null,y=null,u=!1,F=null,E=null,C=null,D=null,A=null,t.reset(),f.reset(),g.reset()}}}function kX(a,p,b,c,g,e,j){var o,f,v,d=g.isWebGL2,E=g.maxTextures,R=g.maxCubemapSize,Q=g.maxTextureSize,P=g.maxSamples,w=new WeakMap,K=!1,r,t,H,N,y;try{K="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(a){}function I(a,b){return K?new OffscreenCanvas(a,b):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function G(a,h,i,f){var e=1,g,c,b,d;return(a.width>f||a.height>f)&&(e=f/Math.max(a.width,a.height)),e<1||!0===h?"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?(g=h?l.floorPowerOfTwo:Math.floor,c=g(e*a.width),b=g(e*a.height),void 0===v&&(v=I(c,b)),d=i?I(c,b):v,d.width=c,d.height=b,d.getContext("2d").drawImage(a,0,0,c,b),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+a.width+"x"+a.height+") to ("+c+"x"+b+")."),d):("data"in a&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+a.width+"x"+a.height+")."),a):a}function h(a){return l.isPowerOfTwo(a.width)&&l.isPowerOfTwo(a.height)}function m(a,b){return a.generateMipmaps&&b&&a.minFilter!==C&&a.minFilter!==D}function k(b,d,e,f){a.generateMipmap(b),c.get(d).__maxMipLevel=Math.log(Math.max(e,f))*Math.LOG2E}function i(f,e,c){if(!1===d)return e;if(null!==f){if(void 0!==a[f])return a[f];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+f+"'")}var b=e;return 6403===e&&(5126===c&&(b=33326),5131===c&&(b=33325),5121===c&&(b=33321)),6407===e&&(5126===c&&(b=34837),5131===c&&(b=34843),5121===c&&(b=32849)),6408===e&&(5126===c&&(b=34836),5131===c&&(b=34842),5121===c&&(b=32856)),33325!==b&&33326!==b&&34842!==b&&34836!==b||p.get("EXT_color_buffer_float"),b}function B(a){return a===C||a===fz||a===fy?9728:9729}function z(d){var b=d.target;b.removeEventListener("dispose",z),function(b){var d=c.get(b);if(void 0===d.__webglInit)return;a.deleteTexture(d.__webglTexture),c.remove(b)}(b),b.isVideoTexture&&w.delete(b),j.memory.textures--}function A(d){var b=d.target;b.removeEventListener("dispose",A),function(d){var b=c.get(d),f=c.get(d.texture),e;if(!d)return;if(void 0!==f.__webglTexture&&a.deleteTexture(f.__webglTexture),d.depthTexture&&d.depthTexture.dispose(),d.isWebGLCubeRenderTarget)for(e=0;e<6;e++)a.deleteFramebuffer(b.__webglFramebuffer[e]),b.__webglDepthbuffer&&a.deleteRenderbuffer(b.__webglDepthbuffer[e]);else a.deleteFramebuffer(b.__webglFramebuffer),b.__webglDepthbuffer&&a.deleteRenderbuffer(b.__webglDepthbuffer),b.__webglMultisampledFramebuffer&&a.deleteFramebuffer(b.__webglMultisampledFramebuffer),b.__webglColorRenderbuffer&&a.deleteRenderbuffer(b.__webglColorRenderbuffer),b.__webglDepthRenderbuffer&&a.deleteRenderbuffer(b.__webglDepthRenderbuffer);c.remove(d.texture),c.remove(d)}(b),j.memory.textures--}r=0;function u(a,e){var d=c.get(a),f;if(a.isVideoTexture&&function(a){var b=j.render.frame;w.get(a)!==b&&(w.set(a,b),a.update())}(a),a.version>0&&d.__version!==a.version)if(f=a.image,void 0===f)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==f.complete)return void x(d,a,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}b.activeTexture(33984+e),b.bindTexture(3553,d.__webglTexture)}function F(f,j){var g=c.get(f);f.version>0&&g.__version!==f.version?function(w,c,D){var B,y,j,o,g,x,A,l,p,n,t,s,r,f,u,z,v,C;if(6!==c.image.length)return;J(w,c),b.activeTexture(33984+D),b.bindTexture(34067,w.__webglTexture),a.pixelStorei(37440,c.flipY),a.pixelStorei(37441,c.premultiplyAlpha),a.pixelStorei(3317,c.unpackAlignment);for(B=c&&(c.isCompressedTexture||c.image[0].isCompressedTexture),y=c.image[0]&&c.image[0].isDataTexture,j=[],o=0;o<6;o++)j[o]=B||y?y?c.image[o].image:c.image[o]:G(c.image[o],!1,!0,R);if(x=j[0],A=h(x)||d,l=e.convert(c.format),p=e.convert(c.type),n=i(c.internalFormat,l,p),q(34067,c,A),B){for(t=0;t<6;t++){g=j[t].mipmaps;for(s=0;s<g.length;s++)r=g[s],c.format!==Y&&c.format!==aK?null!==l?b.compressedTexImage2D(34069+t,s,n,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):b.texImage2D(34069+t,s,n,r.width,r.height,0,l,p,r.data)}w.__maxMipLevel=g.length-1}else{g=c.mipmaps;for(f=0;f<6;f++)if(y){b.texImage2D(34069+f,0,n,j[f].width,j[f].height,0,l,p,j[f].data);for(u=0;u<g.length;u++)z=g[u].image[f].image,b.texImage2D(34069+f,u+1,n,z.width,z.height,0,l,p,z.data)}else{b.texImage2D(34069+f,0,n,l,p,j[f]);for(v=0;v<g.length;v++)C=g[v],b.texImage2D(34069+f,v+1,n,l,p,C.image[f])}w.__maxMipLevel=g.length}m(c,A)&&k(34067,c,x.width,x.height),w.__version=c.version,c.onUpdate&&c.onUpdate(c)}(g,f,j):(b.activeTexture(33984+j),b.bindTexture(34067,g.__webglTexture))}t=((o={})[1e3]=10497,o[1001]=33071,o[1002]=33648,o),H=((f={})[1003]=9728,f[1004]=9984,f[1005]=9986,f[1006]=9729,f[1007]=9985,f[1008]=9987,f);function q(e,b,h){h?(a.texParameteri(e,10242,t[b.wrapS]),a.texParameteri(e,10243,t[b.wrapT]),32879!==e&&35866!==e||a.texParameteri(e,32882,t[b.wrapR]),a.texParameteri(e,10240,H[b.magFilter]),a.texParameteri(e,10241,H[b.minFilter])):(a.texParameteri(e,10242,33071),a.texParameteri(e,10243,33071),32879!==e&&35866!==e||a.texParameteri(e,32882,33071),b.wrapS===L&&b.wrapT===L||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(e,10240,B(b.magFilter)),a.texParameteri(e,10241,B(b.minFilter)),b.minFilter!==C&&b.minFilter!==D&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var f=p.get("EXT_texture_filter_anisotropic");if(f){if(b.type===aw&&null===p.get("OES_texture_float_linear"))return;if(b.type===cr&&null===(d||p.get("OES_texture_half_float_linear")))return;(b.anisotropy>1||c.get(b).__currentAnisotropy)&&(a.texParameterf(e,f.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,g.getMaxAnisotropy())),c.get(b).__currentAnisotropy=b.anisotropy)}}function J(b,c){void 0===b.__webglInit&&(b.__webglInit=!0,c.addEventListener("dispose",z),b.__webglTexture=a.createTexture(),j.memory.textures++)}function x(p,c,x){var s=3553,j,w,f,u,o,n,g,l,t,y,r,z,v,A;if(c.isDataTexture2DArray&&(s=35866),c.isDataTexture3D&&(s=32879),J(p,c),b.activeTexture(33984+x),b.bindTexture(s,p.__webglTexture),a.pixelStorei(37440,c.flipY),a.pixelStorei(37441,c.premultiplyAlpha),a.pixelStorei(3317,c.unpackAlignment),w=function(a){return!d&&(a.wrapS!==L||a.wrapT!==L||a.minFilter!==C&&a.minFilter!==D)}(c)&&!1===h(c.image),f=G(c.image,w,!1,Q),u=h(f)||d,o=e.convert(c.format),n=e.convert(c.type),g=i(c.internalFormat,o,n),q(s,c,u),l=c.mipmaps,c.isDepthTexture)g=6402,d?g=c.type===aw?36012:c.type===cs?33190:c.type===cd?35056:33189:c.type===aw&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),c.format===bi&&6402===g&&c.type!==ct&&c.type!==cs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),c.type=ct,n=e.convert(c.type)),c.format===bX&&6402===g&&(g=34041,c.type!==cd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),c.type=cd,n=e.convert(c.type))),b.texImage2D(3553,0,g,f.width,f.height,0,o,n,null);else if(c.isDataTexture)if(l.length>0&&u){for(t=0,y=l.length;t<y;t++)j=l[t],b.texImage2D(3553,t,g,j.width,j.height,0,o,n,j.data);c.generateMipmaps=!1,p.__maxMipLevel=l.length-1}else b.texImage2D(3553,0,g,f.width,f.height,0,o,n,f.data),p.__maxMipLevel=0;else if(c.isCompressedTexture){for(r=0,z=l.length;r<z;r++)j=l[r],c.format!==Y&&c.format!==aK?null!==o?b.compressedTexImage2D(3553,r,g,j.width,j.height,0,j.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):b.texImage2D(3553,r,g,j.width,j.height,0,o,n,j.data);p.__maxMipLevel=l.length-1}else if(c.isDataTexture2DArray)b.texImage3D(35866,0,g,f.width,f.height,f.depth,0,o,n,f.data),p.__maxMipLevel=0;else if(c.isDataTexture3D)b.texImage3D(32879,0,g,f.width,f.height,f.depth,0,o,n,f.data),p.__maxMipLevel=0;else if(l.length>0&&u){for(v=0,A=l.length;v<A;v++)j=l[v],b.texImage2D(3553,v,g,o,n,j);c.generateMipmaps=!1,p.__maxMipLevel=l.length-1}else b.texImage2D(3553,0,g,o,n,f),p.__maxMipLevel=0;m(c,u)&&k(s,c,f.width,f.height),p.__version=c.version,c.onUpdate&&c.onUpdate(c)}function M(j,d,k,f){var g=e.convert(d.texture.format),h=e.convert(d.texture.type),l=i(d.texture.internalFormat,g,h);b.texImage2D(f,0,l,d.width,d.height,0,g,h,null),a.bindFramebuffer(36160,j),a.framebufferTexture2D(36160,k,f,c.get(d.texture).__webglTexture,0),a.bindFramebuffer(36160,null)}function s(f,b,g){var c,d,j,k,l,m,h,o;a.bindRenderbuffer(36161,f),b.depthBuffer&&!b.stencilBuffer?(c=33189,g?(d=b.depthTexture,d&&d.isDepthTexture&&(d.type===aw?c=36012:d.type===cs&&(c=33190)),j=n(b),a.renderbufferStorageMultisample(36161,j,c,b.width,b.height)):a.renderbufferStorage(36161,c,b.width,b.height),a.framebufferRenderbuffer(36160,36096,36161,f)):b.depthBuffer&&b.stencilBuffer?(g?(k=n(b),a.renderbufferStorageMultisample(36161,k,35056,b.width,b.height)):a.renderbufferStorage(36161,34041,b.width,b.height),a.framebufferRenderbuffer(36160,33306,36161,f)):(l=e.convert(b.texture.format),m=e.convert(b.texture.type),h=i(b.texture.internalFormat,l,m),g?(o=n(b),a.renderbufferStorageMultisample(36161,o,h,b.width,b.height)):a.renderbufferStorage(36161,h,b.width,b.height)),a.bindRenderbuffer(36161,null)}function O(d){var b=c.get(d),f=!0===d.isWebGLCubeRenderTarget,e;if(d.depthTexture){if(f)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,b){if(b&&b.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(a.bindFramebuffer(36160,e),!b.depthTexture||!b.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");c.get(b.depthTexture).__webglTexture&&b.depthTexture.image.width===b.width&&b.depthTexture.image.height===b.height||(b.depthTexture.image.width=b.width,b.depthTexture.image.height=b.height,b.depthTexture.needsUpdate=!0),u(b.depthTexture,0);var d=c.get(b.depthTexture).__webglTexture;if(b.depthTexture.format===bi)a.framebufferTexture2D(36160,36096,3553,d,0);else{if(b.depthTexture.format!==bX)throw new Error("Unknown depthTexture format");a.framebufferTexture2D(36160,33306,3553,d,0)}}(b.__webglFramebuffer,d)}else if(f){b.__webglDepthbuffer=[];for(e=0;e<6;e++)a.bindFramebuffer(36160,b.__webglFramebuffer[e]),b.__webglDepthbuffer[e]=a.createRenderbuffer(),s(b.__webglDepthbuffer[e],d,!1)}else a.bindFramebuffer(36160,b.__webglFramebuffer),b.__webglDepthbuffer=a.createRenderbuffer(),s(b.__webglDepthbuffer,d,!1);a.bindFramebuffer(36160,null)}function n(a){return d&&a.isWebGLMultisampleRenderTarget?Math.min(P,a.samples):0}N=!1,y=!1,this.allocateTextureUnit=function(){var a=r;return a>=E&&console.warn("THREE.WebGLTextures: Trying to use "+a+" texture units while this GPU supports only "+E),r+=1,a},this.resetTextureUnits=function(){r=0},this.setTexture2D=u,this.setTexture2DArray=function(a,e){var d=c.get(a);a.version>0&&d.__version!==a.version?x(d,a,e):(b.activeTexture(33984+e),b.bindTexture(35866,d.__webglTexture))},this.setTexture3D=function(a,e){var d=c.get(a);a.version>0&&d.__version!==a.version?x(d,a,e):(b.activeTexture(33984+e),b.bindTexture(32879,d.__webglTexture))},this.setTextureCube=F,this.setupRenderTarget=function(f){var g=c.get(f),p=c.get(f.texture),t,u,l,r,v,w,x,y,o;if(f.addEventListener("dispose",A),p.__webglTexture=a.createTexture(),j.memory.textures++,t=!0===f.isWebGLCubeRenderTarget,u=!0===f.isWebGLMultisampleRenderTarget,l=h(f)||d,!d||f.texture.format!==aK||f.texture.type!==aw&&f.texture.type!==cr||(f.texture.format=Y,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),t){g.__webglFramebuffer=[];for(r=0;r<6;r++)g.__webglFramebuffer[r]=a.createFramebuffer()}else g.__webglFramebuffer=a.createFramebuffer(),u&&(d?(g.__webglMultisampledFramebuffer=a.createFramebuffer(),g.__webglColorRenderbuffer=a.createRenderbuffer(),a.bindRenderbuffer(36161,g.__webglColorRenderbuffer),v=e.convert(f.texture.format),w=e.convert(f.texture.type),x=i(f.texture.internalFormat,v,w),y=n(f),a.renderbufferStorageMultisample(36161,y,x,f.width,f.height),a.bindFramebuffer(36160,g.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064,36161,g.__webglColorRenderbuffer),a.bindRenderbuffer(36161,null),f.depthBuffer&&(g.__webglDepthRenderbuffer=a.createRenderbuffer(),s(g.__webglDepthRenderbuffer,f,!0)),a.bindFramebuffer(36160,null)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."));if(t){b.bindTexture(34067,p.__webglTexture),q(34067,f.texture,l);for(o=0;o<6;o++)M(g.__webglFramebuffer[o],f,36064,34069+o);m(f.texture,l)&&k(34067,f.texture,f.width,f.height),b.bindTexture(34067,null)}else b.bindTexture(3553,p.__webglTexture),q(3553,f.texture,l),M(g.__webglFramebuffer,f,36064,3553),m(f.texture,l)&&k(3553,f.texture,f.width,f.height),b.bindTexture(3553,null);f.depthBuffer&&O(f)},this.updateRenderTargetMipmap=function(a){var e=a.texture,f,g;m(e,h(a)||d)&&(f=a.isWebGLCubeRenderTarget?34067:3553,g=c.get(e).__webglTexture,b.bindTexture(f,g),k(f,e,a.width,a.height),b.bindTexture(f,null))},this.updateMultisampleRenderTarget=function(b){var e,g,h,f;b.isWebGLMultisampleRenderTarget&&(d?(e=c.get(b),a.bindFramebuffer(36008,e.__webglMultisampledFramebuffer),a.bindFramebuffer(36009,e.__webglFramebuffer),g=b.width,h=b.height,f=16384,b.depthBuffer&&(f|=256),b.stencilBuffer&&(f|=1024),a.blitFramebuffer(0,0,g,h,0,0,g,h,f,9728),a.bindFramebuffer(36160,e.__webglMultisampledFramebuffer)):console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2."))},this.safeSetTexture2D=function(a,b){a&&a.isWebGLRenderTarget&&(!1===N&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),N=!0),a=a.texture),u(a,b)},this.safeSetTextureCube=function(a,b){a&&a.isWebGLCubeRenderTarget&&(!1===y&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),y=!0),a=a.texture),F(a,b)}}function ii(d,a,c){var b=c.isWebGL2;return{convert:function(c){var d;if(c===bT)return 5121;if(1017===c)return 32819;if(1018===c)return 32820;if(1019===c)return 33635;if(1010===c)return 5120;if(1011===c)return 5122;if(c===ct)return 5123;if(1013===c)return 5124;if(c===cs)return 5125;if(c===aw)return 5126;if(c===cr)return b?5131:null!==(d=a.get("OES_texture_half_float"))?d.HALF_FLOAT_OES:null;if(1021===c)return 6406;if(c===aK)return 6407;if(c===Y)return 6408;if(1024===c)return 6409;if(1025===c)return 6410;if(c===bi)return 6402;if(c===bX)return 34041;if(1028===c)return 6403;if(1029===c)return 36244;if(1030===c)return 33319;if(1031===c)return 33320;if(1032===c)return 36248;if(1033===c)return 36249;if(c===fx||c===fw||c===fv||c===fu){if(null===(d=a.get("WEBGL_compressed_texture_s3tc")))return null;if(c===fx)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===fw)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===fv)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===fu)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(c===ft||c===fs||c===fr||c===fq){if(null===(d=a.get("WEBGL_compressed_texture_pvrtc")))return null;if(c===ft)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===fs)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===fr)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===fq)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===c)return null!==(d=a.get("WEBGL_compressed_texture_etc1"))?d.COMPRESSED_RGB_ETC1_WEBGL:null;if((c===fk||c===fh)&&null!==(d=a.get("WEBGL_compressed_texture_etc"))){if(c===fk)return d.COMPRESSED_RGB8_ETC2;if(c===fh)return d.COMPRESSED_RGBA8_ETC2_EAC}return 37808===c||37809===c||37810===c||37811===c||37812===c||37813===c||37814===c||37815===c||37816===c||37817===c||37818===c||37819===c||37820===c||37821===c||37840===c||37841===c||37842===c||37843===c||37844===c||37845===c||37846===c||37847===c||37848===c||37849===c||37850===c||37851===c||37852===c||37853===c?null!==(d=a.get("WEBGL_compressed_texture_astc"))?c:null:36492===c?null!==(d=a.get("EXT_texture_compression_bptc"))?c:null:c===cd?b?34042:null!==(d=a.get("WEBGL_depth_texture"))?d.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function fZ(a){void 0===a&&(a=[]),A.call(this),this.cameras=a}function br(){g.call(this),this.type="Group"}function dK(){this._targetRay=null,this._grip=null,this._hand=null}function ih(k,n){var i=this,c=null,p=1,j=null,u="local-floor",t=null,d=[],f=new Map,e=new A,h,z,a,r,s,v,w,m,l;e.layers.enable(1),e.viewport=new q,h=new A,h.layers.enable(2),h.viewport=new q,z=[e,h],a=new fZ,a.layers.enable(1),a.layers.enable(2),r=null,s=null;function g(a){var b=f.get(a.inputSource);b&&b.dispatchEvent({type:a.type,data:a.inputSource})}function x(){f.forEach(function(a,b){a.disconnect(b)}),f.clear(),k.setFramebuffer(null),k.setRenderTarget(k.getRenderTarget()),l.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function y(a){for(var l=c.inputSources,b=0,e,g,j,h,i,k;b<d.length;b++)f.set(l[b],d[b]);for(e=0;e<a.removed.length;e++)g=a.removed[e],j=f.get(g),j&&(j.dispatchEvent({type:"disconnected",data:g}),f.delete(g));for(h=0;h<a.added.length;h++)i=a.added[h],k=f.get(i),k&&k.dispatchEvent({type:"connected",data:i})}this.enabled=!1,this.isPresenting=!1,this.getController=function(b){var a=d[b];return void 0===a&&(a=new dK,d[b]=a),a.getTargetRaySpace()},this.getControllerGrip=function(b){var a=d[b];return void 0===a&&(a=new dK,d[b]=a),a.getGripSpace()},this.getHand=function(b){var a=d[b];return void 0===a&&(a=new dK,d[b]=a),a.getHandSpace()},this.setFramebufferScaleFactor=function(a){p=a,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(a){u=a,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return j},this.getSession=function(){return c},this.setSession=function(){var a,b=(a=regeneratorRuntime.mark(function e(f){var a,b,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(c=f)){e.next=24;break}if(c.addEventListener("select",g),c.addEventListener("selectstart",g),c.addEventListener("selectend",g),c.addEventListener("squeeze",g),c.addEventListener("squeezestart",g),c.addEventListener("squeezeend",g),c.addEventListener("end",x),c.addEventListener("inputsourceschange",y),!0===(a=n.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,n.makeXRCompatible();case 14:return b={antialias:a.antialias,alpha:a.alpha,depth:a.depth,stencil:a.stencil,framebufferScaleFactor:p},d=new XRWebGLLayer(c,n,b),c.updateRenderState({baseLayer:d}),e.next=19,c.requestReferenceSpace(u);case 19:j=e.sent,l.setContext(c),l.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}},e)}),function(){var b=this,c=arguments;return new Promise(function(e,f){var g=a.apply(b,c);function d(a){im(g,e,f,d,h,"next",a)}function h(a){im(g,e,f,d,h,"throw",a)}d(void 0)})});return function(a){return b.apply(this,arguments)}}(),v=new b,w=new b;function o(a,b){null===b?a.matrixWorld.copy(a.matrix):a.matrixWorld.multiplyMatrices(b.matrixWorld,a.matrix),a.matrixWorldInverse.copy(a.matrixWorld).invert()}this.getCamera=function(b){var i,d,f,j,g,k;a.near=h.near=e.near=b.near,a.far=h.far=e.far=b.far,r===a.near&&s===a.far||(c.updateRenderState({depthNear:a.near,depthFar:a.far}),r=a.near,s=a.far),i=b.parent,d=a.cameras,o(a,i);for(f=0;f<d.length;f++)o(d[f],i);b.matrixWorld.copy(a.matrixWorld);for(j=b.children,g=0,k=j.length;g<k;g++)j[g].updateMatrixWorld(!0);return 2===d.length?function(a,j,r){var k,b,l,g,d,q,p,i,m,o,n,c,f,h,e,s,t,u,x;v.setFromMatrixPosition(j.matrixWorld),w.setFromMatrixPosition(r.matrixWorld),k=v.distanceTo(w),b=j.projectionMatrix.elements,l=r.projectionMatrix.elements,g=b[14]/(b[10]-1),d=b[14]/(b[10]+1),q=(b[9]+1)/b[5],p=(b[9]-1)/b[5],i=(b[8]-1)/b[0],m=(l[8]+1)/l[0],o=g*i,n=g*m,c=k/(-i+m),f=c*-i,j.matrixWorld.decompose(a.position,a.quaternion,a.scale),a.translateX(f),a.translateZ(c),a.matrixWorld.compose(a.position,a.quaternion,a.scale),a.matrixWorldInverse.copy(a.matrixWorld).invert(),h=g+c,e=d+c,s=o-f,t=n+(k-f),u=q*d/e*h,x=p*d/e*h,a.projectionMatrix.makePerspective(s,t,u,x,h,e)}(a,e,h):a.projectionMatrix.copy(e.projectionMatrix),a},m=null,l=new is,l.setAnimationLoop(function(s,o){var i,l,n,e,h,g,b,q,f,r,p;if(null!==(t=o.getViewerPose(j))){i=t.views,l=c.renderState.baseLayer,k.setFramebuffer(l.framebuffer),n=!1,i.length!==a.cameras.length&&(a.cameras.length=0,n=!0);for(e=0;e<i.length;e++)h=i[e],g=l.getViewport(h),b=z[e],b.matrix.fromArray(h.transform.matrix),b.projectionMatrix.fromArray(h.projectionMatrix),b.viewport.set(g.x,g.y,g.width,g.height),0===e&&a.matrix.copy(b.matrix),!0===n&&a.cameras.push(b)}for(q=c.inputSources,f=0;f<d.length;f++)r=d[f],p=q[f],r.update(p,o,j);m&&m(s,o)}),this.setAnimationLoop=function(a){m=a},this.dispose=function(){}}function k_(b){function a(d,a){var c,e,f,g;d.opacity.value=a.opacity,a.color&&d.diffuse.value.copy(a.color),a.emissive&&d.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),a.map&&(d.map.value=a.map),a.alphaMap&&(d.alphaMap.value=a.alphaMap),a.specularMap&&(d.specularMap.value=a.specularMap),f=b.get(a).envMap,f&&(d.envMap.value=f,d.flipEnvMap.value=f.isCubeTexture&&f._needsFlipEnvMap?-1:1,d.reflectivity.value=a.reflectivity,d.refractionRatio.value=a.refractionRatio,g=b.get(f).__maxMipLevel,void 0!==g&&(d.maxMipLevel.value=g)),a.lightMap&&(d.lightMap.value=a.lightMap,d.lightMapIntensity.value=a.lightMapIntensity),a.aoMap&&(d.aoMap.value=a.aoMap,d.aoMapIntensity.value=a.aoMapIntensity),a.map?c=a.map:a.specularMap?c=a.specularMap:a.displacementMap?c=a.displacementMap:a.normalMap?c=a.normalMap:a.bumpMap?c=a.bumpMap:a.roughnessMap?c=a.roughnessMap:a.metalnessMap?c=a.metalnessMap:a.alphaMap?c=a.alphaMap:a.emissiveMap?c=a.emissiveMap:a.clearcoatMap?c=a.clearcoatMap:a.clearcoatNormalMap?c=a.clearcoatNormalMap:a.clearcoatRoughnessMap&&(c=a.clearcoatRoughnessMap),void 0!==c&&(c.isWebGLRenderTarget&&(c=c.texture),!0===c.matrixAutoUpdate&&c.updateMatrix(),d.uvTransform.value.copy(c.matrix)),a.aoMap?e=a.aoMap:a.lightMap&&(e=a.lightMap),void 0!==e&&(e.isWebGLRenderTarget&&(e=e.texture),!0===e.matrixAutoUpdate&&e.updateMatrix(),d.uv2Transform.value.copy(e.matrix))}function c(c,a){c.roughness.value=a.roughness,c.metalness.value=a.metalness,a.roughnessMap&&(c.roughnessMap.value=a.roughnessMap),a.metalnessMap&&(c.metalnessMap.value=a.metalnessMap),a.emissiveMap&&(c.emissiveMap.value=a.emissiveMap),a.bumpMap&&(c.bumpMap.value=a.bumpMap,c.bumpScale.value=a.bumpScale,1===a.side&&(c.bumpScale.value*=-1)),a.normalMap&&(c.normalMap.value=a.normalMap,c.normalScale.value.copy(a.normalScale),1===a.side&&c.normalScale.value.negate()),a.displacementMap&&(c.displacementMap.value=a.displacementMap,c.displacementScale.value=a.displacementScale,c.displacementBias.value=a.displacementBias),b.get(a).envMap&&(c.envMapIntensity.value=a.envMapIntensity)}return{refreshFogUniforms:function(b,a){b.fogColor.value.copy(a.color),a.isFog?(b.fogNear.value=a.near,b.fogFar.value=a.far):a.isFogExp2&&(b.fogDensity.value=a.density)},refreshMaterialUniforms:function(d,b,e,f){b.isMeshBasicMaterial?a(d,b):b.isMeshLambertMaterial?(a(d,b),function(b,a){a.emissiveMap&&(b.emissiveMap.value=a.emissiveMap)}(d,b)):b.isMeshToonMaterial?(a(d,b),function(b,a){a.gradientMap&&(b.gradientMap.value=a.gradientMap),a.emissiveMap&&(b.emissiveMap.value=a.emissiveMap),a.bumpMap&&(b.bumpMap.value=a.bumpMap,b.bumpScale.value=a.bumpScale,1===a.side&&(b.bumpScale.value*=-1)),a.normalMap&&(b.normalMap.value=a.normalMap,b.normalScale.value.copy(a.normalScale),1===a.side&&b.normalScale.value.negate()),a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias)}(d,b)):b.isMeshPhongMaterial?(a(d,b),function(b,a){b.specular.value.copy(a.specular),b.shininess.value=Math.max(a.shininess,1e-4),a.emissiveMap&&(b.emissiveMap.value=a.emissiveMap),a.bumpMap&&(b.bumpMap.value=a.bumpMap,b.bumpScale.value=a.bumpScale,1===a.side&&(b.bumpScale.value*=-1)),a.normalMap&&(b.normalMap.value=a.normalMap,b.normalScale.value.copy(a.normalScale),1===a.side&&b.normalScale.value.negate()),a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias)}(d,b)):b.isMeshStandardMaterial?(a(d,b),b.isMeshPhysicalMaterial?function(b,a){c(b,a),b.reflectivity.value=a.reflectivity,b.clearcoat.value=a.clearcoat,b.clearcoatRoughness.value=a.clearcoatRoughness,a.sheen&&b.sheen.value.copy(a.sheen),a.clearcoatMap&&(b.clearcoatMap.value=a.clearcoatMap),a.clearcoatRoughnessMap&&(b.clearcoatRoughnessMap.value=a.clearcoatRoughnessMap),a.clearcoatNormalMap&&(b.clearcoatNormalScale.value.copy(a.clearcoatNormalScale),b.clearcoatNormalMap.value=a.clearcoatNormalMap,1===a.side&&b.clearcoatNormalScale.value.negate()),b.transmission.value=a.transmission,a.transmissionMap&&(b.transmissionMap.value=a.transmissionMap)}(d,b):c(d,b)):b.isMeshMatcapMaterial?(a(d,b),function(b,a){a.matcap&&(b.matcap.value=a.matcap),a.bumpMap&&(b.bumpMap.value=a.bumpMap,b.bumpScale.value=a.bumpScale,1===a.side&&(b.bumpScale.value*=-1)),a.normalMap&&(b.normalMap.value=a.normalMap,b.normalScale.value.copy(a.normalScale),1===a.side&&b.normalScale.value.negate()),a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias)}(d,b)):b.isMeshDepthMaterial?(a(d,b),function(b,a){a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias)}(d,b)):b.isMeshDistanceMaterial?(a(d,b),function(b,a){a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias),b.referencePosition.value.copy(a.referencePosition),b.nearDistance.value=a.nearDistance,b.farDistance.value=a.farDistance}(d,b)):b.isMeshNormalMaterial?(a(d,b),function(b,a){a.bumpMap&&(b.bumpMap.value=a.bumpMap,b.bumpScale.value=a.bumpScale,1===a.side&&(b.bumpScale.value*=-1)),a.normalMap&&(b.normalMap.value=a.normalMap,b.normalScale.value.copy(a.normalScale),1===a.side&&b.normalScale.value.negate()),a.displacementMap&&(b.displacementMap.value=a.displacementMap,b.displacementScale.value=a.displacementScale,b.displacementBias.value=a.displacementBias)}(d,b)):b.isLineBasicMaterial?(function(a,b){a.diffuse.value.copy(b.color),a.opacity.value=b.opacity}(d,b),b.isLineDashedMaterial&&function(b,a){b.dashSize.value=a.dashSize,b.totalSize.value=a.dashSize+a.gapSize,b.scale.value=a.scale}(d,b)):b.isPointsMaterial?function(b,a,d,e){b.diffuse.value.copy(a.color),b.opacity.value=a.opacity,b.size.value=a.size*d,b.scale.value=.5*e,a.map&&(b.map.value=a.map),a.alphaMap&&(b.alphaMap.value=a.alphaMap);var c;a.map?c=a.map:a.alphaMap&&(c=a.alphaMap),void 0!==c&&(!0===c.matrixAutoUpdate&&c.updateMatrix(),b.uvTransform.value.copy(c.matrix))}(d,b,e,f):b.isSpriteMaterial?function(b,a){b.diffuse.value.copy(a.color),b.opacity.value=a.opacity,b.rotation.value=a.rotation,a.map&&(b.map.value=a.map),a.alphaMap&&(b.alphaMap.value=a.alphaMap);var c;a.map?c=a.map:a.alphaMap&&(c=a.alphaMap),void 0!==c&&(!0===c.matrixAutoUpdate&&c.updateMatrix(),b.uvTransform.value.copy(c.matrix))}(d,b):b.isShadowMaterial?(d.color.value.copy(b.color),d.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}}}function dH(g){var ah,p=void 0!==(g=g||{}).canvas?g.canvas:((ah=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",ah),aE=void 0!==g.context?g.context:null,aD=void 0!==g.alpha&&g.alpha,aB=void 0===g.depth||g.depth,aJ=void 0===g.stencil||g.stencil,aF=void 0!==g.antialias&&g.antialias,ap=void 0===g.premultipliedAlpha||g.premultipliedAlpha,aG=void 0!==g.preserveDrawingBuffer&&g.preserveDrawingBuffer,aI=void 0!==g.powerPreference?g.powerPreference:"default",aH=void 0!==g.failIfMajorPerformanceCaveat&&g.failIfMajorPerformanceCaveat,r=null,k=null,H=[],f,$,_,aj,ai,u,S,P,G,B,L,V,C,A,m,au,ag,J,E,X,ac,Q,Z,N,z,U,h,i,d,v,j,t,I,O,ad,F,D,W,R,T,s,x,al,am,an,w,n,a,aC,aa,y,ay,ab,M;this.domElement=p,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=aR,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4,f=this,$=!1,_=null,aj=0,ai=0,u=null,S=null,P=-1,G=null,B=new q,L=new q,V=null,C=p.width,A=p.height,m=1,au=null,ag=null,J=new q(0,0,C,A),E=new q(0,0,C,A),X=!1,ac=new cF,Q=!1,Z=!1,N=new o,z=new b,U={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function af(){return null===u?m:1}a=aE;function ar(b,d){for(var a=0,e,c;a<b.length;a++)if(e=b[a],c=p.getContext(e,d),null!==c)return c;return null}try{if(aC={alpha:aD,depth:aB,stencil:aJ,antialias:aF,premultipliedAlpha:ap,preserveDrawingBuffer:aG,powerPreference:aI,failIfMajorPerformanceCaveat:aH},p.addEventListener("webglcontextlost",az,!1),p.addEventListener("webglcontextrestored",ae,!1),null===a)if(aa=["webgl2","webgl","experimental-webgl"],!0===f.isWebGL1Renderer&&aa.shift(),null===(a=ar(aa,aC)))throw ar(aa)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===a.getShaderPrecisionFormat&&(a.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(a){throw console.error("THREE.WebGLRenderer: "+a.message),a}function av(){h=new kE(a),i=new kx(a,h,g),h.init(i),w=new ii(a,h,i),(d=new kW(a,h,i)).scissor(L.copy(E).multiplyScalar(m).floor()),d.viewport(B.copy(J).multiplyScalar(m).floor()),v=new kI(a),j=new jZ,t=new kX(a,h,d,j,i,w,v),I=new kD(f),O=new kk(a,i),n=new kq(a,h,O,i),ad=new kG(a,O,v,n),F=new kN(a,ad,O,v),al=new kL(a),s=new ky(j),D=new jY(f,I,h,i,n,s),W=new k_(j),R=new kl(j),T=new kO(h,i),x=new kp(f,I,d,F,ap),am=new kv(a,h,v,i),an=new kH(a,h,v,i),v.programs=D.programs,f.capabilities=i,f.extensions=h,f.properties=j,f.renderLists=R,f.state=d,f.info=v}av(),y=new ih(f,a),this.xr=y,ay=new ik(f,F,i.maxTextureSize);function az(a){a.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$=!0}function ae(){console.log("THREE.WebGLRenderer: Context Restored."),$=!1,av()}function ax(b){var a=b.target;a.removeEventListener("dispose",ax),function(a){at(a),j.remove(a)}(a)}function at(b){var a=j.get(b).program;void 0!==a&&D.releaseProgram(a)}this.shadowMap=ay,this.getContext=function(){return a},this.getContextAttributes=function(){return a.getContextAttributes()},this.forceContextLoss=function(){var a=h.get("WEBGL_lose_context");a&&a.loseContext()},this.forceContextRestore=function(){var a=h.get("WEBGL_lose_context");a&&a.restoreContext()},this.getPixelRatio=function(){return m},this.setPixelRatio=function(a){void 0!==a&&(m=a,this.setSize(C,A,!1))},this.getSize=function(a){return void 0===a&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),a=new c),a.set(C,A)},this.setSize=function(a,b,c){y.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(C=a,A=b,p.width=Math.floor(a*m),p.height=Math.floor(b*m),!1!==c&&(p.style.width=a+"px",p.style.height=b+"px"),this.setViewport(0,0,a,b))},this.getDrawingBufferSize=function(a){return void 0===a&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),a=new c),a.set(C*m,A*m).floor()},this.setDrawingBufferSize=function(a,b,c){C=a,A=b,m=c,p.width=Math.floor(a*c),p.height=Math.floor(b*c),this.setViewport(0,0,a,b)},this.getCurrentViewport=function(a){return void 0===a&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),a=new q),a.copy(B)},this.getViewport=function(a){return a.copy(J)},this.setViewport=function(a,b,c,e){a.isVector4?J.set(a.x,a.y,a.z,a.w):J.set(a,b,c,e),d.viewport(B.copy(J).multiplyScalar(m).floor())},this.getScissor=function(a){return a.copy(E)},this.setScissor=function(a,b,c,e){a.isVector4?E.set(a.x,a.y,a.z,a.w):E.set(a,b,c,e),d.scissor(L.copy(E).multiplyScalar(m).floor())},this.getScissorTest=function(){return X},this.setScissorTest=function(a){d.setScissorTest(X=a)},this.setOpaqueSort=function(a){au=a},this.setTransparentSort=function(a){ag=a},this.getClearColor=function(a){return void 0===a&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),a=new e),a.copy(x.getClearColor())},this.setClearColor=function(){x.setClearColor.apply(x,arguments)},this.getClearAlpha=function(){return x.getClearAlpha()},this.setClearAlpha=function(){x.setClearAlpha.apply(x,arguments)},this.clear=function(c,d,e){var b=0;(void 0===c||c)&&(b|=16384),(void 0===d||d)&&(b|=256),(void 0===e||e)&&(b|=1024),a.clear(b)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){p.removeEventListener("webglcontextlost",az,!1),p.removeEventListener("webglcontextrestored",ae,!1),R.dispose(),T.dispose(),j.dispose(),I.dispose(),F.dispose(),n.dispose(),y.dispose(),M.stop()},this.renderBufferImmediate=function(b,e){var c,d;n.initAttributes(),c=j.get(b),b.hasPositions&&!c.position&&(c.position=a.createBuffer()),b.hasNormals&&!c.normal&&(c.normal=a.createBuffer()),b.hasUvs&&!c.uv&&(c.uv=a.createBuffer()),b.hasColors&&!c.color&&(c.color=a.createBuffer()),d=e.getAttributes(),b.hasPositions&&(a.bindBuffer(34962,c.position),a.bufferData(34962,b.positionArray,35048),n.enableAttribute(d.position),a.vertexAttribPointer(d.position,3,5126,!1,0,0)),b.hasNormals&&(a.bindBuffer(34962,c.normal),a.bufferData(34962,b.normalArray,35048),n.enableAttribute(d.normal),a.vertexAttribPointer(d.normal,3,5126,!1,0,0)),b.hasUvs&&(a.bindBuffer(34962,c.uv),a.bufferData(34962,b.uvArray,35048),n.enableAttribute(d.uv),a.vertexAttribPointer(d.uv,2,5126,!1,0,0)),b.hasColors&&(a.bindBuffer(34962,c.color),a.bufferData(34962,b.colorArray,35048),n.enableAttribute(d.color),a.vertexAttribPointer(d.color,3,5126,!1,0,0)),n.disableUnusedAttributes(),a.drawArrays(4,0,b.count),b.count=0},this.renderBufferDirect=function(y,p,c,e,a,l){var x,m,f,j,o,g,b,w,q,u,r,t,i,v,h,k,s;if(null===p&&(p=U),x=a.isMesh&&a.matrixWorld.determinant()<0,m=aA(y,p,e,a),d.setMaterial(e,x),f=c.index,j=c.attributes.position,null===f){if(void 0===j||0===j.count)return}else if(0===f.count)return;g=1,!0===e.wireframe&&(f=ad.getWireframeAttribute(c),g=2),(e.morphTargets||e.morphNormals)&&al.update(a,c,e,m),n.setup(a,e,m,c,f),b=am,null!==f&&(o=O.get(f),(b=an).setIndex(o)),w=null!==f?f.count:j.count,q=c.drawRange.start*g,u=c.drawRange.count*g,r=null!==l?l.start*g:0,t=null!==l?l.count*g:1/0,i=Math.max(q,r),v=Math.min(w,q+u,r+t)-1,h=Math.max(0,v-i+1),0!==h&&(a.isMesh?!0===e.wireframe?(d.setLineWidth(e.wireframeLinewidth*af()),b.setMode(1)):b.setMode(4):a.isLine?(k=e.linewidth,void 0===k&&(k=1),d.setLineWidth(k*af()),a.isLineSegments?b.setMode(1):a.isLineLoop?b.setMode(2):b.setMode(3)):a.isPoints?b.setMode(0):a.isSprite&&b.setMode(4),a.isInstancedMesh?b.renderInstances(i,h,a.count):c.isInstancedBufferGeometry?(s=Math.min(c.instanceCount,c._maxInstanceCount),b.renderInstances(i,h,s)):b.render(i,h))},this.compile=function(a,c){(k=T.get(a)).init(),a.traverseVisible(function(a){a.isLight&&a.layers.test(c.layers)&&(k.pushLight(a),a.castShadow&&k.pushShadow(a))}),k.setupLights();var b=new WeakMap;a.traverse(function(d){var c=d.material,e,f;if(c)if(Array.isArray(c))for(e=0;e<c.length;e++)f=c[e],!1===b.has(f)&&(K(f,a,d),b.set(f));else!1===b.has(c)&&(K(c,a,d),b.set(c))})},ab=null,M=new is;function aq(a,n,b,d){var p,j,g,c,i,f,o,m,h,l,e,q;if(!1!==a.visible){if(a.layers.test(n.layers))if(a.isGroup)b=a.renderOrder;else if(a.isLOD)!0===a.autoUpdate&&a.update(n);else if(a.isLight)k.pushLight(a),a.castShadow&&k.pushShadow(a);else if(a.isSprite)(!a.frustumCulled||ac.intersectsSprite(a))&&(d&&z.setFromMatrixPosition(a.matrixWorld).applyMatrix4(N),p=F.update(a),j=a.material,j.visible&&r.push(a,p,j,b,z.z,null));else if(a.isImmediateRenderObject)d&&z.setFromMatrixPosition(a.matrixWorld).applyMatrix4(N),r.push(a,null,a.material,b,z.z,null);else if((a.isMesh||a.isLine||a.isPoints)&&(a.isSkinnedMesh&&a.skeleton.frame!==v.render.frame&&(a.skeleton.update(),a.skeleton.frame=v.render.frame),!a.frustumCulled||ac.intersectsObject(a)))if(d&&z.setFromMatrixPosition(a.matrixWorld).applyMatrix4(N),g=F.update(a),c=a.material,Array.isArray(c))for(i=g.groups,f=0,o=i.length;f<o;f++)m=i[f],h=c[m.materialIndex],h&&h.visible&&r.push(a,g,h,b,z.z,m);else c.visible&&r.push(a,g,c,b,z.z,null);for(l=a.children,e=0,q=l.length;e<q;e++)aq(l[e],n,b,d)}}function ao(o,b,e){for(var n=!0===b.isScene?b.overrideMaterial:null,g=0,p=o.length,a,h,i,j,l,m,f,q,c;g<p;g++)if(a=o[g],h=a.object,i=a.geometry,j=null===n?a.material:n,l=a.group,e.isArrayCamera)for(m=e.cameras,f=0,q=m.length;f<q;f++)c=m[f],h.layers.test(c.layers)&&(d.viewport(B.copy(c.viewport)),k.setupLightsView(c),ak(h,b,c,i,j,l));else ak(h,b,e,i,j,l)}function ak(a,e,b,g,c,h){if(a.onBeforeRender(f,e,b,g,c,h),a.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,a.matrixWorld),a.normalMatrix.getNormalMatrix(a.modelViewMatrix),a.isImmediateRenderObject){var i=aA(b,e,c,a);d.setMaterial(c),n.reset(),function(a,b){a.render(function(a){f.renderBufferImmediate(a,b)})}(a,i)}else f.renderBufferDirect(b,e,g,c,a,h);a.onAfterRender(f,e,b,g,c,h)}function K(d,g,q){var c,a,o,l,e,m,h,i,b,p,n;if(!0!==g.isScene&&(g=U),c=j.get(d),a=k.state.lights,o=k.state.shadowsArray,l=a.state.version,e=D.getParameters(d,a.state,o,g,q),m=D.getProgramCacheKey(e),h=c.program,i=!0,c.environment=d.isMeshStandardMaterial?g.environment:null,c.fog=g.fog,c.envMap=I.get(d.envMap||c.environment),void 0===h)d.addEventListener("dispose",ax);else if(h.cacheKey!==m)at(d);else if(c.lightsStateVersion!==l)i=!1;else{if(void 0!==e.shaderID)return;i=!1}i&&(e.uniforms=D.getUniforms(d),d.onBeforeCompile(e,f),h=D.acquireProgram(e,m),c.program=h,c.uniforms=e.uniforms,c.outputEncoding=e.outputEncoding),b=c.uniforms,(d.isShaderMaterial||d.isRawShaderMaterial)&&!0!==d.clipping||(c.numClippingPlanes=s.numPlanes,c.numIntersection=s.numIntersection,b.clippingPlanes=s.uniform),c.needsLights=function(a){return a.isMeshLambertMaterial||a.isMeshToonMaterial||a.isMeshPhongMaterial||a.isMeshStandardMaterial||a.isShadowMaterial||a.isShaderMaterial&&!0===a.lights}(d),c.lightsStateVersion=l,c.needsLights&&(b.ambientLightColor.value=a.state.ambient,b.lightProbe.value=a.state.probe,b.directionalLights.value=a.state.directional,b.directionalLightShadows.value=a.state.directionalShadow,b.spotLights.value=a.state.spot,b.spotLightShadows.value=a.state.spotShadow,b.rectAreaLights.value=a.state.rectArea,b.ltc_1.value=a.state.rectAreaLTC1,b.ltc_2.value=a.state.rectAreaLTC2,b.pointLights.value=a.state.point,b.pointLightShadows.value=a.state.pointShadow,b.hemisphereLights.value=a.state.hemi,b.directionalShadowMap.value=a.state.directionalShadowMap,b.directionalShadowMatrix.value=a.state.directionalShadowMatrix,b.spotShadowMap.value=a.state.spotShadowMap,b.spotShadowMatrix.value=a.state.spotShadowMatrix,b.pointShadowMap.value=a.state.pointShadowMap,b.pointShadowMatrix.value=a.state.pointShadowMatrix),p=c.program.getUniforms(),n=a$.seqWithValue(p.seq,b),c.uniformsList=n}function aA(p,r,b,g){var C,F,J,H,c,N,M,o,h,D,v,y,B,e,w,E,n,L,q,x,O;return!0!==r.isScene&&(r=U),t.resetTextureUnits(),C=r.fog,F=b.isMeshStandardMaterial?r.environment:null,J=null===u?f.outputEncoding:u.texture.encoding,H=I.get(b.envMap||F),c=j.get(b),N=k.state.lights,!0===Q&&(!0===Z||p!==G)&&(M=p===G&&b.id===P,s.setState(b,p,M)),b.version===c.__version?b.fog&&c.fog!==C||c.environment!==F||c.needsLights&&c.lightsStateVersion!==N.state.version?K(b,r,g):void 0===c.numClippingPlanes||c.numClippingPlanes===s.numPlanes&&c.numIntersection===s.numIntersection?(c.outputEncoding!==J||c.envMap!==H)&&K(b,r,g):K(b,r,g):(K(b,r,g),c.__version=b.version),D=!1,v=!1,y=!1,B=c.program,e=B.getUniforms(),w=c.uniforms,(d.useProgram(B.program)&&(D=!0,v=!0,y=!0),b.id!==P&&(P=b.id,v=!0),D||G!==p)&&((e.setValue(a,"projectionMatrix",p.projectionMatrix),i.logarithmicDepthBuffer&&e.setValue(a,"logDepthBufFC",2/(Math.log(p.far+1)/Math.LN2)),G!==p&&(G=p,v=!0,y=!0),b.isShaderMaterial||b.isMeshPhongMaterial||b.isMeshToonMaterial||b.isMeshStandardMaterial||b.envMap)&&(E=e.map.cameraPosition,void 0!==E&&E.setValue(a,z.setFromMatrixPosition(p.matrixWorld))),(b.isMeshPhongMaterial||b.isMeshToonMaterial||b.isMeshLambertMaterial||b.isMeshBasicMaterial||b.isMeshStandardMaterial||b.isShaderMaterial)&&e.setValue(a,"isOrthographic",!0===p.isOrthographicCamera),(b.isMeshPhongMaterial||b.isMeshToonMaterial||b.isMeshLambertMaterial||b.isMeshBasicMaterial||b.isMeshStandardMaterial||b.isShaderMaterial||b.isShadowMaterial||b.skinning)&&e.setValue(a,"viewMatrix",p.matrixWorldInverse)),b.skinning&&(e.setOptional(a,g,"bindMatrix"),e.setOptional(a,g,"bindMatrixInverse"),n=g.skeleton,n&&(L=n.bones,i.floatVertexTextures?(null===n.boneTexture&&(q=Math.sqrt(4*L.length),q=l.ceilPowerOfTwo(q),q=Math.max(q,4),x=new Float32Array(q*q*4),x.set(n.boneMatrices),O=new aW(x,q,q,Y,aw),n.boneMatrices=x,n.boneTexture=O,n.boneTextureSize=q),e.setValue(a,"boneTexture",n.boneTexture,t),e.setValue(a,"boneTextureSize",n.boneTextureSize)):e.setOptional(a,n,"boneMatrices"))),(v||c.receiveShadow!==g.receiveShadow)&&(c.receiveShadow=g.receiveShadow,e.setValue(a,"receiveShadow",g.receiveShadow)),v&&(e.setValue(a,"toneMappingExposure",f.toneMappingExposure),c.needsLights&&(h=y,(o=w).ambientLightColor.needsUpdate=h,o.lightProbe.needsUpdate=h,o.directionalLights.needsUpdate=h,o.directionalLightShadows.needsUpdate=h,o.pointLights.needsUpdate=h,o.pointLightShadows.needsUpdate=h,o.spotLights.needsUpdate=h,o.spotLightShadows.needsUpdate=h,o.rectAreaLights.needsUpdate=h,o.hemisphereLights.needsUpdate=h),C&&b.fog&&W.refreshFogUniforms(w,C),W.refreshMaterialUniforms(w,b,m,A),a$.upload(a,c.uniformsList,w,t)),b.isShaderMaterial&&!0===b.uniformsNeedUpdate&&(a$.upload(a,c.uniformsList,w,t),b.uniformsNeedUpdate=!1),b.isSpriteMaterial&&e.setValue(a,"center",g.center),e.setValue(a,"modelViewMatrix",g.modelViewMatrix),e.setValue(a,"normalMatrix",g.normalMatrix),e.setValue(a,"modelMatrix",g.matrixWorld),B}M.setAnimationLoop(function(a){y.isPresenting||ab&&ab(a)}),"undefined"!=typeof window&&M.setContext(window),this.setAnimationLoop=function(a){ab=a,y.setAnimationLoop(a),null===a?M.stop():M.start()},this.render=function(b,a){var c,e,i,g,h;void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),c=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),e=arguments[3]),void 0===a||!0===a.isCamera?!0!==$&&(n.resetDefaultState(),P=-1,G=null,!0===b.autoUpdate&&b.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),!0===y.enabled&&!0===y.isPresenting&&(a=y.getCamera(a)),!0===b.isScene&&b.onBeforeRender(f,b,a,c||u),(k=T.get(b,H.length)).init(),H.push(k),N.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),ac.setFromProjectionMatrix(N),Z=this.localClippingEnabled,Q=s.init(this.clippingPlanes,Z,a),(r=R.get(b,a)).init(),aq(b,a,0,f.sortObjects),r.finish(),!0===f.sortObjects&&r.sort(au,ag),!0===Q&&s.beginShadows(),i=k.state.shadowsArray,ay.render(i,b,a),k.setupLights(),k.setupLightsView(a),!0===Q&&s.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==c&&this.setRenderTarget(c),x.render(r,b,a,e),g=r.opaque,h=r.transparent,g.length>0&&ao(g,b,a),h.length>0&&ao(h,b,a),!0===b.isScene&&b.onAfterRender(f,b,a),null!==u&&(t.updateRenderTargetMipmap(u),t.updateMultisampleRenderTarget(u)),d.buffers.depth.setTest(!0),d.buffers.depth.setMask(!0),d.buffers.color.setMask(!0),d.setPolygonOffset(!1),H.pop(),k=H.length>0?H[H.length-1]:null,r=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(b){_!==b&&null===u&&a.bindFramebuffer(36160,b),_=b},this.getActiveCubeFace=function(){return aj},this.getActiveMipmapLevel=function(){return ai},this.getRenderList=function(){return r},this.setRenderList=function(a){r=a},this.getRenderTarget=function(){return u},this.setRenderTarget=function(b,e,f){var c,g,h,i;void 0===e&&(e=0),void 0===f&&(f=0),u=b,aj=e,ai=f,b&&void 0===j.get(b).__webglFramebuffer&&t.setupRenderTarget(b),c=_,g=!1,b?(h=j.get(b).__webglFramebuffer,b.isWebGLCubeRenderTarget?(c=h[e],g=!0):c=b.isWebGLMultisampleRenderTarget?j.get(b).__webglMultisampledFramebuffer:h,B.copy(b.viewport),L.copy(b.scissor),V=b.scissorTest):(B.copy(J).multiplyScalar(m).floor(),L.copy(E).multiplyScalar(m).floor(),V=X),(S!==c&&(a.bindFramebuffer(36160,c),S=c),d.viewport(B),d.scissor(L),d.setScissorTest(V),g)&&(i=j.get(b.texture),a.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,f))},this.readRenderTargetPixels=function(b,l,f,o,n,q,m){var c,k,g,e,d,p;if(b&&b.isWebGLRenderTarget){if(c=j.get(b).__webglFramebuffer,b.isWebGLCubeRenderTarget&&void 0!==m&&(c=c[m]),c){k=!1,c!==S&&(a.bindFramebuffer(36160,c),k=!0);try{if(g=b.texture,e=g.format,d=g.type,e!==Y&&w.convert(e)!==a.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(p=d===cr&&(h.has("EXT_color_buffer_half_float")||i.isWebGL2&&h.has("EXT_color_buffer_float")),!(d===bT||w.convert(d)===a.getParameter(35738)||d===aw&&(i.isWebGL2||h.has("OES_texture_float")||h.has("WEBGL_color_buffer_float"))||p))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===a.checkFramebufferStatus(36160)?l>=0&&l<=b.width-o&&f>=0&&f<=b.height-n&&a.readPixels(l,f,o,n,w.convert(e),w.convert(d),q):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{k&&a.bindFramebuffer(36160,S)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,b,c){void 0===c&&(c=0);var f=Math.pow(2,-c),g=Math.floor(b.image.width*f),h=Math.floor(b.image.height*f),i=w.convert(b.format);t.setTexture2D(b,0),a.copyTexImage2D(3553,c,i,e.x,e.y,g,h,0),d.unbindTexture()},this.copyTextureToTexture=function(e,b,c,f){void 0===f&&(f=0);var i=b.image.width,j=b.image.height,g=w.convert(c.format),h=w.convert(c.type);t.setTexture2D(c,0),a.pixelStorei(37440,c.flipY),a.pixelStorei(37441,c.premultiplyAlpha),a.pixelStorei(3317,c.unpackAlignment),b.isDataTexture?a.texSubImage2D(3553,f,e.x,e.y,i,j,g,h,b.image.data):b.isCompressedTexture?a.compressedTexSubImage2D(3553,f,e.x,e.y,b.mipmaps[0].width,b.mipmaps[0].height,g,b.mipmaps[0].data):a.texSubImage2D(3553,f,e.x,e.y,g,h,b.image),0===f&&c.generateMipmaps&&a.generateMipmap(3553),d.unbindTexture()},this.initTexture=function(a){t.setTexture2D(a,0),d.unbindTexture()},this.resetState=function(){d.reset(),n.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function gv(a){dH.call(this,a)}fZ.prototype=Object.assign(Object.create(A.prototype),{constructor:fZ,isArrayCamera:!0}),br.prototype=Object.assign(Object.create(g.prototype),{constructor:br,isGroup:!0}),Object.assign(dK.prototype,{constructor:dK,getHandSpace:function(){return null===this._hand&&(this._hand=new br,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new br,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new br,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(a){return null!==this._targetRay&&this._targetRay.dispatchEvent(a),null!==this._grip&&this._grip.dispatchEvent(a),null!==this._hand&&this._hand.dispatchEvent(a),this},disconnect:function(a){return this.dispatchEvent({type:"disconnected",data:a}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(d,h,j){var k=null,l=null,n=null,b=this._targetRay,c=this._grip,a=this._hand,m,p,i,g,f,e,q,r,o;if(d&&"visible-blurred"!==h.session.visibilityState)if(a&&d.hand){n=!0;for(m,p=kQ(d.hand.values());!(m=p()).done;)i=m.value,g=h.getJointPose(i,j),void 0===a.joints[i.jointName]&&(f=new br,f.matrixAutoUpdate=!1,f.visible=!1,a.joints[i.jointName]=f,a.add(f)),e=a.joints[i.jointName],null!==g&&(e.matrix.fromArray(g.transform.matrix),e.matrix.decompose(e.position,e.rotation,e.scale),e.jointRadius=g.radius),e.visible=null!==g;q=a.joints["index-finger-tip"],r=a.joints["thumb-tip"],o=q.position.distanceTo(r.position),a.inputState.pinching&&o>.025?(a.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:d.handedness,target:this})):!a.inputState.pinching&&o<=.015&&(a.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:d.handedness,target:this}))}else null!==b&&null!==(k=h.getPose(d.targetRaySpace,j))&&(b.matrix.fromArray(k.transform.matrix),b.matrix.decompose(b.position,b.rotation,b.scale)),null!==c&&d.gripSpace&&null!==(l=h.getPose(d.gripSpace,j))&&(c.matrix.fromArray(l.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale));return null!==b&&(b.visible=null!==k),null!==c&&(c.visible=null!==l),null!==a&&(a.visible=null!==n),this}}),Object.assign(ih.prototype,aN.prototype),gv.prototype=Object.assign(Object.create(dH.prototype),{constructor:gv,isWebGL1Renderer:!0}),gu=function(){function a(b,a){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new e(b),this.density=void 0!==a?a:25e-5}var b=a.prototype;return b.clone=function(){return new a(this.color,this.density)},b.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},a}(),gt=function(){function a(c,a,b){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new e(c),this.near=void 0!==a?a:1,this.far=void 0!==b?b:1e3}var b=a.prototype;return b.clone=function(){return new a(this.color,this.near,this.far)},b.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},a}(),fp=function(a){function b(){var b;return b=a.call(this)||this,Object.defineProperty(ap(b),"isScene",{value:!0}),b.type="Scene",b.background=null,b.environment=null,b.fog=null,b.overrideMaterial=null,b.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:ap(b)})),b}m(b,a);var c=b.prototype;return c.copy=function(b,c){return a.prototype.copy.call(this,b,c),null!==b.background&&(this.background=b.background.clone()),null!==b.environment&&(this.environment=b.environment.clone()),null!==b.fog&&(this.fog=b.fog.clone()),null!==b.overrideMaterial&&(this.overrideMaterial=b.overrideMaterial.clone()),this.autoUpdate=b.autoUpdate,this.matrixAutoUpdate=b.matrixAutoUpdate,this},c.toJSON=function(c){var b=a.prototype.toJSON.call(this,c);return null!==this.background&&(b.object.background=this.background.toJSON(c)),null!==this.environment&&(b.object.environment=this.environment.toJSON(c)),null!==this.fog&&(b.object.fog=this.fog.toJSON()),b},b}(g);function T(a,b){this.array=a,this.stride=b,this.count=void 0!==a?a.length/b:0,this.usage=cj,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=l.generateUUID()}Object.defineProperty(T.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(T.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(a){return this.usage=a,this},copy:function(a){return this.array=new a.array.constructor(a.array),this.count=a.count,this.stride=a.stride,this.usage=a.usage,this},copyAt:function(b,c,d){b*=this.stride,d*=c.stride;for(var a=0,e=this.stride;a<e;a++)this.array[b+a]=c.array[d+a];return this},set:function(b,a){return void 0===a&&(a=0),this.array.set(b,a),this},clone:function(a){void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=l.generateUUID()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var b=new T(new this.array.constructor(a.arrayBuffers[this.array.buffer._uuid]),this.stride);return b.setUsage(this.usage),b},onUpload:function(a){return this.onUploadCallback=a,this},toJSON:function(a){return void 0===a.arrayBuffers&&(a.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=l.generateUUID()),void 0===a.arrayBuffers[this.array.buffer._uuid]&&(a.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}),bu=new b;function bv(a,b,c,d){this.name="",this.data=a,this.itemSize=b,this.offset=c,this.normalized=!0===d}function bw(a){j.call(this),this.type="SpriteMaterial",this.color=new e(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(a)}Object.defineProperties(bv.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(a){this.data.needsUpdate=a}}}),Object.assign(bv.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(b){for(var a=0,c=this.data.count;a<c;a++)bu.x=this.getX(a),bu.y=this.getY(a),bu.z=this.getZ(a),bu.applyMatrix4(b),this.setXYZ(a,bu.x,bu.y,bu.z);return this},setX:function(a,b){return this.data.array[a*this.data.stride+this.offset]=b,this},setY:function(a,b){return this.data.array[a*this.data.stride+this.offset+1]=b,this},setZ:function(a,b){return this.data.array[a*this.data.stride+this.offset+2]=b,this},setW:function(a,b){return this.data.array[a*this.data.stride+this.offset+3]=b,this},getX:function(a){return this.data.array[a*this.data.stride+this.offset]},getY:function(a){return this.data.array[a*this.data.stride+this.offset+1]},getZ:function(a){return this.data.array[a*this.data.stride+this.offset+2]},getW:function(a){return this.data.array[a*this.data.stride+this.offset+3]},setXY:function(a,b,c){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this},setXYZ:function(a,b,c,d){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this},setXYZW:function(a,b,c,d,e){return a=a*this.data.stride+this.offset,this.data.array[a+0]=b,this.data.array[a+1]=c,this.data.array[a+2]=d,this.data.array[a+3]=e,this},clone:function(a){var d,b,e,c;if(void 0===a){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(d=[],b=0;b<this.count;b++)for(e=b*this.data.stride+this.offset,c=0;c<this.itemSize;c++)d.push(this.data.array[e+c]);return new k(new this.array.constructor(d),this.itemSize,this.normalized)}return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.clone(a)),new bv(a.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(a){var d,b,e,c;if(void 0===a){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(d=[],b=0;b<this.count;b++)for(e=b*this.data.stride+this.offset,c=0;c<this.itemSize;c++)d.push(this.data.array[e+c]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:d,normalized:this.normalized}}return void 0===a.interleavedBuffers&&(a.interleavedBuffers={}),void 0===a.interleavedBuffers[this.data.uuid]&&(a.interleavedBuffers[this.data.uuid]=this.data.toJSON(a)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),bw.prototype=Object.create(j.prototype),bw.prototype.constructor=bw,bw.prototype.isSpriteMaterial=!0,bw.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.rotation=a.rotation,this.sizeAttenuation=a.sizeAttenuation,this},cm=new b,bZ=new b,bY=new b,bS=new c,cC=new c,gs=new o,dv=new b,cE=new b,dn=new b,gp=new c,fF=new c,go=new c;function di(a){if(g.call(this),this.type="Sprite",void 0===b_){b_=new i;var b=new T(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);b_.setIndex([0,1,2,0,2,3]),b_.setAttribute("position",new bv(b,3,0,!1)),b_.setAttribute("uv",new bv(b,2,3,!1))}this.geometry=b_,this.material=void 0!==a?a:new bw,this.center=new c(.5,.5)}function fI(a,d,e,f,b,c){bS.subVectors(a,e).addScalar(.5).multiply(f),void 0!==b?(cC.x=c*bS.x-b*bS.y,cC.y=b*bS.x+c*bS.y):cC.copy(bS),a.copy(d),a.x+=cC.x,a.y+=cC.y,a.applyMatrix4(gs)}di.prototype=Object.assign(Object.create(g.prototype),{constructor:di,isSprite:!0,raycast:function(a,i){var b,d,g,e,h,f;null===a.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),bZ.setFromMatrixScale(this.matrixWorld),gs.copy(a.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(a.camera.matrixWorldInverse,this.matrixWorld),bY.setFromMatrixPosition(this.modelViewMatrix),a.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&bZ.multiplyScalar(-bY.z),g=this.material.rotation,0!==g&&(d=Math.cos(g),b=Math.sin(g)),e=this.center,fI(dv.set(-.5,-.5,0),bY,e,bZ,b,d),fI(cE.set(.5,-.5,0),bY,e,bZ,b,d),fI(dn.set(.5,.5,0),bY,e,bZ,b,d),gp.set(0,0),fF.set(1,0),go.set(1,1),h=a.ray.intersectTriangle(dv,cE,dn,!1,cm),(null!==h||(fI(cE.set(-.5,.5,0),bY,e,bZ,b,d),fF.set(0,1),null!==(h=a.ray.intersectTriangle(dv,dn,cE,!1,cm))))&&(f=a.ray.origin.distanceTo(cm),f<a.near||f>a.far||i.push({distance:f,point:cm.clone(),uv:ai.getUV(cm,dv,cE,dn,gp,fF,go,new c),face:null,object:this}))},copy:function(a){return g.prototype.copy.call(this,a),void 0!==a.center&&this.center.copy(a.center),this.material=a.material,this}}),dh=new b,gn=new b;function df(){g.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}df.prototype=Object.assign(Object.create(g.prototype),{constructor:df,isLOD:!0,copy:function(b){var c,a,e,d;g.prototype.copy.call(this,b,!1);for(c=b.levels,a=0,e=c.length;a<e;a++)d=c[a],this.addLevel(d.object.clone(),d.distance);return this.autoUpdate=b.autoUpdate,this},addLevel:function(d,a){void 0===a&&(a=0),a=Math.abs(a);var b,c=this.levels;for(b=0;b<c.length&&!(a<c[b].distance);b++);return c.splice(b,0,{distance:a,object:d}),this.add(d),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(d){var b=this.levels,a,c;if(b.length>0){for(a=1,c=b.length;a<c&&!(d<b[a].distance);a++);return b[a-1].object}return null},raycast:function(a,b){if(this.levels.length>0){dh.setFromMatrixPosition(this.matrixWorld);var c=a.ray.origin.distanceTo(dh);this.getObjectForDistance(c).raycast(a,b)}},update:function(d){var b=this.levels,a,c,e;if(b.length>1){dh.setFromMatrixPosition(d.matrixWorld),gn.setFromMatrixPosition(this.matrixWorld),e=dh.distanceTo(gn)/d.zoom;for(b[0].object.visible=!0,a=1,c=b.length;a<c&&e>=b[a].distance;a++)b[a-1].object.visible=!1,b[a].object.visible=!0;for(this._currentLevel=a-1;a<c;a++)b[a].object.visible=!1}},toJSON:function(e){var a=g.prototype.toJSON.call(this,e),c,b,f,d;!1===this.autoUpdate&&(a.object.autoUpdate=!1),a.object.levels=[];for(c=this.levels,b=0,f=c.length;b<f;b++)d=c[b],a.object.levels.push({object:d.object.uuid,distance:d.distance});return a}}),gm=new b,gk=new q,gj=new q,ib=new b,gf=new o;function db(a,b){a&&a.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),t.call(this,a,b),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new o,this.bindMatrixInverse=new o}function da(){g.call(this),this.type="Bone"}db.prototype=Object.assign(Object.create(t.prototype),{constructor:db,isSkinnedMesh:!0,copy:function(a){return t.prototype.copy.call(this,a),this.bindMode=a.bindMode,this.bindMatrix.copy(a.bindMatrix),this.bindMatrixInverse.copy(a.bindMatrixInverse),this.skeleton=a.skeleton,this},bind:function(b,a){this.skeleton=b,void 0===a&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.copy(a).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var a=new q,c=this.geometry.attributes.skinWeight,b=0,e=c.count,d;b<e;b++)a.x=c.getX(b),a.y=c.getY(b),a.z=c.getZ(b),a.w=c.getW(b),d=1/a.manhattanLength(),d!==1/0?a.multiplyScalar(d):a.set(1,0,0,0),c.setXYZW(b,a.x,a.y,a.z,a.w)},updateMatrixWorld:function(a){t.prototype.updateMatrixWorld.call(this,a),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(b,c){var e=this.skeleton,d=this.geometry,a,f,g;gk.fromBufferAttribute(d.attributes.skinIndex,b),gj.fromBufferAttribute(d.attributes.skinWeight,b),gm.fromBufferAttribute(d.attributes.position,b).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(a=0;a<4;a++)f=gj.getComponent(a),0!==f&&(g=gk.getComponent(a),gf.multiplyMatrices(e.bones[g].matrixWorld,e.boneInverses[g]),c.addScaledVector(ib.copy(gm).applyMatrix4(gf),f));return c.applyMatrix4(this.bindMatrixInverse)}}),da.prototype=Object.assign(Object.create(g.prototype),{constructor:da,isBone:!0}),ge=new o,hY=new o;function cU(a,b){void 0===a&&(a=[]),void 0===b&&(b=[]),this.uuid=l.generateUUID(),this.bones=a.slice(0),this.boneInverses=b,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}Object.assign(cU.prototype,{init:function(){var a=this.bones,b=this.boneInverses,c,d;if(this.boneMatrices=new Float32Array(16*a.length),0===b.length)this.calculateInverses();else if(a.length!==b.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(c=0,d=this.bones.length;c<d;c++)this.boneInverses.push(new o)}},calculateInverses:function(){var a,c,b;this.boneInverses.length=0;for(a=0,c=this.bones.length;a<c;a++)b=new o,this.bones[a]&&b.copy(this.bones[a].matrixWorld).invert(),this.boneInverses.push(b)},pose:function(){for(var b=0,e=this.bones.length,d,c,f,a;b<e;b++)d=this.bones[b],d&&d.matrixWorld.copy(this.boneInverses[b]).invert();for(c=0,f=this.bones.length;c<f;c++)a=this.bones[c],a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))},update:function(){for(var b=this.bones,d=this.boneInverses,e=this.boneMatrices,c=this.boneTexture,a=0,f=b.length,g;a<f;a++)g=b[a]?b[a].matrixWorld:hY,ge.multiplyMatrices(g,d[a]),ge.toArray(e,16*a);null!==c&&(c.needsUpdate=!0)},clone:function(){return new cU(this.bones,this.boneInverses)},getBoneByName:function(c){for(var a=0,d=this.bones.length,b;a<d;a++)if(b=this.bones[a],b.name===c)return b},dispose:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)},fromJSON:function(b,f){var a,e,d,c;this.uuid=b.uuid;for(a=0,e=b.bones.length;a<e;a++)d=b.bones[a],c=f[d],void 0===c&&(console.warn("THREE.Skeleton: No bone found with UUID:",d),c=new da),this.bones.push(c),this.boneInverses.push((new o).fromArray(b.boneInverses[a]));return this.init(),this},toJSON:function(){var a={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]},c,d,b,e,f,g;a.uuid=this.uuid;for(c=this.bones,d=this.boneInverses,b=0,e=c.length;b<e;b++)f=c[b],a.bones.push(f.uuid),g=d[b],a.boneInverses.push(g.toArray());return a}}),f$=new o,gH=new o,em=[],cR=new t;function fX(b,c,a){t.call(this,b,c),this.instanceMatrix=new k(new Float32Array(16*a),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}function w(a){j.call(this),this.type="LineBasicMaterial",this.color=new e(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(a)}fX.prototype=Object.assign(Object.create(t.prototype),{constructor:fX,isInstancedMesh:!0,copy:function(a){return t.prototype.copy.call(this,a),this.instanceMatrix.copy(a.instanceMatrix),null!==a.instanceColor&&(this.instanceColor=a.instanceColor.clone()),this.count=a.count,this},getColorAt:function(a,b){b.fromArray(this.instanceColor.array,3*a)},getMatrixAt:function(a,b){b.fromArray(this.instanceMatrix.array,16*a)},raycast:function(d,h){var e=this.matrixWorld,f=this.count,a,c,g,b;if(cR.geometry=this.geometry,cR.material=this.material,void 0!==cR.material)for(a=0;a<f;a++){this.getMatrixAt(a,f$),gH.multiplyMatrices(e,f$),cR.matrixWorld=gH,cR.raycast(d,em);for(c=0,g=em.length;c<g;c++)b=em[c],b.instanceId=a,b.object=this,h.push(b);em.length=0}},setColorAt:function(a,b){null===this.instanceColor&&(this.instanceColor=new k(new Float32Array(3*this.count),3)),b.toArray(this.instanceColor.array,3*a)},setMatrixAt:function(a,b){b.toArray(this.instanceMatrix.array,16*a)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}}),w.prototype=Object.create(j.prototype),w.prototype.constructor=w,w.prototype.isLineBasicMaterial=!0,w.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.linewidth=a.linewidth,this.linecap=a.linecap,this.linejoin=a.linejoin,this.morphTargets=a.morphTargets,this},ga=new b,gb=new b,gc=new o,fU=new bG,cV=new aO;function $(a,b){void 0===a&&(a=new i),void 0===b&&(b=new w),g.call(this),this.type="Line",this.geometry=a,this.material=b,this.updateMorphTargets()}$.prototype=Object.assign(Object.create(g.prototype),{constructor:$,isLine:!0,copy:function(a){return g.prototype.copy.call(this,a),this.material=a.material,this.geometry=a.geometry,this},computeLineDistances:function(){var b=this.geometry,d,c,a,e;if(b.isBufferGeometry)if(null===b.index){for(d=b.attributes.position,c=[0],a=1,e=d.count;a<e;a++)ga.fromBufferAttribute(d,a-1),gb.fromBufferAttribute(d,a),c[a]=c[a-1],c[a]+=ga.distanceTo(gb);b.setAttribute("lineDistance",new f(c,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else b.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(a,t){var c=this.geometry,s=this.matrixWorld,q=a.params.Line.threshold,p,o,i,j,h,d,r,n,f,k,g,x,u,v,l,e,w,m;if(null===c.boundingSphere&&c.computeBoundingSphere(),cV.copy(c.boundingSphere),cV.applyMatrix4(s),cV.radius+=q,!1!==a.ray.intersectsSphere(cV))if(gc.copy(s).invert(),fU.copy(a.ray).applyMatrix4(gc),p=q/((this.scale.x+this.scale.y+this.scale.z)/3),o=p*p,i=new b,j=new b,h=new b,d=new b,r=this.isLineSegments?2:1,c.isBufferGeometry){if(n=c.index,f=c.attributes.position,null!==n){for(k=n.array,g=0,x=k.length-1;g<x;g+=r)u=k[g],v=k[g+1],(i.fromBufferAttribute(f,u),j.fromBufferAttribute(f,v),!(fU.distanceSqToSegment(i,j,d,h)>o))&&(d.applyMatrix4(this.matrixWorld),l=a.ray.origin.distanceTo(d),l<a.near||l>a.far||t.push({distance:l,point:h.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else for(e=0,w=f.count-1;e<w;e+=r)i.fromBufferAttribute(f,e),j.fromBufferAttribute(f,e+1),!(fU.distanceSqToSegment(i,j,d,h)>o)&&(d.applyMatrix4(this.matrixWorld),m=a.ray.origin.distanceTo(d),m<a.near||m>a.far||t.push({distance:m,point:h.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this}))}else c.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){var b=this.geometry,d,e,c,a,g,h,f;if(b.isBufferGeometry){if(d=b.morphAttributes,e=Object.keys(d),e.length>0)if(c=d[e[0]],void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(a=0,g=c.length;a<g;a++)h=c[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=a}}else f=b.morphTargets,void 0!==f&&f.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}),gg=new b,gh=new b;function N(a,b){$.call(this,a,b),this.type="LineSegments"}function fO(a,b){$.call(this,a,b),this.type="LineLoop"}function ak(a){j.call(this),this.type="PointsMaterial",this.color=new e(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(a)}N.prototype=Object.assign(Object.create($.prototype),{constructor:N,isLineSegments:!0,computeLineDistances:function(){var b=this.geometry,d,c,a,e;if(b.isBufferGeometry)if(null===b.index){for(d=b.attributes.position,c=[],a=0,e=d.count;a<e;a+=2)gg.fromBufferAttribute(d,a),gh.fromBufferAttribute(d,a+1),c[a]=0===a?0:c[a-1],c[a+1]=c[a]+gg.distanceTo(gh);b.setAttribute("lineDistance",new f(c,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else b.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}),fO.prototype=Object.assign(Object.create($.prototype),{constructor:fO,isLineLoop:!0}),ak.prototype=Object.create(j.prototype),ak.prototype.constructor=ak,ak.prototype.isPointsMaterial=!0,ak.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.alphaMap=a.alphaMap,this.size=a.size,this.sizeAttenuation=a.sizeAttenuation,this.morphTargets=a.morphTargets,this},gl=new o,fM=new bG,dg=new aO,dj=new b;function cL(a,b){void 0===a&&(a=new i),void 0===b&&(b=new ak),g.call(this),this.type="Points",this.geometry=a,this.material=b,this.updateMorphTargets()}function ig(e,i,j,k,d,g,h){var f=fM.distanceSqToPoint(e),a,c;if(f<j){if(a=new b,fM.closestPointToPoint(e,a),a.applyMatrix4(k),c=d.ray.origin.distanceTo(a),c<d.near||c>d.far)return;g.push({distance:c,distanceToRay:Math.sqrt(f),point:a,index:i,face:null,object:h})}}function gr(a,e,f,g,b,c,d,h,i){r.call(this,a,e,f,g,b,c,d,h,i),this.format=void 0!==d?d:aK,this.minFilter=void 0!==c?c:D,this.magFilter=void 0!==b?b:D,this.generateMipmaps=!1;var j=this;"requestVideoFrameCallback"in a&&a.requestVideoFrameCallback(function b(){j.needsUpdate=!0,a.requestVideoFrameCallback(b)})}function cD(a,b,c,d,e,f,g,h,i,j,k,l){r.call(this,null,f,g,h,i,j,d,e,k,l),this.image={width:b,height:c},this.mipmaps=a,this.flipY=!1,this.generateMipmaps=!1}function dB(a,b,c,d,e,f,g,h,i){r.call(this,a,b,c,d,e,f,g,h,i),this.needsUpdate=!0}function dC(g,h,b,j,e,f,c,d,i,a){if((a=void 0!==a?a:bi)!==bi&&a!==bX)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===b&&a===bi&&(b=ct),void 0===b&&a===bX&&(b=cd),r.call(this,null,j,e,f,c,d,a,b,i),this.image={width:g,height:h},this.magFilter=void 0!==c?c:C,this.minFilter=void 0!==d?d:C,this.flipY=!1,this.generateMipmaps=!1}cL.prototype=Object.assign(Object.create(g.prototype),{constructor:cL,isPoints:!0,copy:function(a){return g.prototype.copy.call(this,a),this.material=a.material,this.geometry=a.geometry,this},raycast:function(b,l){var a=this.geometry,d=this.matrixWorld,k=b.params.Points.threshold,i,h,g,f,j,e,n,m,c,o;if(null===a.boundingSphere&&a.computeBoundingSphere(),dg.copy(a.boundingSphere),dg.applyMatrix4(d),dg.radius+=k,!1!==b.ray.intersectsSphere(dg))if(gl.copy(d).invert(),fM.copy(b.ray).applyMatrix4(gl),i=k/((this.scale.x+this.scale.y+this.scale.z)/3),h=i*i,a.isBufferGeometry)if(g=a.index,f=a.attributes.position,null!==g)for(j=g.array,e=0,n=j.length;e<n;e++)m=j[e],dj.fromBufferAttribute(f,m),ig(dj,m,h,d,b,l,this);else for(c=0,o=f.count;c<o;c++)dj.fromBufferAttribute(f,c),ig(dj,c,h,d,b,l,this);else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){var b=this.geometry,d,e,c,a,g,h,f;if(b.isBufferGeometry){if(d=b.morphAttributes,e=Object.keys(d),e.length>0)if(c=d[e[0]],void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(a=0,g=c.length;a<g;a++)h=c[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=a}}else f=b.morphTargets,void 0!==f&&f.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}),gr.prototype=Object.assign(Object.create(r.prototype),{constructor:gr,clone:function(){return new this.constructor(this.image).copy(this)},isVideoTexture:!0,update:function(){var a=this.image;!1==="requestVideoFrameCallback"in a&&a.readyState>=a.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),cD.prototype=Object.create(r.prototype),cD.prototype.constructor=cD,cD.prototype.isCompressedTexture=!0,dB.prototype=Object.create(r.prototype),dB.prototype.constructor=dB,dB.prototype.isCanvasTexture=!0,dC.prototype=Object.create(r.prototype),dC.prototype.constructor=dC,dC.prototype.isDepthTexture=!0,dE=function(a){function d(g,d,j,k){var e,r,i,q,n,h,l,o,p,s,m;void 0===g&&(g=1),void 0===d&&(d=8),void 0===j&&(j=0),void 0===k&&(k=2*Math.PI),(e=a.call(this)||this).type="CircleGeometry",e.parameters={radius:g,segments:d,thetaStart:j,thetaLength:k},d=Math.max(3,d),r=[],i=[],q=[],n=[],h=new b,l=new c,i.push(0,0,0),q.push(0,0,1),n.push(.5,.5);for(o=0,p=3;o<=d;o++,p+=3)s=j+o/d*k,h.x=g*Math.cos(s),h.y=g*Math.sin(s),i.push(h.x,h.y,h.z),q.push(0,0,1),l.x=(i[p]/g+1)/2,l.y=(i[p+1]/g+1)/2,n.push(l.x,l.y);for(m=1;m<=d;m++)r.push(m,m+1,0);return e.setIndex(r),e.setAttribute("position",new f(i,3)),e.setAttribute("normal",new f(q,3)),e.setAttribute("uv",new f(n,2)),e}return m(d,a),d}(i),ca=function(a){function d(h,i,j,d,g,t,m,n){var e,v,o,s,q,r,k,l,u,p;void 0===h&&(h=1),void 0===i&&(i=1),void 0===j&&(j=1),void 0===d&&(d=8),void 0===g&&(g=1),void 0===t&&(t=!1),void 0===m&&(m=0),void 0===n&&(n=2*Math.PI),(e=a.call(this)||this).type="CylinderGeometry",e.parameters={radiusTop:h,radiusBottom:i,height:j,radialSegments:d,heightSegments:g,openEnded:t,thetaStart:m,thetaLength:n},v=ap(e),d=Math.floor(d),g=Math.floor(g),o=[],s=[],q=[],r=[],k=0,l=[],u=j/2,p=0;function w(j){for(var D=k,g=new c,a=new b,t=0,x=!0===j?h:i,e=!0===j?1:-1,y=1,E,w,z,A,B,f,C,l;y<=d;y++)s.push(0,u*e,0),q.push(0,e,0),r.push(.5,.5),k++;for(E=k,w=0;w<=d;w++)z=w/d*n+m,A=Math.cos(z),B=Math.sin(z),a.x=x*B,a.y=u*e,a.z=x*A,s.push(a.x,a.y,a.z),q.push(0,e,0),g.x=.5*A+.5,g.y=.5*B*e+.5,r.push(g.x,g.y),k++;for(f=0;f<d;f++)C=D+f,l=E+f,!0===j?o.push(l,l+1,C):o.push(l+1,l,C),t+=3;v.addGroup(p,t,!0===j?1:2),p+=t}return function(){for(var f=new b,a=new b,w=0,I=(i-h)/j,x=0,E,y,A,t,z,B,C,D,e,c,H,F,J,G;x<=g;x++){for(E=[],y=x/g,A=y*(i-h)+h,t=0;t<=d;t++)z=t/d,B=z*n+m,C=Math.sin(B),D=Math.cos(B),a.x=A*C,a.y=-y*j+u,a.z=A*D,s.push(a.x,a.y,a.z),f.set(C,I,D).normalize(),q.push(f.x,f.y,f.z),r.push(z,1-y),E.push(k++);l.push(E)}for(e=0;e<d;e++)for(c=0;c<g;c++)H=l[c][e],F=l[c+1][e],J=l[c+1][e+1],G=l[c][e+1],o.push(H,F,G),o.push(F,J,G),w+=6;v.addGroup(p,w,0),p+=w}(),!1===t&&(h>0&&w(!0),i>0&&w(!1)),e.setIndex(o),e.setAttribute("position",new f(s,3)),e.setAttribute("normal",new f(q,3)),e.setAttribute("uv",new f(r,2)),e}return m(d,a),d}(i),dJ=function(a){function b(b,c,d,e,f,g,h){var i;return void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=8),void 0===e&&(e=1),void 0===f&&(f=!1),void 0===g&&(g=0),void 0===h&&(h=2*Math.PI),(i=a.call(this,0,b,c,d,e,f,g,h)||this).type="ConeGeometry",i.parameters={radius:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h},i}return m(b,a),b}(ca),aT=function(a){function d(k,i,l,j){var g,d,e;void 0===l&&(l=1),void 0===j&&(j=0),(g=a.call(this)||this).type="PolyhedronGeometry",g.parameters={vertices:k,indices:i,radius:l,detail:j},d=[],e=[];function p(o,n,j,m){for(var d=m+1,c=[],b=0,i,l,k,f,a,g,e;b<=d;b++){c[b]=[];for(i=o.clone().lerp(j,b/d),l=n.clone().lerp(j,b/d),k=d-b,f=0;f<=k;f++)c[b][f]=0===f&&b===d?i:i.clone().lerp(l,f/k)}for(a=0;a<d;a++)for(g=0;g<2*(d-a)-1;g++)e=Math.floor(g/2),g%2==0?(h(c[a][e+1]),h(c[a+1][e]),h(c[a][e])):(h(c[a][e+1]),h(c[a+1][e+1]),h(c[a+1][e]))}function h(a){d.push(a.x,a.y,a.z)}function m(c,a){var b=3*c;a.x=k[b+0],a.y=k[b+1],a.z=k[b+2]}function n(a,b,c,d){d<0&&1===a.x&&(e[b]=a.x-1),0===c.x&&0===c.z&&(e[b]=d/2/Math.PI+.5)}function o(a){return Math.atan2(a.z,-a.x)}return function(f){for(var c=new b,d=new b,e=new b,a=0;a<i.length;a+=3)m(i[a+0],c),m(i[a+1],d),m(i[a+2],e),p(c,d,e,f)}(j),function(e){for(var c=new b,a=0;a<d.length;a+=3)c.x=d[a+0],c.y=d[a+1],c.z=d[a+2],c.normalize().multiplyScalar(e),d[a+0]=c.x,d[a+1]=c.y,d[a+2]=c.z}(l),function(){for(var f=new b,g=0,h,i,a;g<d.length;g+=3)f.x=d[g+0],f.y=d[g+1],f.z=d[g+2],h=o(f)/2/Math.PI+.5,i=(a=f,Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5),e.push(h,1-i);(function(){for(var g=new b,i=new b,j=new b,p=new b,k=new c,l=new c,m=new c,a=0,f=0,h;a<d.length;a+=9,f+=6)g.set(d[a+0],d[a+1],d[a+2]),i.set(d[a+3],d[a+4],d[a+5]),j.set(d[a+6],d[a+7],d[a+8]),k.set(e[f+0],e[f+1]),l.set(e[f+2],e[f+3]),m.set(e[f+4],e[f+5]),p.copy(g).add(i).add(j).divideScalar(3),h=o(p),n(k,f+0,g,h),n(l,f+2,i,h),n(m,f+4,j,h)})(),function(){for(var a=0,b,c,d,f,g;a<e.length;a+=6)b=e[a+0],c=e[a+2],d=e[a+4],f=Math.max(b,c,d),g=Math.min(b,c,d),f>.9&&g<.1&&(b<.2&&(e[a+0]+=1),c<.2&&(e[a+2]+=1),d<.2&&(e[a+4]+=1))}()}(),g.setAttribute("position",new f(d,3)),g.setAttribute("normal",new f(d.slice(),3)),g.setAttribute("uv",new f(e,2)),0===j?g.computeVertexNormals():g.normalizeNormals(),g}return m(d,a),d}(i),cS=function(a){function b(d,e){var f,b,c,g;return void 0===d&&(d=1),void 0===e&&(e=0),b=(1+Math.sqrt(5))/2,c=1/b,g=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-c,-b,0,-c,b,0,c,-b,0,c,b,-c,-b,0,-c,b,0,c,-b,0,c,b,0,-b,0,-c,b,0,-c,-b,0,c,b,0,c],(f=a.call(this,g,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],d,e)||this).type="DodecahedronGeometry",f.parameters={radius:d,detail:e},f}return m(b,a),b}(aT),dN=new b,dO=new b,e$=new b,cc=new ai,eZ=function(a){function b(v,k){var n,e,D,h,i,C,b,y,c,d,m,g,r,o,p,j,u,w,x,s,t,z,q,A,B,E,F;if((n=a.call(this)||this).type="EdgesGeometry",n.parameters={thresholdAngle:k},k=void 0!==k?k:1,!0===v.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ap(n);for(e=Math.pow(10,4),D=Math.cos(l.DEG2RAD*k),h=v.getIndex(),i=v.getAttribute("position"),C=h?h.count:i.count,b=[0,0,0],y=["a","b","c"],c=new Array(3),d={},m=[],g=0;g<C;g+=3)if(h?(b[0]=h.getX(g),b[1]=h.getX(g+1),b[2]=h.getX(g+2)):(b[0]=g,b[1]=g+1,b[2]=g+2),r=cc.a,o=cc.b,p=cc.c,r.fromBufferAttribute(i,b[0]),o.fromBufferAttribute(i,b[1]),p.fromBufferAttribute(i,b[2]),cc.getNormal(e$),c[0]=Math.round(r.x*e)+","+Math.round(r.y*e)+","+Math.round(r.z*e),c[1]=Math.round(o.x*e)+","+Math.round(o.y*e)+","+Math.round(o.z*e),c[2]=Math.round(p.x*e)+","+Math.round(p.y*e)+","+Math.round(p.z*e),c[0]!==c[1]&&c[1]!==c[2]&&c[2]!==c[0])for(j=0;j<3;j++)u=(j+1)%3,w=c[j],x=c[u],s=cc[y[j]],t=cc[y[u]],z=w+"_"+x,q=x+"_"+w,q in d&&d[q]?(e$.dot(d[q].normal)<=D&&(m.push(s.x,s.y,s.z),m.push(t.x,t.y,t.z)),d[q]=null):z in d||(d[z]={index0:b[j],index1:b[u],normal:e$.clone()});for(A in d)d[A]&&(B=d[A],E=B.index0,F=B.index1,dN.fromBufferAttribute(i,E),dO.fromBufferAttribute(i,F),m.push(dN.x,dN.y,dN.z),m.push(dO.x,dO.y,dO.z));return n.setAttribute("position",new f(m,3)),n}return m(b,a),b}(i),iA=function(b,l,a){var d,e,g,h,j,i,f,n,o,c,m,k;if(a=a||2,n=l&&l.length,o=n?l[0]*a:b.length,c=iB(b,0,o,a,!0),m=[],!c||c.next===c.prev)return m;if(n&&(c=function(h,g,b,e){var a,f,c,d=[];for(a=0,f=g.length;a<f;a++)(c=iB(h,g[a]*e,a<f-1?g[a+1]*e:h.length,e,!1))===c.next&&(c.steiner=!0),d.push(kr(c));for(d.sort(kz),a=0;a<d.length;a++)ku(d[a],b),b=bj(b,b.next);return b}(b,l,c,a)),b.length>80*a){d=g=b[0],e=h=b[1];for(k=a;k<o;k+=a)(j=b[k])<d&&(d=j),(i=b[k+1])<e&&(e=i),j>g&&(g=j),i>h&&(h=i);f=0!==(f=Math.max(g-d,h-e))?1/f:0}return dG(c,m,a,d,e,f),m};function iB(c,e,f,d,g){var a,b;if(g===function(b,g,d,e){for(var f=0,a=g,c=d-e;a<d;a+=e)f+=(b[c]-b[a])*(b[a+1]+b[c+1]),c=a;return f}(c,e,f,d)>0)for(a=e;a<f;a+=d)b=je(a,c[a],c[a+1],b);else for(a=f-d;a>=e;a-=d)b=je(a,c[a],c[a+1],b);return b&&eV(b,b.next)&&(dT(b),b=b.next),b}function bj(c,b){if(!c)return c;b||(b=c);var d,a=c;do if(d=!1,a.steiner||!eV(a,a.next)&&0!==y(a.prev,a,a.next))a=a.next;else{if(dT(a),(a=b=a.prev)===a.next)break;d=!0}while(d||a!==b)return b}function dG(a,b,c,e,f,d,h){if(a){!h&&d&&function(b,c,d,e){var a=b;do null===a.z&&(a.z=gQ(a.x,a.y,c,d,e)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next;while(a!==b)a.prevZ.nextZ=null,a.prevZ=null,function(g){var i,b,a,c,d,h,e,f,j=1;do{for(b=g,g=null,d=null,h=0;b;){for(h++,a=b,e=0,i=0;i<j&&(e++,a=a.nextZ);i++);for(f=j;e>0||f>0&&a;)0!==e&&(0===f||!a||b.z<=a.z)?(c=b,b=b.nextZ,e--):(c=a,a=a.nextZ,f--),d?d.nextZ=c:g=c,c.prevZ=d,d=c;b=a}d.nextZ=null,j*=2}while(h>1)}(a)}(a,e,f,d);for(var i,g,j=a;a.prev!==a.next;)if(i=a.prev,g=a.next,d?kC(a,e,f,d):kF(a))b.push(i.i/c),b.push(a.i/c),b.push(g.i/c),dT(a),a=g.next,j=g.next;else if((a=g)===j){h?1===h?dG(a=kB(bj(a),b,c),b,c,e,f,d,2):2===h&&kA(a,b,c,e,f,d):dG(bj(a),b,c,e,f,d,1);break}}}function kF(b){var c=b.prev,d=b,e=b.next,a;if(y(c,d,e)>=0)return!1;for(a=b.next.next;a!==b.prev;){if(ci(c.x,c.y,d.x,d.y,e.x,e.y,a.x,a.y)&&y(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function kC(f,k,h,g){var e=f.prev,d=f,a=f.next,o,l,m,n,i,j,b,c;if(y(e,d,a)>=0)return!1;for(o=e.x<d.x?e.x<a.x?e.x:a.x:d.x<a.x?d.x:a.x,l=e.y<d.y?e.y<a.y?e.y:a.y:d.y<a.y?d.y:a.y,m=e.x>d.x?e.x>a.x?e.x:a.x:d.x>a.x?d.x:a.x,n=e.y>d.y?e.y>a.y?e.y:a.y:d.y>a.y?d.y:a.y,i=gQ(o,l,k,h,g),j=gQ(m,n,k,h,g),b=f.prevZ,c=f.nextZ;b&&b.z>=i&&c&&c.z<=j;){if(b!==f.prev&&b!==f.next&&ci(e.x,e.y,d.x,d.y,a.x,a.y,b.x,b.y)&&y(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,c!==f.prev&&c!==f.next&&ci(e.x,e.y,d.x,d.y,a.x,a.y,c.x,c.y)&&y(c.prev,c,c.next)>=0)return!1;c=c.nextZ}for(;b&&b.z>=i;){if(b!==f.prev&&b!==f.next&&ci(e.x,e.y,d.x,d.y,a.x,a.y,b.x,b.y)&&y(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;c&&c.z<=j;){if(c!==f.prev&&c!==f.next&&ci(e.x,e.y,d.x,d.y,a.x,a.y,c.x,c.y)&&y(c.prev,c,c.next)>=0)return!1;c=c.nextZ}return!0}function kB(d,e,f){var a=d,c,b;do c=a.prev,b=a.next.next,!eV(c,b)&&iQ(c,a,a.next,b)&&dS(c,b)&&dS(b,c)&&(e.push(c.i/f),e.push(a.i/f),e.push(b.i/f),dT(a),dT(a.next),a=d=b),a=a.next;while(a!==d)return bj(a)}function kA(g,h,i,d,e,f){var a=g,b,c;do{for(b=a.next.next;b!==a.prev;){if(a.i!==b.i&&ko(a,b))return c=jF(a,b),a=bj(a,a.next),c=bj(c,c.next),dG(a,h,i,d,e,f),void dG(c,h,i,d,e,f);b=b.next}a=a.next}while(a!==g)}function kz(a,b){return a.x-b.x}function ku(b,a){if(a=function(h,l){var b,a=l,d=h.x,c=h.y,e=-1/0,g,f,m,k,i,j;do{if(c<=a.y&&c>=a.next.y&&a.next.y!==a.y)if(g=a.x+(c-a.y)*(a.next.x-a.x)/(a.next.y-a.y),g<=d&&g>e){if(e=g,g===d){if(c===a.y)return a;if(c===a.next.y)return a.next}b=a.x<a.next.x?a:a.next}a=a.next}while(a!==l)if(!b)return null;if(d===e)return b;m=b,k=b.x,i=b.y,j=1/0,a=b;do d>=a.x&&a.x>=k&&d!==a.x&&ci(c<i?d:e,c,k,i,c<i?e:d,c,a.x,a.y)&&(f=Math.abs(c-a.y)/(d-a.x),dS(a,h)&&(f<j||f===j&&(a.x>b.x||a.x===b.x&&ks(b,a)))&&(b=a,j=f)),a=a.next;while(a!==m)return b}(b,a)){var c=jF(a,b);bj(a,a.next),bj(c,c.next)}}function ks(a,b){return y(a.prev,a,b.prev)<0&&y(b.next,a,a.next)<0}function gQ(a,b,d,e,c){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-d)*c)|a<<8))|a<<4))|a<<2))|a<<1))|(b=1431655765&((b=858993459&((b=252645135&((b=16711935&((b=32767*(b-e)*c)|b<<8))|b<<4))|b<<2))|b<<1))<<1}function kr(c){var a=c,b=c;do(a.x<b.x||a.x===b.x&&a.y<b.y)&&(b=a),a=a.next;while(a!==c)return b}function ci(g,h,c,d,e,f,a,b){return(e-a)*(h-b)-(g-a)*(f-b)>=0&&(g-a)*(d-b)-(c-a)*(h-b)>=0&&(c-a)*(f-b)-(e-a)*(d-b)>=0}function ko(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(b,c){var a=b;do{if(a.i!==b.i&&a.next.i!==b.i&&a.i!==c.i&&a.next.i!==c.i&&iQ(a,a.next,b,c))return!0;a=a.next}while(a!==b)return!1}(a,b)&&(dS(a,b)&&dS(b,a)&&function(b,e){var a=b,c=!1,f=(b.x+e.x)/2,d=(b.y+e.y)/2;do a.y>d!=a.next.y>d&&a.next.y!==a.y&&f<(a.next.x-a.x)*(d-a.y)/(a.next.y-a.y)+a.x&&(c=!c),a=a.next;while(a!==b)return c}(a,b)&&(y(a.prev,a,b.prev)||y(a,b.prev,b))||eV(a,b)&&y(a.prev,a,a.next)>0&&y(b.prev,b,b.next)>0)}function y(b,a,c){return(a.y-b.y)*(c.x-a.x)-(a.x-b.x)*(c.y-a.y)}function eV(a,b){return a.x===b.x&&a.y===b.y}function iQ(a,b,c,d){var e=eT(y(a,b,c)),f=eT(y(a,b,d)),g=eT(y(c,d,a)),h=eT(y(c,d,b));return e!==f&&g!==h||!(0!==e||!eU(a,c,b))||!(0!==f||!eU(a,d,b))||!(0!==g||!eU(c,a,d))||!(0!==h||!eU(c,b,d))}function eU(a,b,c){return b.x<=Math.max(a.x,c.x)&&b.x>=Math.min(a.x,c.x)&&b.y<=Math.max(a.y,c.y)&&b.y>=Math.min(a.y,c.y)}function eT(a){return a>0?1:a<0?-1:0}function dS(a,b){return y(a.prev,a,a.next)<0?y(a,b,a.next)>=0&&y(a,a.prev,b)>=0:y(a,b,a.prev)<0||y(a,a.next,b)<0}function jF(a,b){var d=new hb(a.i,a.x,a.y),c=new hb(b.i,b.x,b.y),e=a.next,f=b.prev;return a.next=b,b.prev=a,d.next=e,e.prev=d,c.next=d,d.prev=c,f.next=c,c.prev=f,c}function je(c,d,e,b){var a=new hb(c,d,e);return b?(a.next=b.next,a.prev=b,b.next.prev=a,b.next=a):(a.prev=a,a.next=a),a}function dT(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function hb(a,b,c){this.i=a,this.x=b,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}aB={area:function(a){for(var d=a.length,e=0,c=d-1,b=0;b<d;c=b++)e+=a[c].x*a[b].y-a[b].x*a[c].y;return.5*e},isClockWise:function(a){return aB.area(a)<0},triangulateShape:function(d,b){var e=[],f=[],g=[],h,a,i,c;jv(d),hX(e,d),h=d.length,b.forEach(jv);for(a=0;a<b.length;a++)f.push(h),h+=b[a].length,hX(e,b[a]);for(i=iA(e,f),c=0;c<i.length;c+=3)g.push(i.slice(c,c+3));return g}};function jv(a){var b=a.length;b>2&&a[b-1].equals(a[0])&&a.pop()}function hX(c,b){for(var a=0;a<b.length;a++)c.push(b[a].x),c.push(b[a].y)}bg=function(d){function a(g,a){var h,i,e,j,k,l;(h=d.call(this)||this).type="ExtrudeGeometry",h.parameters={shapes:g,options:a},g=Array.isArray(g)?g:[g];for(i=ap(h),e=[],j=[],k=0,l=g.length;k<l;k++)m(g[k]);function m(aA){var r=[],aM=void 0!==a.curveSegments?a.curveSegments:12,g=void 0!==a.steps?a.steps:1,Y=void 0!==a.depth?a.depth:100,y=void 0===a.bevelEnabled||a.bevelEnabled,E=void 0!==a.bevelThickness?a.bevelThickness:6,X=void 0!==a.bevelSize?a.bevelSize:E-2,V=void 0!==a.bevelOffset?a.bevelOffset:0,q=void 0!==a.bevelSegments?a.bevelSegments:3,ae=a.extrudePath,au=void 0!==a.UVGenerator?a.UVGenerator:jR,u,x,w,v,m,M,ap,f,d,J,aF,ar,A,h,ag,aH,aC,n,L,N,D,P,Q,R,p,ai,U,ac,aI,ab,z,Z,_,$,ah,av,az,aw,O,aK,at,aa,aJ,ao,W,aE,am,an,C,T,t,B,I,af,ay,ad,ax,H,aN,aj,G,aD,al,F,aG,K;if(void 0!==a.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),Y=a.amount),M=!1,ae&&(u=ae.getSpacedPoints(g),M=!0,y=!1,x=ae.computeFrenetFrames(g,!1),w=new b,v=new b,m=new b),y||(q=0,E=0,X=0,V=0),ap=aA.extractPoints(aM),f=ap.shape,d=ap.holes,!aB.isClockWise(f)){f=f.reverse();for(J=0,aF=d.length;J<aF;J++)ar=d[J],aB.isClockWise(ar)&&(d[J]=ar.reverse())}for(A=aB.triangulateShape(f,d),h=f,ag=0,aH=d.length;ag<aH;ag++)aC=d[ag],f=f.concat(aC);function s(b,a,c){return a||console.error("THREE.ExtrudeGeometry: vec does not exist"),a.clone().multiplyScalar(c).add(b)}n=f.length,L=A.length;function aq(h,k,j){var f,g,i,a=h.x-k.x,b=h.y-k.y,d=j.x-h.x,e=j.y-h.y,m=a*a+b*b,t=a*e-b*d,s,o,p,q,r,n,l;if(Math.abs(t)>Number.EPSILON){if(s=Math.sqrt(m),o=Math.sqrt(d*d+e*e),p=k.x-b/s,q=k.y+a/s,r=((j.x-e/o-p)*e-(j.y+d/o-q)*d)/(a*e-b*d),n=(f=p+a*r-h.x)*f+(g=q+b*r-h.y)*g,n<=2)return new c(f,g);i=Math.sqrt(n/2)}else l=!1,a>Number.EPSILON?d>Number.EPSILON&&(l=!0):a<-Number.EPSILON?d<-Number.EPSILON&&(l=!0):Math.sign(b)===Math.sign(e)&&(l=!0),l?(f=-b,g=a,i=Math.sqrt(m)):(f=a,g=b,i=Math.sqrt(m/2));return new c(f/i,g/i)}for(N=[],D=0,P=h.length,Q=P-1,R=D+1;D<P;D++,Q++,R++)Q===P&&(Q=0),R===P&&(R=0),N[D]=aq(h[D],h[Q],h[R]);for(p,ai=[],U=N.concat(),ac=0,aI=d.length;ac<aI;ac++){ab=d[ac],p=[];for(z=0,Z=ab.length,_=Z-1,$=z+1;z<Z;z++,_++,$++)_===Z&&(_=0),$===Z&&($=0),p[z]=aq(ab[z],ab[_],ab[$]);ai.push(p),U=U.concat(p)}for(ah=0;ah<q;ah++){for(av=ah/q,az=E*Math.cos(av*Math.PI/2),aw=X*Math.sin(av*Math.PI/2)+V,O=0,aK=h.length;O<aK;O++)at=s(h[O],N[O],aw),l(at.x,at.y,-az);for(aa=0,aJ=d.length;aa<aJ;aa++){ao=d[aa],p=ai[aa];for(W=0,aE=ao.length;W<aE;W++)am=s(ao[W],p[W],aw),l(am.x,am.y,-az)}}for(an=X+V,C=0;C<n;C++)T=y?s(f[C],U[C],an):f[C],M?(v.copy(x.normals[0]).multiplyScalar(T.x),w.copy(x.binormals[0]).multiplyScalar(T.y),m.copy(u[0]).add(v).add(w),l(m.x,m.y,m.z)):l(T.x,T.y,0);for(t=1;t<=g;t++)for(B=0;B<n;B++)I=y?s(f[B],U[B],an):f[B],M?(v.copy(x.normals[t]).multiplyScalar(I.x),w.copy(x.binormals[t]).multiplyScalar(I.y),m.copy(u[t]).add(v).add(w),l(m.x,m.y,m.z)):l(I.x,I.y,Y/g*t);for(af=q-1;af>=0;af--){for(ay=af/q,ad=E*Math.cos(ay*Math.PI/2),ax=X*Math.sin(ay*Math.PI/2)+V,H=0,aN=h.length;H<aN;H++)aj=s(h[H],N[H],ax),l(aj.x,aj.y,Y+ad);for(G=0,aD=d.length;G<aD;G++){al=d[G],p=ai[G];for(F=0,aG=al.length;F<aG;F++)K=s(al[F],p[F],ax),M?l(K.x,K.y+u[g-1].y,u[g-1].x+ad):l(K.x,K.y,Y+ad)}}function ak(e,a){for(var d=e.length,f,b,c,j,h,i;--d>=0;){f=d,b=d-1,b<0&&(b=e.length-1);for(c=0,j=g+2*q;c<j;c++)h=n*c,i=n*(c+1),aL(a+f+h,a+b+h,a+b+i,a+f+i)}}function l(a,b,c){r.push(a),r.push(b),r.push(c)}function S(c,d,f){k(c),k(d),k(f);var a=e.length/3,b=au.generateTopUV(i,e,a-3,a-2,a-1);o(b[0]),o(b[1]),o(b[2])}function aL(f,c,g,d){k(f),k(c),k(d),k(c),k(g),k(d);var b=e.length/3,a=au.generateSideWallUV(i,e,b-6,b-3,b-2,b-1);o(a[0]),o(a[1]),o(a[3]),o(a[1]),o(a[2]),o(a[3])}function k(a){e.push(r[3*a+0]),e.push(r[3*a+1]),e.push(r[3*a+2])}function o(a){j.push(a.x),j.push(a.y)}!function(){var m=e.length/3,o,a,d,f,h,b,c,j,k,l;if(y){for(o=0,a=n*o,d=0;d<L;d++)f=A[d],S(f[2]+a,f[1]+a,f[0]+a);a=n*(o=g+2*q);for(h=0;h<L;h++)b=A[h],S(b[0]+a,b[1]+a,b[2]+a)}else{for(c=0;c<L;c++)j=A[c],S(j[2],j[1],j[0]);for(k=0;k<L;k++)l=A[k],S(l[0]+n*g,l[1]+n*g,l[2]+n*g)}i.addGroup(m,e.length/3-m,0)}(),function(){var c=e.length/3,a=0,b,g,f;ak(h,a),a+=h.length;for(b=0,g=d.length;b<g;b++)f=d[b],ak(f,a),a+=f.length;i.addGroup(c,e.length/3-c,1)}()}return h.setAttribute("position",new f(e,3)),h.setAttribute("uv",new f(j,2)),h.computeVertexNormals(),h}return m(a,d),a.prototype.toJSON=function(){var a=i.prototype.toJSON.call(this);return function(b,d,a){var c,e,f;if(a.shapes=[],Array.isArray(b))for(c=0,e=b.length;c<e;c++)f=b[c],a.shapes.push(f.uuid);else a.shapes.push(b.uuid);return void 0!==d.extrudePath&&(a.options.extrudePath=d.extrudePath.toJSON()),a}(this.parameters.shapes,this.parameters.options,a)},a}(i),jR={generateTopUV:function(l,a,b,d,e){var g=a[3*b],f=a[3*b+1],h=a[3*d],i=a[3*d+1],j=a[3*e],k=a[3*e+1];return[new c(g,f),new c(h,i),new c(j,k)]},generateSideWallUV:function(s,a,b,d,e,f){var p=a[3*b],i=a[3*b+1],j=a[3*b+2],m=a[3*d],l=a[3*d+1],g=a[3*d+2],n=a[3*e],o=a[3*e+1],h=a[3*e+2],q=a[3*f],r=a[3*f+1],k=a[3*f+2];return Math.abs(i-l)<.01?[new c(p,1-j),new c(m,1-g),new c(n,1-h),new c(q,1-k)]:[new c(i,1-j),new c(l,1-g),new c(o,1-h),new c(r,1-k)]}},dU=function(a){function b(c,d){var e,b,f;return void 0===c&&(c=1),void 0===d&&(d=0),b=(1+Math.sqrt(5))/2,f=[-1,b,0,1,b,0,-1,-b,0,1,-b,0,0,-1,b,0,1,b,0,-1,-b,0,1,-b,b,0,-1,b,0,1,-b,0,-1,-b,0,1],(e=a.call(this,f,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],c,d)||this).type="IcosahedronGeometry",e.parameters={radius:c,detail:d},e}return m(b,a),b}(aT),dV=function(a){function d(g,h,o,j){var i,v,C,y,I,k,p,q,A,H,G,n,x,w,s,E,z,F,B,e,u,t,r,m,D,d;void 0===h&&(h=12),void 0===o&&(o=0),void 0===j&&(j=2*Math.PI),(i=a.call(this)||this).type="LatheGeometry",i.parameters={points:g,segments:h,phiStart:o,phiLength:j},h=Math.floor(h),j=l.clamp(j,0,2*Math.PI);for(v=[],C=[],y=[],I=1/h,k=new b,p=new c,q=0;q<=h;q++)for(A=o+q*I*j,H=Math.sin(A),G=Math.cos(A),n=0;n<=g.length-1;n++)k.x=g[n].x*H,k.y=g[n].y,k.z=g[n].x*G,C.push(k.x,k.y,k.z),p.x=q/h,p.y=n/(g.length-1),y.push(p.x,p.y);for(x=0;x<h;x++)for(w=0;w<g.length-1;w++)s=w+x*g.length,E=s,z=s+g.length,F=s+g.length+1,B=s+1,v.push(E,z,B),v.push(z,F,B);if(i.setIndex(v),i.setAttribute("position",new f(C,3)),i.setAttribute("uv",new f(y,2)),i.computeVertexNormals(),j===2*Math.PI)for(e=i.attributes.normal.array,u=new b,t=new b,r=new b,m=h*g.length*3,D=0,d=0;D<g.length;D++,d+=3)u.x=e[d+0],u.y=e[d+1],u.z=e[d+2],t.x=e[m+d+0],t.y=e[m+d+1],t.z=e[m+d+2],r.addVectors(u,t).normalize(),e[d+0]=e[m+d+0]=r.x,e[d+1]=e[m+d+1]=r.y,e[d+2]=e[m+d+2]=r.z;return i}return m(d,a),d}(i),co=function(a){function b(b,c){var d;return void 0===b&&(b=1),void 0===c&&(c=0),(d=a.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],b,c)||this).type="OctahedronGeometry",d.parameters={radius:b,detail:c},d}return m(b,a),b}(aT);function bV(k,l,q){var p,w,v,u,g,n,c,a,o,t,m,r,d,s,e,j,h,z,x,A,y;i.call(this),this.type="ParametricGeometry",this.parameters={func:k,slices:l,stacks:q},p=[],w=[],v=[],u=[],g=1e-5,n=new b,c=new b,a=new b,o=new b,t=new b,k.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(m=l+1,r=0;r<=q;r++)for(d=r/q,s=0;s<=l;s++)e=s/l,k(e,d,c),w.push(c.x,c.y,c.z),e-g>=0?(k(e-g,d,a),o.subVectors(c,a)):(k(e+g,d,a),o.subVectors(a,c)),d-g>=0?(k(e,d-g,a),t.subVectors(c,a)):(k(e,d+g,a),t.subVectors(a,c)),n.crossVectors(o,t).normalize(),v.push(n.x,n.y,n.z),u.push(e,d);for(j=0;j<q;j++)for(h=0;h<l;h++)z=j*m+h,x=j*m+h+1,A=(j+1)*m+h+1,y=(j+1)*m+h,p.push(z,x,y),p.push(x,A,y);this.setIndex(p),this.setAttribute("position",new f(w,3)),this.setAttribute("normal",new f(v,3)),this.setAttribute("uv",new f(u,2))}bV.prototype=Object.create(i.prototype),bV.prototype.constructor=bV,dW=function(a){function d(j,i,d,g,l,n){var e,r,y,x,v,q,A,h,k,t,s,u,p,D,o,m,B,z,C,w;void 0===j&&(j=.5),void 0===i&&(i=1),void 0===d&&(d=8),void 0===g&&(g=1),void 0===l&&(l=0),void 0===n&&(n=2*Math.PI),(e=a.call(this)||this).type="RingGeometry",e.parameters={innerRadius:j,outerRadius:i,thetaSegments:d,phiSegments:g,thetaStart:l,thetaLength:n},d=Math.max(3,d);for(r=[],y=[],x=[],v=[],q=j,A=(i-j)/(g=Math.max(1,g)),h=new b,k=new c,t=0;t<=g;t++){for(s=0;s<=d;s++)u=l+s/d*n,h.x=q*Math.cos(u),h.y=q*Math.sin(u),y.push(h.x,h.y,h.z),x.push(0,0,1),k.x=(h.x/i+1)/2,k.y=(h.y/i+1)/2,v.push(k.x,k.y);q+=A}for(p=0;p<g;p++)for(D=p*(d+1),o=0;o<d;o++)m=o+D,B=m,z=m+d+1,C=m+d+2,w=m+1,r.push(B,z,w),r.push(z,C,w);return e.setIndex(r),e.setAttribute("position",new f(y,3)),e.setAttribute("normal",new f(x,3)),e.setAttribute("uv",new f(v,2)),e}return m(d,a),d}(i),cu=function(b){function a(c,d){var a,l,h,i,j,k,g,e;if(void 0===d&&(d=12),(a=b.call(this)||this).type="ShapeGeometry",a.parameters={shapes:c,curveSegments:d},l=[],h=[],i=[],j=[],k=0,g=0,!1===Array.isArray(c))m(c);else for(e=0;e<c.length;e++)m(c[e]),a.addGroup(k,g,e),k+=g,g=0;function m(s){var k=h.length/3,p=s.extractPoints(d),a=p.shape,b=p.holes,c,x,q,r,n,v,u,f,t,e,o,w,m,y,z,A;!1===aB.isClockWise(a)&&(a=a.reverse());for(c=0,x=b.length;c<x;c++)q=b[c],!0===aB.isClockWise(q)&&(b[c]=q.reverse());for(r=aB.triangulateShape(a,b),n=0,v=b.length;n<v;n++)u=b[n],a=a.concat(u);for(f=0,t=a.length;f<t;f++)e=a[f],h.push(e.x,e.y,0),i.push(0,0,1),j.push(e.x,e.y);for(o=0,w=r.length;o<w;o++)m=r[o],y=m[0]+k,z=m[1]+k,A=m[2]+k,l.push(y,z,A),g+=3}return a.setIndex(l),a.setAttribute("position",new f(h,3)),a.setAttribute("normal",new f(i,3)),a.setAttribute("uv",new f(j,2)),a}return m(a,b),a.prototype.toJSON=function(){var a=i.prototype.toJSON.call(this);return function(a,b){var c,d,e;if(b.shapes=[],Array.isArray(a))for(c=0,d=a.length;c<d;c++)e=a[c],b.shapes.push(e.uuid);else b.shapes.push(a.uuid);return b}(this.parameters.shapes,a)},a}(i),cv=function(a){function c(k,c,d,o,m,e,j){var h,B,E,n,i,r,u,w,z,y,p,x,q,v,t,s,g,l,D,A,F,C;void 0===k&&(k=1),void 0===c&&(c=8),void 0===d&&(d=6),void 0===o&&(o=0),void 0===m&&(m=2*Math.PI),void 0===e&&(e=0),void 0===j&&(j=Math.PI),(h=a.call(this)||this).type="SphereGeometry",h.parameters={radius:k,widthSegments:c,heightSegments:d,phiStart:o,phiLength:m,thetaStart:e,thetaLength:j},c=Math.max(3,Math.floor(c)),d=Math.max(2,Math.floor(d));for(B=Math.min(e+j,Math.PI),E=0,n=[],i=new b,r=new b,u=[],w=[],z=[],y=[],p=0;p<=d;p++){x=[],q=p/d,v=0,0==p&&0==e?v=.5/c:p==d&&B==Math.PI&&(v=-.5/c);for(t=0;t<=c;t++)s=t/c,i.x=-k*Math.cos(o+s*m)*Math.sin(e+q*j),i.y=k*Math.cos(e+q*j),i.z=k*Math.sin(o+s*m)*Math.sin(e+q*j),w.push(i.x,i.y,i.z),r.copy(i).normalize(),z.push(r.x,r.y,r.z),y.push(s+v,1-q),x.push(E++);n.push(x)}for(g=0;g<d;g++)for(l=0;l<c;l++)D=n[g][l+1],A=n[g][l],F=n[g+1][l],C=n[g+1][l+1],(0!==g||e>0)&&u.push(D,A,C),(g!==d-1||B<Math.PI)&&u.push(A,F,C);return h.setIndex(u),h.setAttribute("position",new f(w,3)),h.setAttribute("normal",new f(z,3)),h.setAttribute("uv",new f(y,2)),h}return m(c,a),c}(i),ea=function(a){function b(b,c){var d;return void 0===b&&(b=1),void 0===c&&(c=0),(d=a.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],b,c)||this).type="TetrahedronGeometry",d.parameters={radius:b,detail:c},d}return m(b,a),b}(aT),eb=function(a){function b(e,b){var c,d,f;return void 0===b&&(b={}),d=b.font,!d||!d.isFont?(console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new i||ap(c)):(f=d.generateShapes(e,b.size),b.depth=void 0!==b.height?b.height:50,void 0===b.bevelThickness&&(b.bevelThickness=10),void 0===b.bevelSize&&(b.bevelSize=8),void 0===b.bevelEnabled&&(b.bevelEnabled=!1),(c=a.call(this,f,b)||this).type="TextGeometry",c)}return m(b,a),b}(bg),ed=function(a){function c(h,i,d,c,p){var e,t,v,u,r,q,g,o,n,m,l,s,k,j,y,w,z,x;void 0===h&&(h=1),void 0===i&&(i=.4),void 0===d&&(d=8),void 0===c&&(c=6),void 0===p&&(p=2*Math.PI),(e=a.call(this)||this).type="TorusGeometry",e.parameters={radius:h,tube:i,radialSegments:d,tubularSegments:c,arc:p},d=Math.floor(d),c=Math.floor(c);for(t=[],v=[],u=[],r=[],q=new b,g=new b,o=new b,n=0;n<=d;n++)for(m=0;m<=c;m++)l=m/c*p,s=n/d*Math.PI*2,g.x=(h+i*Math.cos(s))*Math.cos(l),g.y=(h+i*Math.cos(s))*Math.sin(l),g.z=i*Math.sin(s),v.push(g.x,g.y,g.z),q.x=h*Math.cos(l),q.y=h*Math.sin(l),o.subVectors(g,q).normalize(),u.push(o.x,o.y,o.z),r.push(m/c),r.push(n/d);for(k=1;k<=d;k++)for(j=1;j<=c;j++)y=(c+1)*k+j-1,w=(c+1)*(k-1)+j-1,z=(c+1)*(k-1)+j,x=(c+1)*k+j,t.push(y,w,x),t.push(w,z,x);return e.setIndex(t),e.setAttribute("position",new f(v,3)),e.setAttribute("normal",new f(u,3)),e.setAttribute("uv",new f(r,2)),e}return m(c,a),c}(i),ee=function(a){function c(p,n,d,c,k,o){var h,v,B,C,t,g,q,e,x,m,u,i,s,A,r,z,y,w,l,j,G,D,H,E;void 0===p&&(p=1),void 0===n&&(n=.4),void 0===d&&(d=64),void 0===c&&(c=8),void 0===k&&(k=2),void 0===o&&(o=3),(h=a.call(this)||this).type="TorusKnotGeometry",h.parameters={radius:p,tube:n,tubularSegments:d,radialSegments:c,p:k,q:o},d=Math.floor(d),c=Math.floor(c);for(v=[],B=[],C=[],t=[],g=new b,q=new b,e=new b,x=new b,m=new b,u=new b,i=new b,s=0;s<=d;++s){A=s/d*k*Math.PI*2,F(A,k,o,p,e),F(A+.01,k,o,p,x),u.subVectors(x,e),i.addVectors(x,e),m.crossVectors(u,i),i.crossVectors(m,u),m.normalize(),i.normalize();for(r=0;r<=c;++r)z=r/c*Math.PI*2,y=-n*Math.cos(z),w=n*Math.sin(z),g.x=e.x+(y*i.x+w*m.x),g.y=e.y+(y*i.y+w*m.y),g.z=e.z+(y*i.z+w*m.z),B.push(g.x,g.y,g.z),q.subVectors(g,e).normalize(),C.push(q.x,q.y,q.z),t.push(s/d),t.push(r/c)}for(l=1;l<=d;l++)for(j=1;j<=c;j++)G=(c+1)*(l-1)+(j-1),D=(c+1)*l+(j-1),H=(c+1)*l+j,E=(c+1)*(l-1)+j,v.push(G,D,E),v.push(D,H,E);function F(a,h,i,b,c){var f=Math.cos(a),g=Math.sin(a),d=i/h*a,e=Math.cos(d);c.x=b*(2+e)*.5*f,c.y=b*(2+e)*g*.5,c.z=b*Math.sin(d)*.5}return h.setIndex(v),h.setAttribute("position",new f(B,3)),h.setAttribute("normal",new f(C,3)),h.setAttribute("uv",new f(t,2)),h}return m(c,a),c}(i),eg=function(d){function a(o,e,j,a,l){var h,m,i,g,n,k,s,q,r,p;void 0===e&&(e=64),void 0===j&&(j=1),void 0===a&&(a=8),void 0===l&&(l=!1),(h=d.call(this)||this).type="TubeGeometry",h.parameters={path:o,tubularSegments:e,radius:j,radialSegments:a,closed:l},m=o.computeFrenetFrames(e,l),h.tangents=m.tangents,h.normals=m.normals,h.binormals=m.binormals,i=new b,g=new b,n=new c,k=new b,s=[],q=[],r=[],p=[];function t(n){var c,d,f,l,h,b;k=o.getPointAt(n/e,k);for(c=m.normals[n],d=m.binormals[n],f=0;f<=a;f++)l=f/a*Math.PI*2,h=Math.sin(l),b=-Math.cos(l),g.x=b*c.x+h*d.x,g.y=b*c.y+h*d.y,g.z=b*c.z+h*d.z,g.normalize(),q.push(g.x,g.y,g.z),i.x=k.x+j*g.x,i.y=k.y+j*g.y,i.z=k.z+j*g.z,s.push(i.x,i.y,i.z)}return function(){for(var b=0;b<e;b++)t(b);t(!1===l?e:0),function(){for(var b=0,c;b<=e;b++)for(c=0;c<=a;c++)n.x=b/e,n.y=c/a,r.push(n.x,n.y)}(),function(){for(var b=1,c,g,d,h,f;b<=e;b++)for(c=1;c<=a;c++)g=(a+1)*(b-1)+(c-1),d=(a+1)*b+(c-1),h=(a+1)*b+c,f=(a+1)*(b-1)+c,p.push(g,d,f),p.push(d,h,f)}()}(),h.setIndex(p),h.setAttribute("position",new f(s,3)),h.setAttribute("normal",new f(q,3)),h.setAttribute("uv",new f(r,2)),h}return m(a,d),a.prototype.toJSON=function(){var a=i.prototype.toJSON.call(this);return a.path=this.parameters.path.toJSON(),a},a}(i),eA=function(a){function c(d){var h,g,e,i,c,s,p,l,q,B,w,r,n,z,m,t,u,v,y,x,o,k,A,j,C,D;if((h=a.call(this)||this).type="WireframeGeometry",!0===d.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ap(h);if(g=[],e=[0,0],i={},c=new b,null!==d.index){s=d.attributes.position,p=d.index,l=d.groups,0===l.length&&(l=[{start:0,count:p.count,materialIndex:0}]);for(q=0,B=l.length;q<B;++q)for(w=l[q],r=w.start,n=r,z=r+w.count;n<z;n+=3)for(m=0;m<3;m++)t=p.getX(n+m),u=p.getX(n+(m+1)%3),e[0]=Math.min(t,u),e[1]=Math.max(t,u),v=e[0]+","+e[1],void 0===i[v]&&(i[v]={index1:e[0],index2:e[1]});for(y in i)x=i[y],c.fromBufferAttribute(s,x.index1),g.push(c.x,c.y,c.z),c.fromBufferAttribute(s,x.index2),g.push(c.x,c.y,c.z)}else for(o=d.attributes.position,k=0,A=o.count/3;k<A;k++)for(j=0;j<3;j++)C=3*k+j,c.fromBufferAttribute(o,C),g.push(c.x,c.y,c.z),D=3*k+(j+1)%3,c.fromBufferAttribute(o,D),g.push(c.x,c.y,c.z);return h.setAttribute("position",new f(g,3)),h}return m(c,a),c}(i),J=Object.freeze({__proto__:null,BoxGeometry:bf,BoxBufferGeometry:bf,CircleGeometry:dE,CircleBufferGeometry:dE,ConeGeometry:dJ,ConeBufferGeometry:dJ,CylinderGeometry:ca,CylinderBufferGeometry:ca,DodecahedronGeometry:cS,DodecahedronBufferGeometry:cS,EdgesGeometry:eZ,ExtrudeGeometry:bg,ExtrudeBufferGeometry:bg,IcosahedronGeometry:dU,IcosahedronBufferGeometry:dU,LatheGeometry:dV,LatheBufferGeometry:dV,OctahedronGeometry:co,OctahedronBufferGeometry:co,ParametricGeometry:bV,ParametricBufferGeometry:bV,PlaneGeometry:cB,PlaneBufferGeometry:cB,PolyhedronGeometry:aT,PolyhedronBufferGeometry:aT,RingGeometry:dW,RingBufferGeometry:dW,ShapeGeometry:cu,ShapeBufferGeometry:cu,SphereGeometry:cv,SphereBufferGeometry:cv,TetrahedronGeometry:ea,TetrahedronBufferGeometry:ea,TextGeometry:eb,TextBufferGeometry:eb,TorusGeometry:ed,TorusBufferGeometry:ed,TorusKnotGeometry:ee,TorusKnotBufferGeometry:ee,TubeGeometry:eg,TubeBufferGeometry:eg,WireframeGeometry:eA});function bN(a){j.call(this),this.type="ShadowMaterial",this.color=new e(0),this.transparent=!0,this.setValues(a)}function aS(a){M.call(this,a),this.type="RawShaderMaterial"}function aC(a){j.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new e(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(a)}function aY(a){aC.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new c(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(a){this.reflectivity=l.clamp(2.5*(a-1)/(a+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(a)}function aZ(a){j.call(this),this.type="MeshPhongMaterial",this.color=new e(16777215),this.specular=new e(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function bJ(a){j.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new e(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function bI(a){j.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function bH(a){j.call(this),this.type="MeshLambertMaterial",this.color=new e(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function bE(a){j.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new e(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new c(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(a)}function bC(a){w.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(a)}bN.prototype=Object.create(j.prototype),bN.prototype.constructor=bN,bN.prototype.isShadowMaterial=!0,bN.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this},aS.prototype=Object.create(M.prototype),aS.prototype.constructor=aS,aS.prototype.isRawShaderMaterial=!0,aC.prototype=Object.create(j.prototype),aC.prototype.constructor=aC,aC.prototype.isMeshStandardMaterial=!0,aC.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.defines={STANDARD:""},this.color.copy(a.color),this.roughness=a.roughness,this.metalness=a.metalness,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.roughnessMap=a.roughnessMap,this.metalnessMap=a.metalnessMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.envMapIntensity=a.envMapIntensity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this.vertexTangents=a.vertexTangents,this},aY.prototype=Object.create(aC.prototype),aY.prototype.constructor=aY,aY.prototype.isMeshPhysicalMaterial=!0,aY.prototype.copy=function(a){return aC.prototype.copy.call(this,a),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=a.clearcoat,this.clearcoatMap=a.clearcoatMap,this.clearcoatRoughness=a.clearcoatRoughness,this.clearcoatRoughnessMap=a.clearcoatRoughnessMap,this.clearcoatNormalMap=a.clearcoatNormalMap,this.clearcoatNormalScale.copy(a.clearcoatNormalScale),this.reflectivity=a.reflectivity,a.sheen?this.sheen=(this.sheen||new e).copy(a.sheen):this.sheen=null,this.transmission=a.transmission,this.transmissionMap=a.transmissionMap,this},aZ.prototype=Object.create(j.prototype),aZ.prototype.constructor=aZ,aZ.prototype.isMeshPhongMaterial=!0,aZ.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.specular.copy(a.specular),this.shininess=a.shininess,this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},bJ.prototype=Object.create(j.prototype),bJ.prototype.constructor=bJ,bJ.prototype.isMeshToonMaterial=!0,bJ.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.gradientMap=a.gradientMap,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},bI.prototype=Object.create(j.prototype),bI.prototype.constructor=bI,bI.prototype.isMeshNormalMaterial=!0,bI.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},bH.prototype=Object.create(j.prototype),bH.prototype.constructor=bH,bH.prototype.isMeshLambertMaterial=!0,bH.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.color.copy(a.color),this.map=a.map,this.lightMap=a.lightMap,this.lightMapIntensity=a.lightMapIntensity,this.aoMap=a.aoMap,this.aoMapIntensity=a.aoMapIntensity,this.emissive.copy(a.emissive),this.emissiveMap=a.emissiveMap,this.emissiveIntensity=a.emissiveIntensity,this.specularMap=a.specularMap,this.alphaMap=a.alphaMap,this.envMap=a.envMap,this.combine=a.combine,this.reflectivity=a.reflectivity,this.refractionRatio=a.refractionRatio,this.wireframe=a.wireframe,this.wireframeLinewidth=a.wireframeLinewidth,this.wireframeLinecap=a.wireframeLinecap,this.wireframeLinejoin=a.wireframeLinejoin,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},bE.prototype=Object.create(j.prototype),bE.prototype.constructor=bE,bE.prototype.isMeshMatcapMaterial=!0,bE.prototype.copy=function(a){return j.prototype.copy.call(this,a),this.defines={MATCAP:""},this.color.copy(a.color),this.matcap=a.matcap,this.map=a.map,this.bumpMap=a.bumpMap,this.bumpScale=a.bumpScale,this.normalMap=a.normalMap,this.normalMapType=a.normalMapType,this.normalScale.copy(a.normalScale),this.displacementMap=a.displacementMap,this.displacementScale=a.displacementScale,this.displacementBias=a.displacementBias,this.alphaMap=a.alphaMap,this.skinning=a.skinning,this.morphTargets=a.morphTargets,this.morphNormals=a.morphNormals,this},bC.prototype=Object.create(w.prototype),bC.prototype.constructor=bC,bC.prototype.isLineDashedMaterial=!0,bC.prototype.copy=function(a){return w.prototype.copy.call(this,a),this.scale=a.scale,this.dashSize=a.dashSize,this.gapSize=a.gapSize,this},iR=Object.freeze({__proto__:null,ShadowMaterial:bN,SpriteMaterial:bw,RawShaderMaterial:aS,ShaderMaterial:M,PointsMaterial:ak,MeshPhysicalMaterial:aY,MeshStandardMaterial:aC,MeshPhongMaterial:aZ,MeshToonMaterial:bJ,MeshNormalMaterial:bI,MeshLambertMaterial:bH,MeshDepthMaterial:bl,MeshDistanceMaterial:bx,MeshBasicMaterial:W,MeshMatcapMaterial:bE,LineDashedMaterial:bC,LineBasicMaterial:w,Material:j}),u={arraySlice:function(a,c,b){return u.isTypedArray(a)?new a.constructor(a.subarray(c,void 0!==b?b:a.length)):a.slice(c,b)},convertArray:function(a,b,c){return!a||!c&&a.constructor===b?a:"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(b){for(var d=b.length,c=new Array(d),a=0;a!==d;++a)c[a]=a;return c.sort(function(a,c){return b[a]-b[c]}),c},sortedArray:function(a,c,i){for(var d=a.length,e=new a.constructor(d),f=0,g=0,h,b;g!==d;++f)for(h=i[f]*c,b=0;b!==c;++b)e[g++]=a[h+b];return e},flattenJSON:function(e,g,c,d){for(var f=1,a=e[0],b;void 0!==a&&void 0===a[d];)a=e[f++];if(void 0!==a)if(b=a[d],void 0!==b)if(Array.isArray(b))do void 0!==(b=a[d])&&(g.push(a.time),c.push.apply(c,b)),a=e[f++];while(void 0!==a)else if(void 0!==b.toArray)do void 0!==(b=a[d])&&(g.push(a.time),b.toArray(c,c.length)),a=e[f++];while(void 0!==a)else do void 0!==(b=a[d])&&(g.push(a.time),c.push(b)),a=e[f++];while(void 0!==a)},subclip:function(r,q,p,o,m){var a,k,h,b,j,g,l,c,n,f,i,d,e;void 0===m&&(m=30),a=r.clone(),a.name=q;for(k=[],h=0;h<a.tracks.length;++h){for(b=a.tracks[h],j=b.getValueSize(),g=[],l=[],c=0;c<b.times.length;++c)if(n=b.times[c]*m,!(n<p||n>=o)){g.push(b.times[c]);for(f=0;f<j;++f)l.push(b.values[c*j+f])}0!==g.length&&(b.times=u.convertArray(g,b.times.constructor),b.values=u.convertArray(l,b.values.constructor),k.push(b))}a.tracks=k;for(i=1/0,d=0;d<a.tracks.length;++d)i>a.tracks[d].times[0]&&(i=a.tracks[d].times[0]);for(e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*i);return a.resetDuration(),a},makeClipAdditive:function(b,d,c,a){void 0===d&&(d=0),void 0===c&&(c=b),void 0===a&&(a=30),a<=0&&(a=30);for(var g=c.tracks.length,e=d/a,h=function(z){var a=c.tracks[z],h=a.ValueTypeName,f,g,i,m,l,o,d,x,r,p,w,q,s,t,v,k,n,y,j;if("bool"===h||"string"===h)return"continue";if(f=b.tracks.find(function(b){return b.name===a.name&&b.ValueTypeName===h}),void 0===f)return"continue";g=0,i=a.getValueSize(),a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=i/3),m=0,l=f.getValueSize(),f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=l/3),o=a.times.length-1,d=void 0,e<=a.times[0]?(x=g,r=i-g,d=u.arraySlice(a.values,x,r)):e>=a.times[o]?(p=o*i+g,w=p+i-g,d=u.arraySlice(a.values,p,w)):(q=a.createInterpolant(),s=g,t=i-g,q.evaluate(e),d=u.arraySlice(q.resultBuffer,s,t)),"quaternion"===h&&(new G).fromArray(d).normalize().conjugate().toArray(d);for(v=f.times.length,k=0;k<v;++k)if(n=k*l+m,"quaternion"===h)G.multiplyQuaternionsFlat(f.values,n,d,0,f.values,n);else for(y=l-2*m,j=0;j<y;++j)f.values[n+j]-=d[j]},f=0;f<g;++f)h(f);return b.blendMode=ff,b}};function S(d,a,b,c){this.parameterPositions=d,this._cachedIndex=0,this.resultBuffer=void 0!==c?c:new a.constructor(b),this.sampleValues=a,this.valueSize=b}function ey(a,b,c,d){S.call(this,a,b,c,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ej(a,b,c,d){S.call(this,a,b,c,d)}function eB(a,b,c,d){S.call(this,a,b,c,d)}function F(a,b,c,d){if(void 0===a)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=u.convertArray(b,this.TimeBufferType),this.values=u.convertArray(c,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}function eC(a,b,c){F.call(this,a,b,c)}function eD(a,b,c,d){F.call(this,a,b,c,d)}function cK(a,b,c,d){F.call(this,a,b,c,d)}function eF(a,b,c,d){S.call(this,a,b,c,d)}function ec(a,b,c,d){F.call(this,a,b,c,d)}function eG(a,b,c,d){F.call(this,a,b,c,d)}function cO(a,b,c,d){F.call(this,a,b,c,d)}function X(c,a,d,b){void 0===a&&(a=-1),void 0===b&&(b=ek),this.name=c,this.tracks=d,this.duration=a,this.blendMode=b,this.uuid=l.generateUUID(),this.duration<0&&this.resetDuration()}function ll(a){var b,c,d;if(void 0===a.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");return b=function(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cK;case"vector":case"vector2":case"vector3":case"vector4":return cO;case"color":return eD;case"quaternion":return ec;case"bool":case"boolean":return eC;case"string":return eG}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}(a.type),void 0===a.times&&(c=[],d=[],u.flattenJSON(a.keys,c,d,"value"),a.times=c,a.values=d),void 0!==b.parse?b.parse(a):new b(a.name,a.times,a.values,a.interpolation)}Object.assign(S.prototype,{evaluate:function(b){var d=this.parameterPositions,a=this._cachedIndex,e=d[a],c=d[a-1],f,i,h,j,g;t:{e:{f;n:{i:if(!(b<e)){for(i=a+2;;){if(void 0===e){if(b<c)break i;return a=d.length,this._cachedIndex=a,this.afterEnd_(a-1,b,c)}if(a===i)break;if(c=e,b<(e=d[++a]))break e}f=d.length;break n}if(b>=c)break t;h=d[1];b<h&&(a=2,c=h);for(j=a-2;;){if(void 0===c)return this._cachedIndex=0,this.beforeStart_(0,b,e);if(a===j)break;if(e=c,b>=(c=d[--a-1]))break e}f=a,a=0}for(;a<f;)g=a+f>>>1,b<d[g]?f=g:a=g+1;if(e=d[a],void 0===(c=d[a-1]))return this._cachedIndex=0,this.beforeStart_(0,b,e);if(void 0===e)return a=d.length,this._cachedIndex=a,this.afterEnd_(a-1,c,b)}this._cachedIndex=a,this.intervalChanged_(a,c,e)}return this.interpolate_(a,c,b,e)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(d){for(var b=this.resultBuffer,e=this.sampleValues,c=this.valueSize,f=d*c,a=0;a!==c;++a)b[a]=e[f+a];return b},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(S.prototype,{beforeStart_:S.prototype.copySampleValue_,afterEnd_:S.prototype.copySampleValue_}),ey.prototype=Object.assign(Object.create(S.prototype),{constructor:ey,DefaultSettings_:{endingStart:bn,endingEnd:bn},intervalChanged_:function(b,c,d){var a=this.parameterPositions,e=b-2,f=b+1,g=a[e],h=a[f],i,j;if(void 0===g)switch(this.getSettings_().endingStart){case bm:e=b,g=2*c-d;break;case cg:g=c+a[e=a.length-2]-a[e+1];break;default:e=b,g=d}if(void 0===h)switch(this.getSettings_().endingEnd){case bm:f=b,h=2*d-c;break;case cg:f=1,h=d+a[1]-a[0];break;default:f=b-1,h=c}i=.5*(d-c),j=this.valueSize,this._weightPrev=i/(c-g),this._weightNext=i/(h-d),this._offsetPrev=e*j,this._offsetNext=f*j},interpolate_:function(u,i,p,o){for(var k=this.resultBuffer,e=this.sampleValues,h=this.valueSize,j=u*h,n=j-h,m=this._offsetPrev,l=this._offsetNext,b=this._weightPrev,g=this._weightNext,c=(p-i)/(o-i),d=c*c,f=d*c,q=-b*f+2*b*d-b*c,r=(1+b)*f+(-1.5-2*b)*d+(-.5+b)*c+1,s=(-1-g)*f+(1.5+g)*d+.5*c,t=g*f-g*d,a=0;a!==h;++a)k[a]=q*e[m+a]+r*e[n+a]+s*e[j+a]+t*e[l+a];return k}}),ej.prototype=Object.assign(Object.create(S.prototype),{constructor:ej,interpolate_:function(i,c,h,k){for(var e=this.resultBuffer,g=this.sampleValues,b=this.valueSize,f=i*b,j=f-b,d=(h-c)/(k-c),l=1-d,a=0;a!==b;++a)e[a]=g[j+a]*l+g[f+a]*d;return e}}),eB.prototype=Object.assign(Object.create(S.prototype),{constructor:eB,interpolate_:function(a){return this.copySampleValue_(a-1)}}),Object.assign(F,{toJSON:function(a){var b,c=a.constructor,d;return void 0!==c.toJSON?b=c.toJSON(a):(b={name:a.name,times:u.convertArray(a.times,Array),values:u.convertArray(a.values,Array)},d=a.getInterpolation(),d!==a.DefaultInterpolation&&(b.interpolation=d)),b.type=a.ValueTypeName,b}}),Object.assign(F.prototype,{constructor:F,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:cf,InterpolantFactoryMethodDiscrete:function(a){return new eB(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodLinear:function(a){return new ej(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:function(a){return new ey(this.times,this.values,this.getValueSize(),a)},setInterpolation:function(b){var a,c;switch(b){case ch:a=this.InterpolantFactoryMethodDiscrete;break;case cf:a=this.InterpolantFactoryMethodLinear;break;case dL:a=this.InterpolantFactoryMethodSmooth}if(void 0===a){if(c="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,void 0===this.createInterpolant){if(b===this.DefaultInterpolation)throw new Error(c);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",c),this}return this.createInterpolant=a,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ch;case this.InterpolantFactoryMethodLinear:return cf;case this.InterpolantFactoryMethodSmooth:return dL}},getValueSize:function(){return this.values.length/this.times.length},shift:function(b){if(0!==b)for(var c=this.times,a=0,d=c.length;a!==d;++a)c[a]+=b;return this},scale:function(b){if(1!==b)for(var c=this.times,a=0,d=c.length;a!==d;++a)c[a]*=b;return this},trim:function(g,f){for(var c=this.times,d=c.length,b=0,a=d-1,e;b!==d&&c[b]<g;)++b;for(;-1!==a&&c[a]>f;)--a;return(++a,0!==b||a!==d)&&(b>=a&&(b=(a=Math.max(a,1))-1),e=this.getValueSize(),this.times=u.arraySlice(c,b,a),this.values=u.arraySlice(this.values,b*e,a*e)),this},validate:function(){var a=!0,h=this.getValueSize(),i,e,g,f,c,b,d,k,j;h-Math.floor(h)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),a=!1),i=this.times,e=this.values,g=i.length,0===g&&(console.error("THREE.KeyframeTrack: Track is empty.",this),a=!1);for(f=null,c=0;c!==g;c++){if(b=i[c],"number"==typeof b&&isNaN(b)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,b),a=!1;break}if(null!==f&&f>b){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,b,f),a=!1;break}f=b}if(void 0!==e&&u.isTypedArray(e))for(d=0,k=e.length;d!==k;++d)if(j=e[d],isNaN(j)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,j),a=!1;break}return a},optimize:function(){for(var a=u.arraySlice(this.times),d=u.arraySlice(this.values),b=this.getValueSize(),q=this.getInterpolation()===dL,h=a.length-1,c=1,e=1,k,l,j,t,n,f,m,o,p,g,r,s,i;e<h;++e){if(k=!1,l=a[e],l!==a[e+1]&&(1!==e||l!==a[0]))if(q)k=!0;else for(j=e*b,t=j-b,n=j+b,f=0;f!==b;++f)if(m=d[j+f],m!==d[t+f]||m!==d[n+f]){k=!0;break}if(k){if(e!==c){a[c]=a[e];for(o=e*b,p=c*b,g=0;g!==b;++g)d[p+g]=d[o+g]}++c}}if(h>0){a[c]=a[h];for(r=h*b,s=c*b,i=0;i!==b;++i)d[s+i]=d[r+i];++c}return c!==a.length?(this.times=u.arraySlice(a,0,c),this.values=u.arraySlice(d,0,c*b)):(this.times=a,this.values=d),this},clone:function(){var b=u.arraySlice(this.times,0),c=u.arraySlice(this.values,0),a=new(0,this.constructor)(this.name,b,c);return a.createInterpolant=this.createInterpolant,a}}),eC.prototype=Object.assign(Object.create(F.prototype),{constructor:eC,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ch,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),eD.prototype=Object.assign(Object.create(F.prototype),{constructor:eD,ValueTypeName:"color"}),cK.prototype=Object.assign(Object.create(F.prototype),{constructor:cK,ValueTypeName:"number"}),eF.prototype=Object.assign(Object.create(S.prototype),{constructor:eF,interpolate_:function(g,c,i,f){for(var d=this.resultBuffer,e=this.sampleValues,b=this.valueSize,h=(i-c)/(f-c),a=g*b,j=a+b;a!==j;a+=4)G.slerpFlat(d,0,e,a-b,e,a,h);return d}}),ec.prototype=Object.assign(Object.create(F.prototype),{constructor:ec,ValueTypeName:"quaternion",DefaultInterpolation:cf,InterpolantFactoryMethodLinear:function(a){return new eF(this.times,this.values,this.getValueSize(),a)},InterpolantFactoryMethodSmooth:void 0}),eG.prototype=Object.assign(Object.create(F.prototype),{constructor:eG,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ch,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),cO.prototype=Object.assign(Object.create(F.prototype),{constructor:cO,ValueTypeName:"vector"}),Object.assign(X,{parse:function(a){for(var c=[],d=a.tracks,f=1/(a.fps||1),b=0,g=d.length,e;b!==g;++b)c.push(ll(d[b]).scale(f));return e=new X(a.name,a.duration,c,a.blendMode),e.uuid=a.uuid,e},toJSON:function(a){for(var c=[],d=a.tracks,e={name:a.name,duration:a.duration,tracks:c,uuid:a.uuid,blendMode:a.blendMode},b=0,f=d.length;b!==f;++b)c.push(F.toJSON(d[b]));return e},CreateFromMorphTargetSequence:function(h,g,i,j){for(var d=g.length,f=[],b=0,a,c,e;b<d;b++)a=[],c=[],a.push((b+d-1)%d,b,(b+1)%d),c.push(0,1,0),e=u.getKeyframeOrder(a),a=u.sortedArray(a,1,e),c=u.sortedArray(c,1,e),j||0!==a[0]||(a.push(d),c.push(c[0])),f.push(new cK(".morphTargetInfluences["+g[b].name+"]",a,c).scale(1/i));return new X(h,-1,f)},findByName:function(c,e){var a=c,d,b;Array.isArray(c)||(d=c,a=d.geometry&&d.geometry.animations||d.animations);for(b=0;b<a.length;b++)if(a[b].name===e)return a[b];return null},CreateClipsFromMorphTargetSequences:function(g,l,k){for(var a={},j=/^([\w-]*?)([\d]+)$/,b=0,m=g.length,h,c,f,d,i,e;b<m;b++)h=g[b],c=h.name.match(j),c&&c.length>1&&(f=c[1],d=a[f],d||(a[f]=d=[]),d.push(h));i=[];for(e in a)i.push(X.CreateFromMorphTargetSequence(e,a[e],l,k));return i},parseAnimation:function(d,t){var f,c,q,s,r,n,j,e,a,g,b,i,o,p,k,m,l,h;if(!d)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(f=function(g,d,c,e,f){if(0!==c.length){var a=[],b=[];u.flattenJSON(c,a,b,e),0!==a.length&&f.push(new g(d,a,b))}},c=[],q=d.name||"default",s=d.fps||30,r=d.blendMode,n=d.length||-1,j=d.hierarchy||[],e=0;e<j.length;e++)if(a=j[e].keys,a&&0!==a.length)if(a[0].morphTargets){g={},b=void 0;for(b=0;b<a.length;b++)if(a[b].morphTargets)for(i=0;i<a[b].morphTargets.length;i++)g[a[b].morphTargets[i]]=-1;for(o in g){for(p=[],k=[],m=0;m!==a[b].morphTargets.length;++m)l=a[b],p.push(l.time),k.push(l.morphTarget===o?1:0);c.push(new cK(".morphTargetInfluence["+o+"]",p,k))}n=g.length*(s||1)}else h=".bones["+t[e].name+"]",f(cO,h+".position",a,"pos",c),f(ec,h+".quaternion",a,"rot",c),f(cO,h+".scale",a,"scl",c);return 0===c.length?null:new X(q,n,c,r)}}),Object.assign(X.prototype,{resetDuration:function(){for(var a=0,b=0,d=this.tracks.length,c;b!==d;++b)c=this.tracks[b],a=Math.max(a,c.times[c.times.length-1]);return this.duration=a,this},trim:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].trim(0,this.duration);return this},validate:function(){for(var a=!0,b=0;b<this.tracks.length;b++)a=a&&this.tracks[b].validate();return a},optimize:function(){for(var a=0;a<this.tracks.length;a++)this.tracks[a].optimize();return this},clone:function(){for(var b=[],a=0;a<this.tracks.length;a++)b.push(this.tracks[a].clone());return new X(this.name,this.duration,b,this.blendMode)},toJSON:function(){return X.toJSON(this)}}),bt={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};function f_(g,h,i){var a=this,f=!1,d=0,c=0,e=void 0,b=[];this.onStart=void 0,this.onLoad=g,this.onProgress=h,this.onError=i,this.itemStart=function(b){c++,!1===f&&void 0!==a.onStart&&a.onStart(b,d,c),f=!0},this.itemEnd=function(b){d++,void 0!==a.onProgress&&a.onProgress(b,d,c),d===c&&(f=!1,void 0!==a.onLoad&&a.onLoad())},this.itemError=function(b){void 0!==a.onError&&a.onError(b)},this.resolveURL=function(a){return e?e(a):a},this.setURLModifier=function(a){return e=a,this},this.addHandler=function(a,c){return b.push(a,c),this},this.removeHandler=function(c){var a=b.indexOf(c);return-1!==a&&b.splice(a,2),this},this.getHandler=function(d){for(var a=0,e=b.length,c,f;a<e;a+=2)if(c=b[a],f=b[a+1],c.global&&(c.lastIndex=0),c.test(d))return f;return null}}hU=new f_;function p(a){this.manager=void 0!==a?a:hU,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(p.prototype,{load:function(){},loadAsync:function(a,b){var c=this;return new Promise(function(d,e){c.load(a,d,b,e)})},parse:function(){},setCrossOrigin:function(a){return this.crossOrigin=a,this},setWithCredentials:function(a){return this.withCredentials=a,this},setPath:function(a){return this.path=a,this},setResourcePath:function(a){return this.resourcePath=a,this},setRequestHeader:function(a){return this.requestHeader=a,this}}),aa={};function ae(a){p.call(this,a)}function hS(a){p.call(this,a)}function hR(a){p.call(this,a)}function cJ(a){p.call(this,a)}function eN(a){p.call(this,a)}function eO(a){p.call(this,a)}function eR(a){p.call(this,a)}function h(){this.type="Curve",this.arcLengthDivisions=200}function V(a,b,c,d,e,f,g,i){h.call(this),this.type="EllipseCurve",this.aX=a||0,this.aY=b||0,this.xRadius=c||1,this.yRadius=d||1,this.aStartAngle=e||0,this.aEndAngle=f||2*Math.PI,this.aClockwise=g||!1,this.aRotation=i||0}function cH(b,c,a,d,e,f){V.call(this,b,c,a,a,d,e,f),this.type="ArcCurve"}function hW(){var a=0,b=0,c=0,d=0;function e(e,g,f,h){a=e,b=f,c=-3*e+3*g-2*f-h,d=2*e-2*g+f+h}return{initCatmullRom:function(d,a,b,f,c){e(a,b,c*(b-d),c*(f-a))},initNonuniformCatmullRom:function(d,b,c,f,g,a,h){var i=(b-d)/g-(c-d)/(g+a)+(c-b)/a,j=(c-b)/a-(f-b)/(a+h)+(f-c)/h;e(b,c,i*=a,j*=a)},calc:function(e){var f=e*e;return a+b*e+c*f+d*(f*e)}}}ae.prototype=Object.assign(Object.create(p.prototype),{constructor:ae,load:function(a,e,p,i){var b,j,c,g,l,o,d,f,m,k,h,q,n;if(void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a),b=this,j=bt.get(a),void 0!==j)return b.manager.itemStart(a),setTimeout(function(){e&&e(j),b.manager.itemEnd(a)},0),j;if(void 0===aa[a]){if(g=a.match(/^data:(.*?)(;base64)?,(.*)$/),g){l=g[1],o=!!g[2],d=g[3],d=decodeURIComponent(d),o&&(d=atob(d));try{switch(m=(this.responseType||"").toLowerCase(),m){case"arraybuffer":case"blob":for(k=new Uint8Array(d.length),h=0;h<d.length;h++)k[h]=d.charCodeAt(h);f="blob"===m?new Blob([k.buffer],{type:l}):k.buffer;break;case"document":q=new DOMParser,f=q.parseFromString(d,l);break;case"json":f=JSON.parse(d);break;default:f=d}setTimeout(function(){e&&e(f),b.manager.itemEnd(a)},0)}catch(c){setTimeout(function(){i&&i(c),b.manager.itemError(a),b.manager.itemEnd(a)},0)}}else{for(n in aa[a]=[],aa[a].push({onLoad:e,onProgress:p,onError:i}),(c=new XMLHttpRequest).open("GET",a,!0),c.addEventListener("load",function(j){var f=this.response,c=aa[a],e,i,g,d,k,h;if(delete aa[a],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),bt.add(a,f);for(e=0,i=c.length;e<i;e++)g=c[e],g.onLoad&&g.onLoad(f);b.manager.itemEnd(a)}else{for(d=0,k=c.length;d<k;d++)h=c[d],h.onError&&h.onError(j);b.manager.itemError(a),b.manager.itemEnd(a)}},!1),c.addEventListener("progress",function(e){for(var c=aa[a],b=0,f=c.length,d;b<f;b++)d=c[b],d.onProgress&&d.onProgress(e)},!1),c.addEventListener("error",function(f){var d=aa[a],c,g,e;delete aa[a];for(c=0,g=d.length;c<g;c++)e=d[c],e.onError&&e.onError(f);b.manager.itemError(a),b.manager.itemEnd(a)},!1),c.addEventListener("abort",function(f){var d=aa[a],c,g,e;delete aa[a];for(c=0,g=d.length;c<g;c++)e=d[c],e.onError&&e.onError(f);b.manager.itemError(a),b.manager.itemEnd(a)},!1),void 0!==this.responseType&&(c.responseType=this.responseType),void 0!==this.withCredentials&&(c.withCredentials=this.withCredentials),c.overrideMimeType&&c.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)c.setRequestHeader(n,this.requestHeader[n]);c.send(null)}return b.manager.itemStart(a),c}aa[a].push({onLoad:e,onProgress:p,onError:i})},setResponseType:function(a){return this.responseType=a,this},setMimeType:function(a){return this.mimeType=a,this}}),hS.prototype=Object.assign(Object.create(p.prototype),{constructor:hS,load:function(d,e,f,c){var a=this,b=new ae(a.manager);b.setPath(a.path),b.setRequestHeader(a.requestHeader),b.setWithCredentials(a.withCredentials),b.load(d,function(b){try{e(a.parse(JSON.parse(b)))}catch(b){c?c(b):console.error(b),a.manager.itemError(d)}},f,c)},parse:function(b){for(var c=[],a=0,d;a<b.length;a++)d=X.parse(b[a]),c.push(d);return c}}),hR.prototype=Object.assign(Object.create(p.prototype),{constructor:hR,load:function(d,e,h,i){var f=this,b=[],a=new cD,c=new ae(this.manager),j,g,l;c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(f.withCredentials),j=0;function k(g){c.load(d[g],function(d){var c=f.parse(d,!0);b[g]={width:c.width,height:c.height,format:c.format,mipmaps:c.mipmaps},6===(j+=1)&&(1===c.mipmapCount&&(a.minFilter=D),a.image=b,a.format=c.format,a.needsUpdate=!0,e&&e(a))},h,i)}if(Array.isArray(d))for(g=0,l=d.length;g<l;++g)k(g);else c.load(d,function(h){var c=f.parse(h,!0),i,d,g;if(c.isCubemap){for(i=c.mipmaps.length/c.mipmapCount,d=0;d<i;d++){b[d]={mipmaps:[]};for(g=0;g<c.mipmapCount;g++)b[d].mipmaps.push(c.mipmaps[d*c.mipmapCount+g]),b[d].format=c.format,b[d].width=c.width,b[d].height=c.height}a.image=b}else a.image.width=c.width,a.image.height=c.height,a.mipmaps=c.mipmaps;1===c.mipmapCount&&(a.minFilter=D),a.format=c.format,a.needsUpdate=!0,e&&e(a)},h,i);return a}}),cJ.prototype=Object.assign(Object.create(p.prototype),{constructor:cJ,load:function(a,d,i,h){var c,e,b;if(void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a),c=this,e=bt.get(a),void 0!==e)return c.manager.itemStart(a),setTimeout(function(){d&&d(e),c.manager.itemEnd(a)},0),e;b=document.createElementNS("http://www.w3.org/1999/xhtml","img");function g(){b.removeEventListener("load",g,!1),b.removeEventListener("error",f,!1),bt.add(a,this),d&&d(this),c.manager.itemEnd(a)}function f(d){b.removeEventListener("load",g,!1),b.removeEventListener("error",f,!1),h&&h(d),c.manager.itemError(a),c.manager.itemEnd(a)}return b.addEventListener("load",g,!1),b.addEventListener("error",f,!1),"data:"!==a.substr(0,5)&&void 0!==this.crossOrigin&&(b.crossOrigin=this.crossOrigin),c.manager.itemStart(a),b.src=a,b}}),eN.prototype=Object.assign(Object.create(p.prototype),{constructor:eN,load:function(d,e,i,f){var a=new aE,c=new cJ(this.manager),g,b;c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),g=0;function h(b){c.load(d[b],function(c){a.images[b]=c,6===++g&&(a.needsUpdate=!0,e&&e(a))},void 0,f)}for(b=0;b<d.length;++b)h(b);return a}}),eO.prototype=Object.assign(Object.create(p.prototype),{constructor:eO,load:function(g,c,e,f){var d=this,a=new aW,b=new ae(this.manager);return b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(d.withCredentials),b.load(g,function(e){var b=d.parse(e);b&&(void 0!==b.image?a.image=b.image:void 0!==b.data&&(a.image.width=b.width,a.image.height=b.height,a.image.data=b.data),a.wrapS=void 0!==b.wrapS?b.wrapS:L,a.wrapT=void 0!==b.wrapT?b.wrapT:L,a.magFilter=void 0!==b.magFilter?b.magFilter:D,a.minFilter=void 0!==b.minFilter?b.minFilter:D,a.anisotropy=void 0!==b.anisotropy?b.anisotropy:1,void 0!==b.format&&(a.format=b.format),void 0!==b.type&&(a.type=b.type),void 0!==b.mipmaps&&(a.mipmaps=b.mipmaps,a.minFilter=cx),1===b.mipmapCount&&(a.minFilter=D),a.needsUpdate=!0,c&&c(a,b))},e,f),a}}),eR.prototype=Object.assign(Object.create(p.prototype),{constructor:eR,load:function(b,d,e,f){var a=new r,c=new cJ(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(b,function(c){a.image=c;var e=b.search(/\.jpe?g($|\?)/i)>0||0===b.search(/^data\:image\/jpeg/);a.format=e?aK:Y,a.needsUpdate=!0,void 0!==d&&d(a)},e,f),a}}),Object.assign(h.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(a,b){var c=this.getUtoTmapping(a);return this.getPoint(c,b)},getPoints:function(a){void 0===a&&(a=5);for(var c=[],b=0;b<=a;b++)c.push(this.getPoint(b/a));return c},getSpacedPoints:function(a){void 0===a&&(a=5);for(var c=[],b=0;b<=a;b++)c.push(this.getPointAt(b/a));return c},getLength:function(){var a=this.getLengths();return a[a.length-1]},getLengths:function(a){var d,b,e,f,c;if(void 0===a&&(a=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1,b=[],e=this.getPoint(0),f=0,b.push(0);for(c=1;c<=a;c++)f+=(d=this.getPoint(c/a)).distanceTo(e),b.push(f),e=d;return this.cacheArcLengths=b,b},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(i,j){var f,b=this.getLengths(),a=0,e=b.length,g,d,c,h;f=j||i*b[e-1];for(g,d=0,c=e-1;d<=c;)if((g=b[a=Math.floor(d+(c-d)/2)]-f)<0)d=a+1;else{if(!(g>0)){c=a;break}c=a-1}return b[a=c]===f?a/(e-1):(h=b[a],(a+(f-h)/(b[a+1]-h))/(e-1))},getTangent:function(e,j){var g=1e-4,a=e-g,d=e+g,h,i,f;return a<0&&(a=0),d>1&&(d=1),h=this.getPoint(a),i=this.getPoint(d),f=j||(h.isVector2?new c:new b),f.copy(i).sub(h).normalize(),f},getTangentAt:function(a,b){var c=this.getUtoTmapping(a);return this.getTangent(c,b)},computeFrenetFrames:function(h,s){for(var k=new b,a=[],d=[],g=[],f=new b,n=new o,i=0,u,j,p,q,r,c,t,m,e;i<=h;i++)u=i/h,a[i]=this.getTangentAt(u,new b),a[i].normalize();d[0]=new b,g[0]=new b,j=Number.MAX_VALUE,p=Math.abs(a[0].x),q=Math.abs(a[0].y),r=Math.abs(a[0].z),p<=j&&(j=p,k.set(1,0,0)),q<=j&&(j=q,k.set(0,1,0)),r<=j&&k.set(0,0,1),f.crossVectors(a[0],k).normalize(),d[0].crossVectors(a[0],f),g[0].crossVectors(a[0],d[0]);for(c=1;c<=h;c++)d[c]=d[c-1].clone(),g[c]=g[c-1].clone(),f.crossVectors(a[c-1],a[c]),f.length()>Number.EPSILON&&(f.normalize(),t=Math.acos(l.clamp(a[c-1].dot(a[c]),-1,1)),d[c].applyMatrix4(n.makeRotationAxis(f,t))),g[c].crossVectors(a[c],d[c]);if(!0===s){m=Math.acos(l.clamp(d[0].dot(d[h]),-1,1)),m/=h,a[0].dot(f.crossVectors(d[0],d[h]))>0&&(m=-m);for(e=1;e<=h;e++)d[e].applyMatrix4(n.makeRotationAxis(a[e],m*e)),g[e].crossVectors(a[e],d[e])}return{tangents:a,normals:d,binormals:g}},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this},toJSON:function(){var a={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a},fromJSON:function(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}),V.prototype=Object.create(h.prototype),V.prototype.constructor=V,V.prototype.isEllipseCurve=!0,V.prototype.getPoint=function(n,m){for(var l=m||new c,b=2*Math.PI,a=this.aEndAngle-this.aStartAngle,g=Math.abs(a)<Number.EPSILON,h,e,d,k,i,j,f;a<0;)a+=b;for(;a>b;)a-=b;return a<Number.EPSILON&&(a=g?0:b),!0!==this.aClockwise||g||(a===b?a=-b:a-=b),h=this.aStartAngle+n*a,e=this.aX+this.xRadius*Math.cos(h),d=this.aY+this.yRadius*Math.sin(h),0!==this.aRotation&&(k=Math.cos(this.aRotation),i=Math.sin(this.aRotation),j=e-this.aX,f=d-this.aY,e=j*k-f*i+this.aX,d=j*i+f*k+this.aY),l.set(e,d)},V.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},V.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a},V.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this},cH.prototype=Object.create(V.prototype),cH.prototype.constructor=cH,cH.prototype.isArcCurve=!0,dP=new b,fc=new hW,fi=new hW,fj=new hW;function H(a,b,c,d){void 0===a&&(a=[]),void 0===b&&(b=!1),void 0===c&&(c="centripetal"),void 0===d&&(d=.5),h.call(this),this.type="CatmullRomCurve3",this.points=a,this.closed=b,this.curveType=c,this.tension=d}function iq(a,h,b,c,g){var d=.5*(c-h),f=.5*(g-b),e=a*a;return(2*b-2*c+d+f)*(a*e)+(-3*b+3*c-2*d-f)*e+d*a+b}function dl(a,b,c,d){return function(b,c){var a=1-b;return a*a*c}(a,b)+function(a,b){return 2*(1-a)*a*b}(a,c)+function(a,b){return a*a*b}(a,d)}function dF(a,b,c,d,e){return function(b,c){var a=1-b;return a*a*a*c}(a,b)+function(a,c){var b=1-a;return 3*b*b*a*c}(a,c)+function(a,b){return 3*(1-a)*a*a*b}(a,d)+function(a,b){return a*a*a*b}(a,e)}function ag(a,b,d,e){void 0===a&&(a=new c),void 0===b&&(b=new c),void 0===d&&(d=new c),void 0===e&&(e=new c),h.call(this),this.type="CubicBezierCurve",this.v0=a,this.v1=b,this.v2=d,this.v3=e}function at(a,c,d,e){void 0===a&&(a=new b),void 0===c&&(c=new b),void 0===d&&(d=new b),void 0===e&&(e=new b),h.call(this),this.type="CubicBezierCurve3",this.v0=a,this.v1=c,this.v2=d,this.v3=e}function O(a,b){void 0===a&&(a=new c),void 0===b&&(b=new c),h.call(this),this.type="LineCurve",this.v1=a,this.v2=b}function ar(a,c){void 0===a&&(a=new b),void 0===c&&(c=new b),h.call(this),this.type="LineCurve3",this.v1=a,this.v2=c}function aq(a,b,d){void 0===a&&(a=new c),void 0===b&&(b=new c),void 0===d&&(d=new c),h.call(this),this.type="QuadraticBezierCurve",this.v0=a,this.v1=b,this.v2=d}function au(a,c,d){void 0===a&&(a=new b),void 0===c&&(c=new b),void 0===d&&(d=new b),h.call(this),this.type="QuadraticBezierCurve3",this.v0=a,this.v1=c,this.v2=d}function ao(a){void 0===a&&(a=[]),h.call(this),this.type="SplineCurve",this.points=a}H.prototype=Object.create(h.prototype),H.prototype.constructor=H,H.prototype.isCatmullRomCurve3=!0,H.prototype.getPoint=function(q,p){var f,e,o,d,a,n,c,k,h,g,m,j,i,l;return void 0===p&&(p=new b),o=p,d=this.points,a=d.length,n=(a-(this.closed?0:1))*q,c=Math.floor(n),k=n-c,this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/a)+1)*a:0===k&&c===a-1&&(c=a-2,k=1),this.closed||c>0?f=d[(c-1)%a]:(dP.subVectors(d[0],d[1]).add(d[0]),f=dP),h=d[c%a],g=d[(c+1)%a],(this.closed||c+2<a?e=d[(c+2)%a]:(dP.subVectors(d[a-1],d[a-2]).add(d[a-1]),e=dP),"centripetal"===this.curveType||"chordal"===this.curveType)?(m="chordal"===this.curveType?.5:.25,j=Math.pow(f.distanceToSquared(h),m),i=Math.pow(h.distanceToSquared(g),m),l=Math.pow(g.distanceToSquared(e),m),i<1e-4&&(i=1),j<1e-4&&(j=i),l<1e-4&&(l=i),fc.initNonuniformCatmullRom(f.x,h.x,g.x,e.x,j,i,l),fi.initNonuniformCatmullRom(f.y,h.y,g.y,e.y,j,i,l),fj.initNonuniformCatmullRom(f.z,h.z,g.z,e.z,j,i,l)):"catmullrom"===this.curveType&&(fc.initCatmullRom(f.x,h.x,g.x,e.x,this.tension),fi.initCatmullRom(f.y,h.y,g.y,e.y,this.tension),fj.initCatmullRom(f.z,h.z,g.z,e.z,this.tension)),o.set(fc.calc(k),fi.calc(k),fj.calc(k)),o},H.prototype.copy=function(a){var b,c,d;h.prototype.copy.call(this,a),this.points=[];for(b=0,c=a.points.length;b<c;b++)d=a.points[b],this.points.push(d.clone());return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},H.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this),b,c,d;a.points=[];for(b=0,c=this.points.length;b<c;b++)d=this.points[b],a.points.push(d.toArray());return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a},H.prototype.fromJSON=function(a){var c,d,e;h.prototype.fromJSON.call(this,a),this.points=[];for(c=0,d=a.points.length;c<d;c++)e=a.points[c],this.points.push((new b).fromArray(e));return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this},ag.prototype=Object.create(h.prototype),ag.prototype.constructor=ag,ag.prototype.isCubicBezierCurve=!0,ag.prototype.getPoint=function(b,a){void 0===a&&(a=new c);var d=a,e=this.v0,f=this.v1,g=this.v2,h=this.v3;return d.set(dF(b,e.x,f.x,g.x,h.x),dF(b,e.y,f.y,g.y,h.y)),d},ag.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},ag.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},ag.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this},at.prototype=Object.create(h.prototype),at.prototype.constructor=at,at.prototype.isCubicBezierCurve3=!0,at.prototype.getPoint=function(a,c){void 0===c&&(c=new b);var h=c,d=this.v0,e=this.v1,f=this.v2,g=this.v3;return h.set(dF(a,d.x,e.x,f.x,g.x),dF(a,d.y,e.y,f.y,g.y),dF(a,d.z,e.z,f.z,g.z)),h},at.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this},at.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a},at.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this},O.prototype=Object.create(h.prototype),O.prototype.constructor=O,O.prototype.isLineCurve=!0,O.prototype.getPoint=function(d,b){void 0===b&&(b=new c);var a=b;return 1===d?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(d).add(this.v1)),a},O.prototype.getPointAt=function(a,b){return this.getPoint(a,b)},O.prototype.getTangent=function(d,b){var a=b||new c;return a.copy(this.v2).sub(this.v1).normalize(),a},O.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},O.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},O.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},ar.prototype=Object.create(h.prototype),ar.prototype.constructor=ar,ar.prototype.isLineCurve3=!0,ar.prototype.getPoint=function(d,c){void 0===c&&(c=new b);var a=c;return 1===d?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(d).add(this.v1)),a},ar.prototype.getPointAt=function(a,b){return this.getPoint(a,b)},ar.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v1.copy(a.v1),this.v2.copy(a.v2),this},ar.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},ar.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},aq.prototype=Object.create(h.prototype),aq.prototype.constructor=aq,aq.prototype.isQuadraticBezierCurve=!0,aq.prototype.getPoint=function(b,a){void 0===a&&(a=new c);var d=a,e=this.v0,f=this.v1,g=this.v2;return d.set(dl(b,e.x,f.x,g.x),dl(b,e.y,f.y,g.y)),d},aq.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},aq.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},aq.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},au.prototype=Object.create(h.prototype),au.prototype.constructor=au,au.prototype.isQuadraticBezierCurve3=!0,au.prototype.getPoint=function(a,c){void 0===c&&(c=new b);var g=c,d=this.v0,e=this.v1,f=this.v2;return g.set(dl(a,d.x,e.x,f.x),dl(a,d.y,e.y,f.y),dl(a,d.z,e.z,f.z)),g},au.prototype.copy=function(a){return h.prototype.copy.call(this,a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this},au.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this);return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a},au.prototype.fromJSON=function(a){return h.prototype.fromJSON.call(this,a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this},ao.prototype=Object.create(h.prototype),ao.prototype.constructor=ao,ao.prototype.isSplineCurve=!0,ao.prototype.getPoint=function(l,d){void 0===d&&(d=new c);var f=d,a=this.points,g=(a.length-1)*l,b=Math.floor(g),e=g-b,h=a[0===b?b:b-1],i=a[b],j=a[b>a.length-2?a.length-1:b+1],k=a[b>a.length-3?a.length-1:b+2];return f.set(iq(e,h.x,i.x,j.x,k.x),iq(e,h.y,i.y,j.y,k.y)),f},ao.prototype.copy=function(b){var a,c,d;h.prototype.copy.call(this,b),this.points=[];for(a=0,c=b.points.length;a<c;a++)d=b.points[a],this.points.push(d.clone());return this},ao.prototype.toJSON=function(){var a=h.prototype.toJSON.call(this),b,c,d;a.points=[];for(b=0,c=this.points.length;b<c;b++)d=this.points[b],a.points.push(d.toArray());return a},ao.prototype.fromJSON=function(b){var a,d,e;h.prototype.fromJSON.call(this,b),this.points=[];for(a=0,d=b.points.length;a<d;a++)e=b.points[a],this.points.push((new c).fromArray(e));return this},fB=Object.freeze({__proto__:null,ArcCurve:cH,CatmullRomCurve3:H,CubicBezierCurve:ag,CubicBezierCurve3:at,EllipseCurve:V,LineCurve:O,LineCurve3:ar,QuadraticBezierCurve:aq,QuadraticBezierCurve3:au,SplineCurve:ao});function bq(){h.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function aj(a){bq.call(this),this.type="Path",this.currentPoint=new c,a&&this.setFromPoints(a)}function bs(a){aj.call(this,a),this.uuid=l.generateUUID(),this.type="Shape",this.holes=[]}function v(b,a){void 0===a&&(a=1),g.call(this),this.type="Light",this.color=new e(b),this.intensity=a}function fC(a,b,c){v.call(this,a,c),this.type="HemisphereLight",this.position.copy(g.DefaultUp),this.updateMatrix(),this.groundColor=new e(b)}function aQ(a){this.camera=a,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new c(512,512),this.map=null,this.mapPass=null,this.matrix=new o,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new cF,this._frameExtents=new c(1,1),this._viewportCount=1,this._viewports=[new q(0,0,1,1)]}function hT(){aQ.call(this,new A(50,1,.5,500)),this.focus=1}function fD(e,f,a,b,c,d){v.call(this,e,f),this.type="SpotLight",this.position.copy(g.DefaultUp),this.updateMatrix(),this.target=new g,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(a){this.intensity=a/Math.PI}}),this.distance=void 0!==a?a:0,this.angle=void 0!==b?b:Math.PI/3,this.penumbra=void 0!==c?c:0,this.decay=void 0!==d?d:1,this.shadow=new hT}function hJ(){aQ.call(this,new A(90,1,.5,500)),this._frameExtents=new c(4,2),this._viewportCount=6,this._viewports=[new q(2,1,1,1),new q(0,1,1,1),new q(3,1,1,1),new q(1,1,1,1),new q(3,0,1,1),new q(1,0,1,1)],this._cubeDirections=[new b(1,0,0),new b(-1,0,0),new b(0,0,1),new b(0,0,-1),new b(0,1,0),new b(0,-1,0)],this._cubeUps=[new b(0,1,0),new b(0,1,0),new b(0,1,0),new b(0,1,0),new b(0,0,1),new b(0,0,-1)]}function fE(c,d,a,b){v.call(this,c,d),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(a){this.intensity=a/(4*Math.PI)}}),this.distance=void 0!==a?a:0,this.decay=void 0!==b?b:1,this.shadow=new hJ}function cp(a,b,c,d,e,f){void 0===a&&(a=-1),void 0===b&&(b=1),void 0===c&&(c=1),void 0===d&&(d=-1),void 0===e&&(e=.1),void 0===f&&(f=2e3),az.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=a,this.right=b,this.top=c,this.bottom=d,this.near=e,this.far=f,this.updateProjectionMatrix()}function hI(){aQ.call(this,new cp(-5,5,5,-5,.5,500))}function fK(a,b){v.call(this,a,b),this.type="DirectionalLight",this.position.copy(g.DefaultUp),this.updateMatrix(),this.target=new g,this.shadow=new hI}function fL(a,b){v.call(this,a,b),this.type="AmbientLight"}function fT(c,d,a,b){v.call(this,c,d),this.type="RectAreaLight",this.width=void 0!==a?a:10,this.height=void 0!==b?b:10}bq.prototype=Object.assign(Object.create(h.prototype),{constructor:bq,add:function(a){this.curves.push(a)},closePath:function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new O(b,a))},getPoint:function(g){for(var d=g*this.getLength(),b=this.getCurveLengths(),a=0,f,e,c,h;a<b.length;){if(b[a]>=d)return f=b[a]-d,e=this.curves[a],c=e.getLength(),h=0===c?0:1-f/c,e.getPointAt(h);a++}return null},getLength:function(){var a=this.getCurveLengths();return a[a.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var a=[],c=0,b=0,d=this.curves.length;b<d;b++)c+=this.curves[b].getLength(),a.push(c);return this.cacheLengths=a,a},getSpacedPoints:function(a){void 0===a&&(a=40);for(var b=[],c=0;c<=a;c++)b.push(this.getPoint(c/a));return this.autoClose&&b.push(b[0]),b},getPoints:function(c){var d,b,e,h,a,j,i,f,g;void 0===c&&(c=12);for(d,b=[],e=0,h=this.curves;e<h.length;e++)for(a=h[e],j=a&&a.isEllipseCurve?2*c:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?c*a.points.length:c,i=a.getPoints(j),f=0;f<i.length;f++)g=i[f],d&&d.equals(g)||(b.push(g),d=g);return this.autoClose&&b.length>1&&!b[b.length-1].equals(b[0])&&b.push(b[0]),b},copy:function(a){var b,c,d;h.prototype.copy.call(this,a),this.curves=[];for(b=0,c=a.curves.length;b<c;b++)d=a.curves[b],this.curves.push(d.clone());return this.autoClose=a.autoClose,this},toJSON:function(){var a=h.prototype.toJSON.call(this),b,c,d;a.autoClose=this.autoClose,a.curves=[];for(b=0,c=this.curves.length;b<c;b++)d=this.curves[b],a.curves.push(d.toJSON());return a},fromJSON:function(a){var b,d,c;h.prototype.fromJSON.call(this,a),this.autoClose=a.autoClose,this.curves=[];for(b=0,d=a.curves.length;b<d;b++)c=a.curves[b],this.curves.push((new fB[c.type]).fromJSON(c));return this}}),aj.prototype=Object.assign(Object.create(bq.prototype),{constructor:aj,setFromPoints:function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y);return this},moveTo:function(a,b){return this.currentPoint.set(a,b),this},lineTo:function(a,b){var d=new O(this.currentPoint.clone(),new c(a,b));return this.curves.push(d),this.currentPoint.set(a,b),this},quadraticCurveTo:function(d,e,a,b){var f=new aq(this.currentPoint.clone(),new c(d,e),new c(a,b));return this.curves.push(f),this.currentPoint.set(a,b),this},bezierCurveTo:function(d,e,f,g,a,b){var h=new ag(this.currentPoint.clone(),new c(d,e),new c(f,g),new c(a,b));return this.curves.push(h),this.currentPoint.set(a,b),this},splineThru:function(a){var b=new ao([this.currentPoint.clone()].concat(a));return this.curves.push(b),this.currentPoint.copy(a[a.length-1]),this},arc:function(a,b,c,d,e,f){var g=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(a+g,b+h,c,d,e,f),this},absarc:function(b,c,a,d,e,f){return this.absellipse(b,c,a,a,d,e,f),this},ellipse:function(a,b,c,d,e,f,g,h){var i=this.currentPoint.x,j=this.currentPoint.y;return this.absellipse(a+i,b+j,c,d,e,f,g,h),this},absellipse:function(c,d,i,j,e,f,g,h){var a=new V(c,d,i,j,e,f,g,h),b,k;return this.curves.length>0&&(b=a.getPoint(0),b.equals(this.currentPoint)||this.lineTo(b.x,b.y)),this.curves.push(a),k=a.getPoint(1),this.currentPoint.copy(k),this},copy:function(a){return bq.prototype.copy.call(this,a),this.currentPoint.copy(a.currentPoint),this},toJSON:function(){var a=bq.prototype.toJSON.call(this);return a.currentPoint=this.currentPoint.toArray(),a},fromJSON:function(a){return bq.prototype.fromJSON.call(this,a),this.currentPoint.fromArray(a.currentPoint),this}}),bs.prototype=Object.assign(Object.create(aj.prototype),{constructor:bs,getPointsHoles:function(c){for(var b=[],a=0,d=this.holes.length;a<d;a++)b[a]=this.holes[a].getPoints(c);return b},extractPoints:function(a){return{shape:this.getPoints(a),holes:this.getPointsHoles(a)}},copy:function(b){var a,c,d;aj.prototype.copy.call(this,b),this.holes=[];for(a=0,c=b.holes.length;a<c;a++)d=b.holes[a],this.holes.push(d.clone());return this},toJSON:function(){var a=aj.prototype.toJSON.call(this),b,c,d;a.uuid=this.uuid,a.holes=[];for(b=0,c=this.holes.length;b<c;b++)d=this.holes[b],a.holes.push(d.toJSON());return a},fromJSON:function(a){var b,c,d;aj.prototype.fromJSON.call(this,a),this.uuid=a.uuid,this.holes=[];for(b=0,c=a.holes.length;b<c;b++)d=a.holes[b],this.holes.push((new aj).fromJSON(d));return this}}),v.prototype=Object.assign(Object.create(g.prototype),{constructor:v,isLight:!0,copy:function(a){return g.prototype.copy.call(this,a),this.color.copy(a.color),this.intensity=a.intensity,this},toJSON:function(b){var a=g.prototype.toJSON.call(this,b);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON()),a}}),fC.prototype=Object.assign(Object.create(v.prototype),{constructor:fC,isHemisphereLight:!0,copy:function(a){return v.prototype.copy.call(this,a),this.groundColor.copy(a.groundColor),this}}),Object.assign(aQ.prototype,{_projScreenMatrix:new o,_lightPositionWorld:new b,_lookTarget:new b,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(c){var a=this.camera,b=this.matrix,d=this._projScreenMatrix,e=this._lookTarget,f=this._lightPositionWorld;f.setFromMatrixPosition(c.matrixWorld),a.position.copy(f),e.setFromMatrixPosition(c.target.matrixWorld),a.lookAt(e),a.updateMatrixWorld(),d.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(d),b.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),b.multiply(a.projectionMatrix),b.multiply(a.matrixWorldInverse)},getViewport:function(a){return this._viewports[a]},getFrameExtents:function(){return this._frameExtents},copy:function(a){return this.camera=a.camera.clone(),this.bias=a.bias,this.radius=a.radius,this.mapSize.copy(a.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var a={};return 0!==this.bias&&(a.bias=this.bias),0!==this.normalBias&&(a.normalBias=this.normalBias),1!==this.radius&&(a.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(a.mapSize=this.mapSize.toArray()),a.camera=this.camera.toJSON(!1).object,delete a.camera.matrix,a}}),hT.prototype=Object.assign(Object.create(aQ.prototype),{constructor:hT,isSpotLightShadow:!0,updateMatrices:function(b){var a=this.camera,c=2*l.RAD2DEG*b.angle*this.focus,d=this.mapSize.width/this.mapSize.height,e=b.distance||a.far;c===a.fov&&d===a.aspect&&e===a.far||(a.fov=c,a.aspect=d,a.far=e,a.updateProjectionMatrix()),aQ.prototype.updateMatrices.call(this,b)}}),fD.prototype=Object.assign(Object.create(v.prototype),{constructor:fD,isSpotLight:!0,copy:function(a){return v.prototype.copy.call(this,a),this.distance=a.distance,this.angle=a.angle,this.penumbra=a.penumbra,this.decay=a.decay,this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}),hJ.prototype=Object.assign(Object.create(aQ.prototype),{constructor:hJ,isPointLightShadow:!0,updateMatrices:function(g,c){void 0===c&&(c=0);var a=this.camera,f=this.matrix,b=this._lightPositionWorld,d=this._lookTarget,e=this._projScreenMatrix;b.setFromMatrixPosition(g.matrixWorld),a.position.copy(b),d.copy(a.position),d.add(this._cubeDirections[c]),a.up.copy(this._cubeUps[c]),a.lookAt(d),a.updateMatrixWorld(),f.makeTranslation(-b.x,-b.y,-b.z),e.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(e)}}),fE.prototype=Object.assign(Object.create(v.prototype),{constructor:fE,isPointLight:!0,copy:function(a){return v.prototype.copy.call(this,a),this.distance=a.distance,this.decay=a.decay,this.shadow=a.shadow.clone(),this}}),cp.prototype=Object.assign(Object.create(az.prototype),{constructor:cp,isOrthographicCamera:!0,copy:function(a,b){return az.prototype.copy.call(this,a,b),this.left=a.left,this.right=a.right,this.top=a.top,this.bottom=a.bottom,this.near=a.near,this.far=a.far,this.zoom=a.zoom,this.view=null===a.view?null:Object.assign({},a.view),this},setViewOffset:function(a,b,c,d,e,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=a,this.view.fullHeight=b,this.view.offsetX=c,this.view.offsetY=d,this.view.width=e,this.view.height=f,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2,e=c-a,f=c+a,g=d+b,h=d-b,i,j;null!==this.view&&this.view.enabled&&(i=(this.right-this.left)/this.view.fullWidth/this.zoom,j=(this.top-this.bottom)/this.view.fullHeight/this.zoom,f=(e+=i*this.view.offsetX)+i*this.view.width,h=(g-=j*this.view.offsetY)-j*this.view.height),this.projectionMatrix.makeOrthographic(e,f,g,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(b){var a=g.prototype.toJSON.call(this,b);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,null!==this.view&&(a.object.view=Object.assign({},this.view)),a}}),hI.prototype=Object.assign(Object.create(aQ.prototype),{constructor:hI,isDirectionalLightShadow:!0,updateMatrices:function(a){aQ.prototype.updateMatrices.call(this,a)}}),fK.prototype=Object.assign(Object.create(v.prototype),{constructor:fK,isDirectionalLight:!0,copy:function(a){return v.prototype.copy.call(this,a),this.target=a.target.clone(),this.shadow=a.shadow.clone(),this}}),fL.prototype=Object.assign(Object.create(v.prototype),{constructor:fL,isAmbientLight:!0}),fT.prototype=Object.assign(Object.create(v.prototype),{constructor:fT,isRectAreaLight:!0,copy:function(a){return v.prototype.copy.call(this,a),this.width=a.width,this.height=a.height,this},toJSON:function(b){var a=v.prototype.toJSON.call(this,b);return a.object.width=this.width,a.object.height=this.height,a}}),hG=function(){function c(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var a=0;a<9;a++)this.coefficients.push(new b)}var a=c.prototype;return a.set=function(b){for(var a=0;a<9;a++)this.coefficients[a].copy(b[a]);return this},a.zero=function(){for(var a=0;a<9;a++)this.coefficients[a].set(0,0,0);return this},a.getAt=function(f,a){var c=f.x,d=f.y,e=f.z,b=this.coefficients;return a.copy(b[0]).multiplyScalar(.282095),a.addScaledVector(b[1],.488603*d),a.addScaledVector(b[2],.488603*e),a.addScaledVector(b[3],.488603*c),a.addScaledVector(b[4],c*d*1.092548),a.addScaledVector(b[5],d*e*1.092548),a.addScaledVector(b[6],.315392*(3*e*e-1)),a.addScaledVector(b[7],c*e*1.092548),a.addScaledVector(b[8],.546274*(c*c-d*d)),a},a.getIrradianceAt=function(f,a){var c=f.x,d=f.y,e=f.z,b=this.coefficients;return a.copy(b[0]).multiplyScalar(.886227),a.addScaledVector(b[1],1.023328*d),a.addScaledVector(b[2],1.023328*e),a.addScaledVector(b[3],1.023328*c),a.addScaledVector(b[4],.858086*c*d),a.addScaledVector(b[5],.858086*d*e),a.addScaledVector(b[6],.743125*e*e-.247708),a.addScaledVector(b[7],.858086*c*e),a.addScaledVector(b[8],.429043*(c*c-d*d)),a},a.add=function(b){for(var a=0;a<9;a++)this.coefficients[a].add(b.coefficients[a]);return this},a.addScaledSH=function(b,c){for(var a=0;a<9;a++)this.coefficients[a].addScaledVector(b.coefficients[a],c);return this},a.scale=function(b){for(var a=0;a<9;a++)this.coefficients[a].multiplyScalar(b);return this},a.lerp=function(b,c){for(var a=0;a<9;a++)this.coefficients[a].lerp(b.coefficients[a],c);return this},a.equals=function(b){for(var a=0;a<9;a++)if(!this.coefficients[a].equals(b.coefficients[a]))return!1;return!0},a.copy=function(a){return this.set(a.coefficients)},a.clone=function(){return(new this.constructor).copy(this)},a.fromArray=function(c,b){void 0===b&&(b=0);for(var d=this.coefficients,a=0;a<9;a++)d[a].fromArray(c,b+3*a);return this},a.toArray=function(a,c){void 0===a&&(a=[]),void 0===c&&(c=0);for(var d=this.coefficients,b=0;b<9;b++)d[b].toArray(a,c+3*b);return a},c.getBasisAt=function(e,a){var b=e.x,c=e.y,d=e.z;a[0]=.282095,a[1]=.488603*c,a[2]=.488603*d,a[3]=.488603*b,a[4]=1.092548*b*c,a[5]=1.092548*c*d,a[6]=.315392*(3*d*d-1),a[7]=1.092548*b*d,a[8]=.546274*(b*b-c*c)},c}();function ac(a,b){v.call(this,void 0,b),this.type="LightProbe",this.sh=void 0!==a?a:new hG}function fG(a){p.call(this,a),this.textures={}}ac.prototype=Object.assign(Object.create(v.prototype),{constructor:ac,isLightProbe:!0,copy:function(a){return v.prototype.copy.call(this,a),this.sh.copy(a.sh),this},fromJSON:function(a){return this.intensity=a.intensity,this.sh.fromArray(a.sh),this},toJSON:function(b){var a=v.prototype.toJSON.call(this,b);return a.object.sh=this.sh.toArray(),a}}),fG.prototype=Object.assign(Object.create(p.prototype),{constructor:fG,load:function(d,e,f,c){var a=this,b=new ae(a.manager);b.setPath(a.path),b.setRequestHeader(a.requestHeader),b.setWithCredentials(a.withCredentials),b.load(d,function(b){try{e(a.parse(JSON.parse(b)))}catch(b){c?c(b):console.error(b),a.manager.itemError(d)}},f,c)},parse:function(a){var k=this.textures,d,g,h,j,i;function f(a){return void 0===k[a]&&console.warn("THREE.MaterialLoader: Undefined texture",a),k[a]}if(d=new iR[a.type],void 0!==a.uuid&&(d.uuid=a.uuid),void 0!==a.name&&(d.name=a.name),void 0!==a.color&&void 0!==d.color&&d.color.setHex(a.color),void 0!==a.roughness&&(d.roughness=a.roughness),void 0!==a.metalness&&(d.metalness=a.metalness),void 0!==a.sheen&&(d.sheen=(new e).setHex(a.sheen)),void 0!==a.emissive&&void 0!==d.emissive&&d.emissive.setHex(a.emissive),void 0!==a.specular&&void 0!==d.specular&&d.specular.setHex(a.specular),void 0!==a.shininess&&(d.shininess=a.shininess),void 0!==a.clearcoat&&(d.clearcoat=a.clearcoat),void 0!==a.clearcoatRoughness&&(d.clearcoatRoughness=a.clearcoatRoughness),void 0!==a.fog&&(d.fog=a.fog),void 0!==a.flatShading&&(d.flatShading=a.flatShading),void 0!==a.blending&&(d.blending=a.blending),void 0!==a.combine&&(d.combine=a.combine),void 0!==a.side&&(d.side=a.side),void 0!==a.opacity&&(d.opacity=a.opacity),void 0!==a.transparent&&(d.transparent=a.transparent),void 0!==a.alphaTest&&(d.alphaTest=a.alphaTest),void 0!==a.depthTest&&(d.depthTest=a.depthTest),void 0!==a.depthWrite&&(d.depthWrite=a.depthWrite),void 0!==a.colorWrite&&(d.colorWrite=a.colorWrite),void 0!==a.stencilWrite&&(d.stencilWrite=a.stencilWrite),void 0!==a.stencilWriteMask&&(d.stencilWriteMask=a.stencilWriteMask),void 0!==a.stencilFunc&&(d.stencilFunc=a.stencilFunc),void 0!==a.stencilRef&&(d.stencilRef=a.stencilRef),void 0!==a.stencilFuncMask&&(d.stencilFuncMask=a.stencilFuncMask),void 0!==a.stencilFail&&(d.stencilFail=a.stencilFail),void 0!==a.stencilZFail&&(d.stencilZFail=a.stencilZFail),void 0!==a.stencilZPass&&(d.stencilZPass=a.stencilZPass),void 0!==a.wireframe&&(d.wireframe=a.wireframe),void 0!==a.wireframeLinewidth&&(d.wireframeLinewidth=a.wireframeLinewidth),void 0!==a.wireframeLinecap&&(d.wireframeLinecap=a.wireframeLinecap),void 0!==a.wireframeLinejoin&&(d.wireframeLinejoin=a.wireframeLinejoin),void 0!==a.rotation&&(d.rotation=a.rotation),1!==a.linewidth&&(d.linewidth=a.linewidth),void 0!==a.dashSize&&(d.dashSize=a.dashSize),void 0!==a.gapSize&&(d.gapSize=a.gapSize),void 0!==a.scale&&(d.scale=a.scale),void 0!==a.polygonOffset&&(d.polygonOffset=a.polygonOffset),void 0!==a.polygonOffsetFactor&&(d.polygonOffsetFactor=a.polygonOffsetFactor),void 0!==a.polygonOffsetUnits&&(d.polygonOffsetUnits=a.polygonOffsetUnits),void 0!==a.skinning&&(d.skinning=a.skinning),void 0!==a.morphTargets&&(d.morphTargets=a.morphTargets),void 0!==a.morphNormals&&(d.morphNormals=a.morphNormals),void 0!==a.dithering&&(d.dithering=a.dithering),void 0!==a.vertexTangents&&(d.vertexTangents=a.vertexTangents),void 0!==a.visible&&(d.visible=a.visible),void 0!==a.toneMapped&&(d.toneMapped=a.toneMapped),void 0!==a.userData&&(d.userData=a.userData),void 0!==a.vertexColors&&("number"==typeof a.vertexColors?d.vertexColors=a.vertexColors>0:d.vertexColors=a.vertexColors),void 0!==a.uniforms)for(g in a.uniforms)switch(h=a.uniforms[g],d.uniforms[g]={},h.type){case"t":d.uniforms[g].value=f(h.value);break;case"c":d.uniforms[g].value=(new e).setHex(h.value);break;case"v2":d.uniforms[g].value=(new c).fromArray(h.value);break;case"v3":d.uniforms[g].value=(new b).fromArray(h.value);break;case"v4":d.uniforms[g].value=(new q).fromArray(h.value);break;case"m3":d.uniforms[g].value=(new Q).fromArray(h.value);break;case"m4":d.uniforms[g].value=(new o).fromArray(h.value);break;default:d.uniforms[g].value=h.value}if(void 0!==a.defines&&(d.defines=a.defines),void 0!==a.vertexShader&&(d.vertexShader=a.vertexShader),void 0!==a.fragmentShader&&(d.fragmentShader=a.fragmentShader),void 0!==a.extensions)for(j in a.extensions)d.extensions[j]=a.extensions[j];return void 0!==a.shading&&(d.flatShading=1===a.shading),void 0!==a.size&&(d.size=a.size),void 0!==a.sizeAttenuation&&(d.sizeAttenuation=a.sizeAttenuation),void 0!==a.map&&(d.map=f(a.map)),void 0!==a.matcap&&(d.matcap=f(a.matcap)),void 0!==a.alphaMap&&(d.alphaMap=f(a.alphaMap)),void 0!==a.bumpMap&&(d.bumpMap=f(a.bumpMap)),void 0!==a.bumpScale&&(d.bumpScale=a.bumpScale),void 0!==a.normalMap&&(d.normalMap=f(a.normalMap)),void 0!==a.normalMapType&&(d.normalMapType=a.normalMapType),void 0!==a.normalScale&&(i=a.normalScale,!1===Array.isArray(i)&&(i=[i,i]),d.normalScale=(new c).fromArray(i)),void 0!==a.displacementMap&&(d.displacementMap=f(a.displacementMap)),void 0!==a.displacementScale&&(d.displacementScale=a.displacementScale),void 0!==a.displacementBias&&(d.displacementBias=a.displacementBias),void 0!==a.roughnessMap&&(d.roughnessMap=f(a.roughnessMap)),void 0!==a.metalnessMap&&(d.metalnessMap=f(a.metalnessMap)),void 0!==a.emissiveMap&&(d.emissiveMap=f(a.emissiveMap)),void 0!==a.emissiveIntensity&&(d.emissiveIntensity=a.emissiveIntensity),void 0!==a.specularMap&&(d.specularMap=f(a.specularMap)),void 0!==a.envMap&&(d.envMap=f(a.envMap)),void 0!==a.envMapIntensity&&(d.envMapIntensity=a.envMapIntensity),void 0!==a.reflectivity&&(d.reflectivity=a.reflectivity),void 0!==a.refractionRatio&&(d.refractionRatio=a.refractionRatio),void 0!==a.lightMap&&(d.lightMap=f(a.lightMap)),void 0!==a.lightMapIntensity&&(d.lightMapIntensity=a.lightMapIntensity),void 0!==a.aoMap&&(d.aoMap=f(a.aoMap)),void 0!==a.aoMapIntensity&&(d.aoMapIntensity=a.aoMapIntensity),void 0!==a.gradientMap&&(d.gradientMap=f(a.gradientMap)),void 0!==a.clearcoatMap&&(d.clearcoatMap=f(a.clearcoatMap)),void 0!==a.clearcoatRoughnessMap&&(d.clearcoatRoughnessMap=f(a.clearcoatRoughnessMap)),void 0!==a.clearcoatNormalMap&&(d.clearcoatNormalMap=f(a.clearcoatNormalMap)),void 0!==a.clearcoatNormalScale&&(d.clearcoatNormalScale=(new c).fromArray(a.clearcoatNormalScale)),void 0!==a.transmission&&(d.transmission=a.transmission),void 0!==a.transmissionMap&&(d.transmissionMap=f(a.transmissionMap)),d},setTextures:function(a){return this.textures=a,this}}),fY={decodeText:function(a){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(a);for(var b="",c=0,d=a.length;c<d;c++)b+=String.fromCharCode(a[c]);try{return decodeURIComponent(escape(b))}catch(a){return b}},extractUrlBase:function(a){var b=a.lastIndexOf("/");return-1===b?"./":a.substr(0,b+1)}};function dp(){i.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function fA(c,d,a,b){"number"==typeof a&&(b=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),k.call(this,c,d,a),this.meshPerAttribute=b||1}function fn(a){p.call(this,a)}dp.prototype=Object.assign(Object.create(i.prototype),{constructor:dp,isInstancedBufferGeometry:!0,copy:function(a){return i.prototype.copy.call(this,a),this.instanceCount=a.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var a=i.prototype.toJSON.call(this);return a.instanceCount=this.instanceCount,a.isInstancedBufferGeometry=!0,a}}),fA.prototype=Object.assign(Object.create(k.prototype),{constructor:fA,isInstancedBufferAttribute:!0,copy:function(a){return k.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},toJSON:function(){var a=k.prototype.toJSON.call(this);return a.meshPerAttribute=this.meshPerAttribute,a.isInstancedBufferAttribute=!0,a}}),fn.prototype=Object.assign(Object.create(p.prototype),{constructor:fn,load:function(d,e,f,c){var a=this,b=new ae(a.manager);b.setPath(a.path),b.setRequestHeader(a.requestHeader),b.setWithCredentials(a.withCredentials),b.load(d,function(b){try{e(a.parse(JSON.parse(b)))}catch(b){c?c(b):console.error(b),a.manager.itemError(d)}},f,c)},parse:function(a){var l={},q={},e,m,B,w,v,c,g,A,p,x,t,s,j,C,d,h,r,n,z,o,f,y;function u(d,a){if(void 0!==l[a])return l[a];var b=d.interleavedBuffers[a],e=function(c,a){if(void 0!==q[a])return q[a];var d=c.arrayBuffers[a],b=new Uint32Array(d).buffer;return q[a]=b,b}(d,b.buffer),c=new T(dk(b.type,e),b.stride);return c.uuid=b.uuid,l[a]=c,c}e=a.isInstancedBufferGeometry?new dp:new i,m=a.data.index,void 0!==m&&(B=dk(m.type,m.array),e.setIndex(new k(B,1))),w=a.data.attributes;for(v in w)c=w[v],g=void 0,c.isInterleavedBufferAttribute?g=new bv(u(a.data,c.data),c.itemSize,c.offset,c.normalized):(A=dk(c.type,c.array),g=new(c.isInstancedBufferAttribute?fA:k)(A,c.itemSize,c.normalized)),void 0!==c.name&&(g.name=c.name),e.setAttribute(v,g);if(p=a.data.morphAttributes,p)for(x in p){for(t=p[x],s=[],j=0,C=t.length;j<C;j++)d=t[j],h=void 0,d.isInterleavedBufferAttribute?h=new bv(u(a.data,d.data),d.itemSize,d.offset,d.normalized):h=new k(dk(d.type,d.array),d.itemSize,d.normalized),void 0!==d.name&&(h.name=d.name),s.push(h);e.morphAttributes[x]=s}if(a.data.morphTargetsRelative&&(e.morphTargetsRelative=!0),r=a.data.groups||a.data.drawcalls||a.data.offsets,void 0!==r)for(n=0,z=r.length;n!==z;++n)o=r[n],e.addGroup(o.start,o.count,o.materialIndex);return f=a.data.boundingSphere,void 0!==f&&(y=new b,void 0!==f.center&&y.fromArray(f.center),e.boundingSphere=new aO(y,f.radius)),a.name&&(e.name=a.name),a.userData&&(e.userData=a.userData),e}}),iX=function(c){function b(a){return c.call(this,a)||this}m(b,c);var a=b.prototype;return a.load=function(a,d,e,c){var f=this,g=""===this.path?fY.extractUrlBase(a):this.path,b;this.resourcePath=this.resourcePath||g,b=new ae(this.manager),b.setPath(this.path),b.setRequestHeader(this.requestHeader),b.setWithCredentials(this.withCredentials),b.load(a,function(g){var b=null,e;try{b=JSON.parse(g)}catch(b){return void 0!==c&&c(b),void console.error("THREE:ObjectLoader: Can't parse "+a+".",b.message)}e=b.metadata,void 0!==e&&void 0!==e.type&&"geometry"!==e.type.toLowerCase()?f.parse(b,d):console.error("THREE.ObjectLoader: Can't load "+a)},e,c)},a.parse=function(a,c){var i=this.parseAnimations(a.animations),f=this.parseShapes(a.shapes),k=this.parseGeometries(a.geometries,f),d=this.parseImages(a.images,function(){void 0!==c&&c(b)}),g=this.parseTextures(a.textures,d),h=this.parseMaterials(a.materials,g),b=this.parseObject(a.object,k,h,i),j=this.parseSkeletons(a.skeletons,b),e,l;if(this.bindSkeletons(b,j),void 0!==c){e=!1;for(l in d)if(d[l]instanceof HTMLImageElement){e=!0;break}!1===e&&c(b)}return b},a.parseShapes=function(a){var c={},b,e,d;if(void 0!==a)for(b=0,e=a.length;b<e;b++)d=(new bs).fromJSON(a[b]),c[d.uuid]=d;return c},a.parseSkeletons=function(a,f){var c={},d={},b,g,e;if(f.traverse(function(a){a.isBone&&(d[a.uuid]=a)}),void 0!==a)for(b=0,g=a.length;b<g;b++)e=(new cU).fromJSON(a[b],d),c[e.uuid]=e;return c},a.parseGeometries=function(g,i){var c,j={},l,f,k,b,a,e,m,n,d,o,p,h;if(void 0!==g)for(l=new fn,f=0,k=g.length;f<k;f++){switch(b=void 0,a=g[f],a.type){case"PlaneGeometry":case"PlaneBufferGeometry":b=new J[a.type](a.width,a.height,a.widthSegments,a.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":b=new J[a.type](a.width,a.height,a.depth,a.widthSegments,a.heightSegments,a.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":b=new J[a.type](a.radius,a.segments,a.thetaStart,a.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":b=new J[a.type](a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":b=new J[a.type](a.radius,a.height,a.radialSegments,a.heightSegments,a.openEnded,a.thetaStart,a.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":b=new J[a.type](a.radius,a.widthSegments,a.heightSegments,a.phiStart,a.phiLength,a.thetaStart,a.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":b=new J[a.type](a.radius,a.detail);break;case"RingGeometry":case"RingBufferGeometry":b=new J[a.type](a.innerRadius,a.outerRadius,a.thetaSegments,a.phiSegments,a.thetaStart,a.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":b=new J[a.type](a.radius,a.tube,a.radialSegments,a.tubularSegments,a.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":b=new J[a.type](a.radius,a.tube,a.tubularSegments,a.radialSegments,a.p,a.q);break;case"TubeGeometry":case"TubeBufferGeometry":b=new J[a.type]((new fB[a.path.type]).fromJSON(a.path),a.tubularSegments,a.radius,a.radialSegments,a.closed);break;case"LatheGeometry":case"LatheBufferGeometry":b=new J[a.type](a.points,a.segments,a.phiStart,a.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":b=new J[a.type](a.vertices,a.indices,a.radius,a.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":c=[];for(e=0,m=a.shapes.length;e<m;e++)n=i[a.shapes[e]],c.push(n);b=new J[a.type](c,a.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":c=[];for(d=0,o=a.shapes.length;d<o;d++)p=i[a.shapes[d]],c.push(p);h=a.options.extrudePath,void 0!==h&&(a.options.extrudePath=(new fB[h.type]).fromJSON(h)),b=new J[a.type](c,a.options);break;case"BufferGeometry":case"InstancedBufferGeometry":b=l.parse(a);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+a.type+'"');continue}b.uuid=a.uuid,void 0!==a.name&&(b.name=a.name),!0===b.isBufferGeometry&&void 0!==a.userData&&(b.userData=a.userData),j[a.uuid]=b}return j},a.parseMaterials=function(d,k){var b={},e={},h,f,j,a,i,g,c;if(void 0!==d){h=new fG,h.setTextures(k);for(f=0,j=d.length;f<j;f++)if(a=d[f],"MultiMaterial"===a.type){for(i=[],g=0;g<a.materials.length;g++)c=a.materials[g],void 0===b[c.uuid]&&(b[c.uuid]=h.parse(c)),i.push(b[c.uuid]);e[a.uuid]=i}else void 0===b[a.uuid]&&(b[a.uuid]=h.parse(a)),e[a.uuid]=b[a.uuid]}return e},a.parseAnimations=function(a){var c={},b,e,d;if(void 0!==a)for(b=0;b<a.length;b++)e=a[b],d=X.parse(e),c[d.uuid]=d;return c},a.parseImages=function(e,n){var k,c=this,d={},l,h,o,a,g,f,m,b,i;function j(a){if("string"==typeof a){var b=a;return function(a){return c.manager.itemStart(a),k.load(a,function(){c.manager.itemEnd(a)},void 0,function(){c.manager.itemError(a),c.manager.itemEnd(a)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(b)?b:c.resourcePath+b)}return a.data?{data:dk(a.type,a.data),width:a.width,height:a.height}:null}if(void 0!==e&&e.length>0){l=new f_(n),(k=new cJ(l)).setCrossOrigin(this.crossOrigin);for(h=0,o=e.length;h<o;h++)if(a=e[h],g=a.url,Array.isArray(g)){d[a.uuid]=[];for(f=0,m=g.length;f<m;f++)b=j(g[f]),null!==b&&(b instanceof HTMLImageElement?d[a.uuid].push(b):d[a.uuid].push(new aW(b.data,b.width,b.height)))}else i=j(a.url),null!==i&&(d[a.uuid]=i)}return d},a.parseTextures=function(g,i){var f,e,h,a,b,c;function d(a,b){return"number"==typeof a?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),b[a])}if(f={},void 0!==g)for(e=0,h=g.length;e<h;e++)a=g[e],void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===i[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image),b=void 0,c=i[a.image],Array.isArray(c)?(b=new aE(c),6===c.length&&(b.needsUpdate=!0)):(b=c&&c.data?new aW(c.data,c.width,c.height):new r(c),c&&(b.needsUpdate=!0)),b.uuid=a.uuid,void 0!==a.name&&(b.name=a.name),void 0!==a.mapping&&(b.mapping=d(a.mapping,iY)),void 0!==a.offset&&b.offset.fromArray(a.offset),void 0!==a.repeat&&b.repeat.fromArray(a.repeat),void 0!==a.center&&b.center.fromArray(a.center),void 0!==a.rotation&&(b.rotation=a.rotation),void 0!==a.wrap&&(b.wrapS=d(a.wrap[0],hD),b.wrapT=d(a.wrap[1],hD)),void 0!==a.format&&(b.format=a.format),void 0!==a.type&&(b.type=a.type),void 0!==a.encoding&&(b.encoding=a.encoding),void 0!==a.minFilter&&(b.minFilter=d(a.minFilter,hC)),void 0!==a.magFilter&&(b.magFilter=d(a.magFilter,hC)),void 0!==a.anisotropy&&(b.anisotropy=a.anisotropy),void 0!==a.flipY&&(b.flipY=a.flipY),void 0!==a.premultiplyAlpha&&(b.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(b.unpackAlignment=a.unpackAlignment),f[a.uuid]=b;return f},a.parseObject=function(a,m,f,s){var b,i,h,w,x,p,l,q,n,v,u,j,r,o;function d(a){return void 0===m[a]&&console.warn("THREE.ObjectLoader: Undefined geometry",a),m[a]}function c(a){var d,b,e,c;if(void 0!==a){if(Array.isArray(a)){for(d=[],b=0,e=a.length;b<e;b++)c=a[b],void 0===f[c]&&console.warn("THREE.ObjectLoader: Undefined material",c),d.push(f[c]);return d}return void 0===f[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),f[a]}}switch(a.type){case"Scene":b=new fp,void 0!==a.background&&Number.isInteger(a.background)&&(b.background=new e(a.background)),void 0!==a.fog&&("Fog"===a.fog.type?b.fog=new gt(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(b.fog=new gu(a.fog.color,a.fog.density)));break;case"PerspectiveCamera":b=new A(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(b.focus=a.focus),void 0!==a.zoom&&(b.zoom=a.zoom),void 0!==a.filmGauge&&(b.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(b.filmOffset=a.filmOffset),void 0!==a.view&&(b.view=Object.assign({},a.view));break;case"OrthographicCamera":b=new cp(a.left,a.right,a.top,a.bottom,a.near,a.far),void 0!==a.zoom&&(b.zoom=a.zoom),void 0!==a.view&&(b.view=Object.assign({},a.view));break;case"AmbientLight":b=new fL(a.color,a.intensity);break;case"DirectionalLight":b=new fK(a.color,a.intensity);break;case"PointLight":b=new fE(a.color,a.intensity,a.distance,a.decay);break;case"RectAreaLight":b=new fT(a.color,a.intensity,a.width,a.height);break;case"SpotLight":b=new fD(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":b=new fC(a.color,a.groundColor,a.intensity);break;case"LightProbe":b=(new ac).fromJSON(a);break;case"SkinnedMesh":b=new db(i=d(a.geometry),h=c(a.material)),void 0!==a.bindMode&&(b.bindMode=a.bindMode),void 0!==a.bindMatrix&&b.bindMatrix.fromArray(a.bindMatrix),void 0!==a.skeleton&&(b.skeleton=a.skeleton);break;case"Mesh":b=new t(i=d(a.geometry),h=c(a.material));break;case"InstancedMesh":i=d(a.geometry),h=c(a.material),w=a.count,x=a.instanceMatrix,(b=new fX(i,h,w)).instanceMatrix=new k(new Float32Array(x.array),16);break;case"LOD":b=new df;break;case"Line":b=new $(d(a.geometry),c(a.material));break;case"LineLoop":b=new fO(d(a.geometry),c(a.material));break;case"LineSegments":b=new N(d(a.geometry),c(a.material));break;case"PointCloud":case"Points":b=new cL(d(a.geometry),c(a.material));break;case"Sprite":b=new di(c(a.material));break;case"Group":b=new br;break;case"Bone":b=new da;break;default:b=new g}if(b.uuid=a.uuid,void 0!==a.name&&(b.name=a.name),void 0!==a.matrix?(b.matrix.fromArray(a.matrix),void 0!==a.matrixAutoUpdate&&(b.matrixAutoUpdate=a.matrixAutoUpdate),b.matrixAutoUpdate&&b.matrix.decompose(b.position,b.quaternion,b.scale)):(void 0!==a.position&&b.position.fromArray(a.position),void 0!==a.rotation&&b.rotation.fromArray(a.rotation),void 0!==a.quaternion&&b.quaternion.fromArray(a.quaternion),void 0!==a.scale&&b.scale.fromArray(a.scale)),void 0!==a.castShadow&&(b.castShadow=a.castShadow),void 0!==a.receiveShadow&&(b.receiveShadow=a.receiveShadow),a.shadow&&(void 0!==a.shadow.bias&&(b.shadow.bias=a.shadow.bias),void 0!==a.shadow.normalBias&&(b.shadow.normalBias=a.shadow.normalBias),void 0!==a.shadow.radius&&(b.shadow.radius=a.shadow.radius),void 0!==a.shadow.mapSize&&b.shadow.mapSize.fromArray(a.shadow.mapSize),void 0!==a.shadow.camera&&(b.shadow.camera=this.parseObject(a.shadow.camera))),void 0!==a.visible&&(b.visible=a.visible),void 0!==a.frustumCulled&&(b.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(b.renderOrder=a.renderOrder),void 0!==a.userData&&(b.userData=a.userData),void 0!==a.layers&&(b.layers.mask=a.layers),void 0!==a.children)for(p=a.children,l=0;l<p.length;l++)b.add(this.parseObject(p[l],m,f,s));if(void 0!==a.animations)for(q=a.animations,n=0;n<q.length;n++)v=q[n],b.animations.push(s[v]);if("LOD"===a.type){void 0!==a.autoUpdate&&(b.autoUpdate=a.autoUpdate);for(u=a.levels,j=0;j<u.length;j++)r=u[j],o=b.getObjectByProperty("uuid",r.object),void 0!==o&&b.addLevel(o,r.distance)}return b},a.bindSkeletons=function(b,a){0!==Object.keys(a).length&&b.traverse(function(b){if(!0===b.isSkinnedMesh&&void 0!==b.skeleton){var c=a[b.skeleton];void 0===c?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",b.skeleton):b.bind(c,b.bindMatrix)}})},a.setTexturePath=function(a){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(a)},b}(p),iY={UVMapping:dc,CubeReflectionMapping:cN,CubeRefractionMapping:cM,EquirectangularReflectionMapping:de,EquirectangularRefractionMapping:dm,CubeUVReflectionMapping:bK,CubeUVRefractionMapping:cQ},hD={RepeatWrapping:dq,ClampToEdgeWrapping:L,MirroredRepeatWrapping:dA},hC={NearestFilter:C,NearestMipmapNearestFilter:fz,NearestMipmapLinearFilter:fy,LinearFilter:D,LinearMipmapNearestFilter:gw,LinearMipmapLinearFilter:cx};function hB(a){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),p.call(this,a),this.options={premultiplyAlpha:"none"}}function hA(){this.type="ShapePath",this.color=new e,this.subPaths=[],this.currentPath=null}hB.prototype=Object.assign(Object.create(p.prototype),{constructor:hB,isImageBitmapLoader:!0,setOptions:function(a){return this.options=a,this},load:function(a,c,g,f){var b,d,e;if(void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a),a=this.manager.resolveURL(a),b=this,d=bt.get(a),void 0!==d)return b.manager.itemStart(a),setTimeout(function(){c&&c(d),b.manager.itemEnd(a)},0),d;e={},e.credentials="anonymous"===this.crossOrigin?"same-origin":"include",fetch(a,e).then(function(a){return a.blob()}).then(function(a){return createImageBitmap(a,b.options)}).then(function(d){bt.add(a,d),c&&c(d),b.manager.itemEnd(a)}).catch(function(c){f&&f(c),b.manager.itemError(a),b.manager.itemEnd(a)}),b.manager.itemStart(a)}}),Object.assign(hA.prototype,{moveTo:function(a,b){return this.currentPath=new aj,this.subPaths.push(this.currentPath),this.currentPath.moveTo(a,b),this},lineTo:function(a,b){return this.currentPath.lineTo(a,b),this},quadraticCurveTo:function(a,b,c,d){return this.currentPath.quadraticCurveTo(a,b,c,d),this},bezierCurveTo:function(a,b,c,d,e,f){return this.currentPath.bezierCurveTo(a,b,c,d,e,f),this},splineThru:function(a){return this.currentPath.splineThru(a),this},toShapes:function(z,H){var j,h,g,x,c,k,i,p,u,n,a,d,b,r,C,w,v,o,B,f,A,y,m,t,s,e,l,D,q,F;function E(b){for(var c=[],a=0,e=b.length,f,d;a<e;a++)f=b[a],d=new bs,d.curves=f.curves,c.push(d);return c}function G(a,e){for(var j=e.length,i=!1,h=j-1,f=0,b,c,g,d,k;f<j;h=f++)if(b=e[h],c=e[f],g=c.x-b.x,d=c.y-b.y,Math.abs(d)>Number.EPSILON){if(d<0&&(b=e[f],g=-g,c=e[h],d=-d),a.y<b.y||a.y>c.y)continue;if(a.y===b.y){if(a.x===b.x)return!0}else{if(k=d*(a.x-b.x)-g*(a.y-b.y),0===k)return!0;if(k<0)continue;i=!i}}else{if(a.y!==b.y)continue;if(c.x<=a.x&&a.x<=b.x||b.x<=a.x&&a.x<=c.x)return!0}return i}if(x=aB.isClockWise,c=this.subPaths,0===c.length)return[];if(!0===H)return E(c);if(k=[],1===c.length)return h=c[0],(g=new bs).curves=h.curves,k.push(g),k;i=!x(c[0].getPoints()),i=z?!i:i,n=[],a=[],d=[],b=0,a[b]=void 0,d[b]=[];for(r=0,C=c.length;r<C;r++)j=x(p=(h=c[r]).getPoints()),(j=z?!j:j)?(!i&&a[b]&&b++,a[b]={s:new bs,p},a[b].s.curves=h.curves,i&&b++,d[b]=[]):d[b].push({h,p:p[0]});if(!a[0])return E(c);if(a.length>1){for(w=!1,v=[],o=0,B=a.length;o<B;o++)n[o]=[];for(f=0,A=a.length;f<A;f++)for(y=d[f],m=0;m<y.length;m++){for(t=y[m],s=!0,e=0;e<a.length;e++)G(t.p,a[e].p)&&(f!==e&&v.push({froms:f,tos:e,hole:m}),s?(s=!1,n[e].push(t)):w=!0);s&&n[f].push(t)}v.length>0&&(w||(d=n))}for(l=0,D=a.length;l<D;l++){g=a[l].s,k.push(g);for(q=0,F=(u=d[l]).length;q<F;q++)g.holes.push(u[q].h)}return k}}),hy=function(){function a(a){Object.defineProperty(this,"isFont",{value:!0}),this.type="Font",this.data=a}return a.prototype.generateShapes=function(e,a){void 0===a&&(a=100);for(var c=[],d=function(d,k,a){for(var i=Array.from?Array.from(d):String(d).split(""),e=k/a.resolution,l=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*e,g=[],b=0,h=0,c=0,j,f;c<i.length;c++)j=i[c],"\n"===j?(b=0,h-=l):(f=kb(j,e,b,h,a),b+=f.offsetX,g.push(f.path));return g}(e,a,this.data),b=0,f=d.length;b<f;b++)Array.prototype.push.apply(c,d[b].toShapes());return c},a}();function kb(o,c,d,e,n){var f=n.glyphs[o]||n.glyphs["?"],h,m,i,j,k,l,q,p,g,a,b,r;if(f){if(g=new hA,f.o)for(a=f._cachedOutline||(f._cachedOutline=f.o.split(" ")),b=0,r=a.length;b<r;)switch(a[b++]){case"m":h=a[b++]*c+d,m=a[b++]*c+e,g.moveTo(h,m);break;case"l":h=a[b++]*c+d,m=a[b++]*c+e,g.lineTo(h,m);break;case"q":i=a[b++]*c+d,j=a[b++]*c+e,k=a[b++]*c+d,l=a[b++]*c+e,g.quadraticCurveTo(k,l,i,j);break;case"b":i=a[b++]*c+d,j=a[b++]*c+e,k=a[b++]*c+d,l=a[b++]*c+e,q=a[b++]*c+d,p=a[b++]*c+e,g.bezierCurveTo(k,l,q,p,i,j)}return{offsetX:f.ha*c,path:g}}console.error('THREE.Font: character "'+o+'" does not exists in font family '+n.familyName+".")}function hx(a){p.call(this,a)}hx.prototype=Object.assign(Object.create(p.prototype),{constructor:hx,load:function(d,b,e,f){var c=this,a=new ae(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(c.withCredentials),a.load(d,function(a){var d,e;try{d=JSON.parse(a)}catch(b){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),d=JSON.parse(a.substring(65,a.length-2))}e=c.parse(d),b&&b(e)},e,f)},parse:function(a){return new hy(a)}}),fm={getContext:function(){return void 0===dD&&(dD=new(window.AudioContext||window.webkitAudioContext)),dD},setContext:function(a){dD=a}};function fg(a){p.call(this,a)}function hu(i,j,h){ac.call(this,void 0,h);var a=(new e).set(i),c=(new e).set(j),g=new b(a.r,a.g,a.b),d=new b(c.r,c.g,c.b),f=Math.sqrt(Math.PI),k=f*Math.sqrt(.75);this.sh.coefficients[0].copy(g).add(d).multiplyScalar(f),this.sh.coefficients[1].copy(g).sub(d).multiplyScalar(k)}function ht(b,c){ac.call(this,void 0,c);var a=(new e).set(b);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}fg.prototype=Object.assign(Object.create(p.prototype),{constructor:fg,load:function(d,e,f,c){var a=this,b=new ae(a.manager);b.setResponseType("arraybuffer"),b.setPath(a.path),b.setRequestHeader(a.requestHeader),b.setWithCredentials(a.withCredentials),b.load(d,function(b){try{var f=b.slice(0);fm.getContext().decodeAudioData(f,function(a){e(a)})}catch(b){c?c(b):console.error(b),a.manager.itemError(d)}},f,c)}}),hu.prototype=Object.assign(Object.create(ac.prototype),{constructor:hu,isHemisphereLightProbe:!0,copy:function(a){return ac.prototype.copy.call(this,a),this},toJSON:function(a){return ac.prototype.toJSON.call(this,a)}}),ht.prototype=Object.assign(Object.create(ac.prototype),{constructor:ht,isAmbientLightProbe:!0,copy:function(a){return ac.prototype.copy.call(this,a),this},toJSON:function(a){return ac.prototype.toJSON.call(this,a)}}),hs=new o,hr=new o;function jl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new A,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new A,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(jl.prototype,{update:function(b){var a=this._cache,c,d,e,h,f,g;(a.focus!==b.focus||a.fov!==b.fov||a.aspect!==b.aspect*this.aspect||a.near!==b.near||a.far!==b.far||a.zoom!==b.zoom||a.eyeSep!==this.eyeSep)&&(a.focus=b.focus,a.fov=b.fov,a.aspect=b.aspect*this.aspect,a.near=b.near,a.far=b.far,a.zoom=b.zoom,a.eyeSep=this.eyeSep,e=b.projectionMatrix.clone(),h=a.eyeSep/2,f=h*a.near/a.focus,g=a.near*Math.tan(l.DEG2RAD*a.fov*.5)/a.zoom,hr.elements[12]=-h,hs.elements[12]=h,c=-g*a.aspect+f,d=g*a.aspect+f,e.elements[0]=2*a.near/(d-c),e.elements[8]=(d+c)/(d-c),this.cameraL.projectionMatrix.copy(e),c=-g*a.aspect-f,d=g*a.aspect-f,e.elements[0]=2*a.near/(d-c),e.elements[8]=(d+c)/(d-c),this.cameraR.projectionMatrix.copy(e)),this.cameraL.matrixWorld.copy(b.matrixWorld).multiply(hr),this.cameraR.matrixWorld.copy(b.matrixWorld).multiply(hs)}}),hq=function(){function b(a){this.autoStart=void 0===a||a,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var a=b.prototype;return a.start=function(){this.startTime=jn(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},a.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},a.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},a.getDelta=function(){var a=0,b;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(b=jn(),a=(b-this.oldTime)/1e3,this.oldTime=b,this.elapsedTime+=a),a)},b}();function jn(){return("undefined"==typeof performance?Date:performance).now()}bc=new b,hp=new G,jq=new b,be=new b,js=function(b){function c(){var a;return(a=b.call(this)||this).type="AudioListener",a.context=fm.getContext(),a.gain=a.context.createGain(),a.gain.connect(a.context.destination),a.filter=null,a.timeDelta=0,a._clock=new hq,a}m(c,b);var a=c.prototype;return a.getInput=function(){return this.gain},a.removeFilter=function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},a.getFilter=function(){return this.filter},a.setFilter=function(a){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},a.getMasterVolume=function(){return this.gain.gain.value},a.setMasterVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},a.updateMatrixWorld=function(e){var a,d,c;b.prototype.updateMatrixWorld.call(this,e),a=this.context.listener,d=this.up,(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(bc,hp,jq),be.set(0,0,-1).applyQuaternion(hp),a.positionX)?(c=this.context.currentTime+this.timeDelta,a.positionX.linearRampToValueAtTime(bc.x,c),a.positionY.linearRampToValueAtTime(bc.y,c),a.positionZ.linearRampToValueAtTime(bc.z,c),a.forwardX.linearRampToValueAtTime(be.x,c),a.forwardY.linearRampToValueAtTime(be.y,c),a.forwardZ.linearRampToValueAtTime(be.z,c),a.upX.linearRampToValueAtTime(d.x,c),a.upY.linearRampToValueAtTime(d.y,c),a.upZ.linearRampToValueAtTime(d.z,c)):(a.setPosition(bc.x,bc.y,bc.z),a.setOrientation(be.x,be.y,be.z,d.x,d.y,d.z))},c}(g),eS=function(c){function b(b){var a;return(a=c.call(this)||this).type="Audio",a.listener=b,a.context=b.context,a.gain=a.context.createGain(),a.gain.connect(b.getInput()),a.autoplay=!1,a.buffer=null,a.detune=0,a.loop=!1,a.loopStart=0,a.loopEnd=0,a.offset=0,a.duration=void 0,a.playbackRate=1,a.isPlaying=!1,a.hasPlaybackControl=!0,a.source=null,a.sourceType="empty",a._startedAt=0,a._progress=0,a._connected=!1,a.filters=[],a}m(b,c);var a=b.prototype;return a.getOutput=function(){return this.gain},a.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},a.setMediaElementSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this},a.setMediaStreamSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),this.connect(),this},a.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this},a.play=function(b){if(void 0===b&&(b=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+b;var a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},a.pause=function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},a.stop=function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},a.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},a.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,b=this.filters.length;a<b;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},a.getFilters=function(){return this.filters},a.setFilters=function(a){return a||(a=[]),!0===this._connected?(this.disconnect(),this.filters=a.slice(),this.connect()):this.filters=a.slice(),this},a.setDetune=function(a){if(this.detune=a,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},a.getDetune=function(){return this.detune},a.getFilter=function(){return this.getFilters()[0]},a.setFilter=function(a){return this.setFilters(a?[a]:[])},a.setPlaybackRate=function(a){if(!1!==this.hasPlaybackControl)return this.playbackRate=a,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},a.getPlaybackRate=function(){return this.playbackRate},a.onEnded=function(){this.isPlaying=!1},a.getLoop=function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},a.setLoop=function(a){if(!1!==this.hasPlaybackControl)return this.loop=a,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},a.setLoopStart=function(a){return this.loopStart=a,this},a.setLoopEnd=function(a){return this.loopEnd=a,this},a.getVolume=function(){return this.gain.gain.value},a.setVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},b}(g),bo=new b,hn=new G,jw=new b,bp=new b,jy=function(b){function c(c){var a;return(a=b.call(this,c)||this).panner=a.context.createPanner(),a.panner.panningModel="HRTF",a.panner.connect(a.gain),a}m(c,b);var a=c.prototype;return a.getOutput=function(){return this.panner},a.getRefDistance=function(){return this.panner.refDistance},a.setRefDistance=function(a){return this.panner.refDistance=a,this},a.getRolloffFactor=function(){return this.panner.rolloffFactor},a.setRolloffFactor=function(a){return this.panner.rolloffFactor=a,this},a.getDistanceModel=function(){return this.panner.distanceModel},a.setDistanceModel=function(a){return this.panner.distanceModel=a,this},a.getMaxDistance=function(){return this.panner.maxDistance},a.setMaxDistance=function(a){return this.panner.maxDistance=a,this},a.setDirectionalCone=function(a,b,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=b,this.panner.coneOuterGain=c,this},a.updateMatrixWorld=function(d){var a,c;(b.prototype.updateMatrixWorld.call(this,d),!0!==this.hasPlaybackControl||!1!==this.isPlaying)&&(this.matrixWorld.decompose(bo,hn,jw),bp.set(0,0,1).applyQuaternion(hn),a=this.panner,a.positionX?(c=this.context.currentTime+this.listener.timeDelta,a.positionX.linearRampToValueAtTime(bo.x,c),a.positionY.linearRampToValueAtTime(bo.y,c),a.positionZ.linearRampToValueAtTime(bo.z,c),a.orientationX.linearRampToValueAtTime(bp.x,c),a.orientationY.linearRampToValueAtTime(bp.y,c),a.orientationZ.linearRampToValueAtTime(bp.z,c)):(a.setPosition(bo.x,bo.y,bo.z),a.setOrientation(bp.x,bp.y,bp.z)))},c}(eS),hm=function(){function a(b,a){void 0===a&&(a=2048),this.analyser=b.context.createAnalyser(),this.analyser.fftSize=a,this.data=new Uint8Array(this.analyser.frequencyBinCount),b.getOutput().connect(this.analyser)}var b=a.prototype;return b.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},b.getAverageFrequency=function(){for(var c=0,a=this.getFrequencyData(),b=0;b<a.length;b++)c+=a[b];return c/a.length},a}();function hl(e,f,a){var b,c,d;switch(this.binding=e,this.valueSize=a,f){case"quaternion":b=this._slerp,c=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*a),this._workIndex=5;break;case"string":case"bool":b=this._select,c=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(5*a);break;default:b=this._lerp,c=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*a)}this._mixBufferRegion=b,this._mixBufferRegionAdditive=c,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(hl.prototype,{accumulate:function(g,d){var e=this.buffer,b=this.valueSize,f=g*b+b,c=this.cumulativeWeight,a,h;if(0===c){for(a=0;a!==b;++a)e[f+a]=e[a];c=d}else h=d/(c+=d),this._mixBufferRegion(e,f,0,h,b);this.cumulativeWeight=c},accumulateAdditive:function(a){var c=this.buffer,b=this.valueSize,d=b*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,d,0,a,b),this.cumulativeWeightAdditive+=a},apply:function(f){var a=this.valueSize,b=this.buffer,d=f*a+a,e=this.cumulativeWeight,g=this.cumulativeWeightAdditive,h=this.binding,i,c,j;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,e<1&&(i=a*this._origIndex,this._mixBufferRegion(b,d,i,1-e,a)),g>0&&this._mixBufferRegionAdditive(b,d,this._addIndex*a,1,a);for(c=a,j=a+a;c!==j;++c)if(b[c]!==b[c+a]){h.setValue(b,d);break}},saveOriginalState:function(){var e=this.binding,b=this.buffer,c=this.valueSize,d=c*this._origIndex,a,f;e.getValue(b,d);for(a=c,f=d;a!==f;++a)b[a]=b[d+a%c];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var a=3*this.valueSize;this.binding.setValue(this.buffer,a)},_setAdditiveIdentityNumeric:function(){for(var b=this._addIndex*this.valueSize,c=b+this.valueSize,a=b;a<c;a++)this.buffer[a]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var b=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize,a=0;a<this.valueSize;a++)this.buffer[c+a]=this.buffer[b+a]},_select:function(b,c,d,e,f){if(e>=.5)for(var a=0;a!==f;++a)b[c+a]=b[d+a]},_slerp:function(a,b,c,d){G.slerpFlat(a,b,a,b,a,c,d)},_slerpAdditive:function(a,b,d,e,f){var c=this._workIndex*f;G.multiplyQuaternionsFlat(a,c,a,b,a,d),G.slerpFlat(a,b,a,b,a,c,e)},_lerp:function(b,h,e,d,f){for(var g=1-d,a=0,c;a!==f;++a)c=h+a,b[c]=b[c]*g+b[e+a]*d},_lerpAdditive:function(b,d,e,f,g){for(var a=0,c;a!==g;++a)c=d+a,b[c]=b[c]+b[e+a]*f}}),jB="\\[\\]\\.:\\/",jC=new RegExp("[\\[\\]\\.:\\/]","g"),eI="[^\\[\\]\\.:\\/]",jE="[^"+jB.replace("\\.","")+"]",jj=/((?:WC+[\/:])*)/.source.replace("WC",eI),jG=/(WCOD+)?/.source.replace("WCOD",jE),jH=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",eI),jI=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",eI),jJ=new RegExp("^"+jj+jG+jH+jI+"$"),jK=["material","materials","bones"];function jL(a,b,c){var d=c||I.parseTrackName(b);this._targetGroup=a,this._bindings=a.subscribe_(b,d)}function I(a,b,c){this.path=b,this.parsedPath=c||I.parseTrackName(b),this.node=I.findNode(a,this.parsedPath.nodeName)||a,this.rootNode=a}function jN(){var c,a,d,b;this.uuid=l.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0,c={},this._indicesByUUID=c;for(a=0,d=arguments.length;a!==d;++a)c[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={},b=this,this.stats={objects:{get total(){return b._objects.length},get inUse(){return this.total-b.nCachedObjects_}},get bindingsPerObject(){return b._bindings.length}}}Object.assign(jL.prototype,{getValue:function(b,c){this.bind();var d=this._targetGroup.nCachedObjects_,a=this._bindings[d];void 0!==a&&a.getValue(b,c)},setValue:function(c,d){for(var b=this._bindings,a=this._targetGroup.nCachedObjects_,e=b.length;a!==e;++a)b[a].setValue(c,d)},bind:function(){for(var b=this._bindings,a=this._targetGroup.nCachedObjects_,c=b.length;a!==c;++a)b[a].bind()},unbind:function(){for(var b=this._bindings,a=this._targetGroup.nCachedObjects_,c=b.length;a!==c;++a)b[a].unbind()}}),Object.assign(I,{Composite:jL,create:function(a,b,c){return a&&a.isAnimationObjectGroup?new I.Composite(a,b,c):new I(a,b,c)},sanitizeNodeName:function(a){return a.replace(/\s/g,"_").replace(jC,"")},parseTrackName:function(d){var b=jJ.exec(d),a,c,e;if(!b)throw new Error("PropertyBinding: Cannot parse trackName: "+d);if(a={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},c=a.nodeName&&a.nodeName.lastIndexOf("."),void 0!==c&&-1!==c&&(e=a.nodeName.substring(c+1),-1!==jK.indexOf(e)&&(a.nodeName=a.nodeName.substring(0,c),a.objectName=e)),null===a.propertyName||0===a.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+d);return a},findNode:function(b,a){var c,d;if(!a||""===a||"."===a||-1===a||a===b.name||a===b.uuid)return b;if(b.skeleton)if(c=b.skeleton.getBoneByName(a),void 0!==c)return c;if(b.children)if(d=function f(d){for(var c=0,b,e;c<d.length;c++){if(b=d[c],b.name===a||b.uuid===a)return b;if(e=f(b.children),e)return e}return null}(b.children),d)return d;return null}}),Object.assign(I.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(a,b){a[b]=this.node[this.propertyName]},function(c,d){for(var b=this.resolvedProperty,a=0,e=b.length;a!==e;++a)c[d++]=b[a]},function(a,b){a[b]=this.resolvedProperty[this.propertyIndex]},function(a,b){this.resolvedProperty.toArray(a,b)}],SetterByBindingTypeAndVersioning:[[function(a,b){this.targetObject[this.propertyName]=a[b]},function(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.needsUpdate=!0},function(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(c,d){for(var b=this.resolvedProperty,a=0,e=b.length;a!==e;++a)b[a]=c[d++]},function(c,d){for(var b=this.resolvedProperty,a=0,e=b.length;a!==e;++a)b[a]=c[d++];this.targetObject.needsUpdate=!0},function(c,d){for(var b=this.resolvedProperty,a=0,e=b.length;a!==e;++a)b[a]=c[d++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty[this.propertyIndex]=a[b]},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(a,b){this.resolvedProperty.fromArray(a,b)},function(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.needsUpdate=!0},function(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(a,b){this.bind(),this.getValue(a,b)},setValue:function(a,b){this.bind(),this.setValue(a,b)},bind:function(){var a=this.node,c=this.parsedPath,g=c.objectName,i=c.propertyName,e=c.propertyIndex,f,h,b,j,d,k;if(a||(a=I.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,a){if(g){switch(f=c.objectIndex,g){case"materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(h=0;h<a.length;h++)if(a[h].name===f){f=h;break}break;default:if(void 0===a[g])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);a=a[g]}if(void 0!==f){if(void 0===a[f])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[f]}}if(b=a[i],void 0!==b){if(j=this.Versioning.None,this.targetObject=a,void 0!==a.needsUpdate?j=this.Versioning.NeedsUpdate:void 0!==a.matrixWorldNeedsUpdate&&(j=this.Versioning.MatrixWorldNeedsUpdate),d=this.BindingType.Direct,void 0!==e){if("morphTargetInfluences"===i){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}d=this.BindingType.ArrayElement,this.resolvedProperty=b,this.propertyIndex=e}else void 0!==b.fromArray&&void 0!==b.toArray?(d=this.BindingType.HasFromToArray,this.resolvedProperty=b):Array.isArray(b)?(d=this.BindingType.EntireArray,this.resolvedProperty=b):this.propertyName=i;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][j]}else k=c.nodeName,console.error("THREE.PropertyBinding: Trying to update property for track: "+k+"."+i+" but it wasn't found.",a)}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(I.prototype,{_getValue_unbound:I.prototype.getValue,_setValue_unbound:I.prototype.setValue}),Object.assign(jN.prototype,{isAnimationObjectGroup:!0,add:function(){for(var b=this._objects,h=this._indicesByUUID,o=this._paths,q=this._parsedPaths,l=this._bindings,n=l.length,r=void 0,v=b.length,j=this.nCachedObjects_,k=0,t=arguments.length,f,i,a,e,s,d,p,c,u,g,w,m;k!==t;++k)if(f=arguments[k],i=f.uuid,a=h[i],void 0===a){a=v++,h[i]=a,b.push(f);for(e=0,s=n;e!==s;++e)l[e].push(new I(f,o[e],q[e]))}else if(a<j){r=b[a],d=--j,p=b[d],h[p.uuid]=a,b[a]=p,h[i]=d,b[d]=f;for(c=0,u=n;c!==u;++c)g=l[c],w=g[d],m=g[a],g[a]=w,void 0===m&&(m=new I(f,o[c],q[c])),g[d]=m}else b[a]!==r&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.");this.nCachedObjects_=j},remove:function(){for(var f=this._objects,e=this._indicesByUUID,k=this._bindings,o=k.length,h=this.nCachedObjects_,g=0,m=arguments.length,j,l,a,b,i,d,n,c,p,q;g!==m;++g)if(j=arguments[g],l=j.uuid,a=e[l],void 0!==a&&a>=h){b=h++,i=f[b],e[i.uuid]=a,f[a]=i,e[l]=b,f[b]=j;for(d=0,n=o;d!==n;++d)c=k[d],p=c[b],q=c[a],c[a]=p,c[b]=q}this.nCachedObjects_=h},uncache:function(){for(var a=this._objects,d=this._indicesByUUID,f=this._bindings,p=f.length,k=this.nCachedObjects_,r=a.length,h=0,u=arguments.length,w,m,b,c,s,n,o,i,v,e,y,t,g,q,j,x,l;h!==u;++h)if(w=arguments[h],m=w.uuid,b=d[m],void 0!==b)if(delete d[m],b<k){c=--k,s=a[c],n=--r,o=a[n],d[s.uuid]=b,a[b]=s,d[o.uuid]=c,a[c]=o,a.pop();for(i=0,v=p;i!==v;++i)e=f[i],y=e[c],t=e[n],e[b]=y,e[c]=t,e.pop()}else{g=--r,q=a[g],g>0&&(d[q.uuid]=b),a[b]=q,a.pop();for(j=0,x=p;j!==x;++j)l=f[j],l[b]=l[g],l.pop()}this.nCachedObjects_=k},subscribe_:function(a,h){var g=this._bindingsIndicesByPath,c=g[a],e=this._bindings,j,i,f,k,l,d,b,m,n;if(void 0!==c)return e[c];j=this._paths,i=this._parsedPaths,f=this._objects,k=f.length,l=this.nCachedObjects_,d=new Array(k),c=e.length,g[a]=c,j.push(a),i.push(h),e.push(d);for(b=l,m=f.length;b!==m;++b)n=f[b],d[b]=new I(n,a,h);return d},unsubscribe_:function(g){var f=this._bindingsIndicesByPath,a=f[g],d,e,c,b,h;void 0!==a&&(d=this._paths,e=this._parsedPaths,c=this._bindings,b=c.length-1,h=c[b],f[g[b]]=a,c[a]=h,c.pop(),e[a]=e[b],e.pop(),d[a]=d[b],d.pop())}}),jO=function(){function b(j,d,h,e){var f,b,c,g,a,i;void 0===h&&(h=null),void 0===e&&(e=d.blendMode),this._mixer=j,this._clip=d,this._localRoot=h,this.blendMode=e;for(f=d.tracks,b=f.length,c=new Array(b),g={endingStart:bn,endingEnd:bn},a=0;a!==b;++a)i=f[a].createInterpolant(null),c[a]=i,i.settings=g;this._interpolantSettings=g,this._interpolants=c,this._propertyBindings=new Array(b),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var a=b.prototype;return a.play=function(){return this._mixer._activateAction(this),this},a.stop=function(){return this._mixer._deactivateAction(this),this.reset()},a.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},a.isRunning=function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},a.isScheduled=function(){return this._mixer._isActiveAction(this)},a.startAt=function(a){return this._startTime=a,this},a.setLoop=function(a,b){return this.loop=a,this.repetitions=b,this},a.setEffectiveWeight=function(a){return this.weight=a,this._effectiveWeight=this.enabled?a:0,this.stopFading()},a.getEffectiveWeight=function(){return this._effectiveWeight},a.fadeIn=function(a){return this._scheduleFading(a,0,1)},a.fadeOut=function(a){return this._scheduleFading(a,1,0)},a.crossFadeFrom=function(b,a,e){if(b.fadeOut(a),this.fadeIn(a),e){var c=this._clip.duration,d=b._clip.duration,f=d/c,g=c/d;b.warp(1,f,a),this.warp(g,1,a)}return this},a.crossFadeTo=function(a,b,c){return a.crossFadeFrom(this,b,c)},a.stopFading=function(){var a=this._weightInterpolant;return null!==a&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},a.setEffectiveTimeScale=function(a){return this.timeScale=a,this._effectiveTimeScale=this.paused?0:a,this.stopWarping()},a.getEffectiveTimeScale=function(){return this._effectiveTimeScale},a.setDuration=function(a){return this.timeScale=this._clip.duration/a,this.stopWarping()},a.syncWith=function(a){return this.time=a.time,this.timeScale=a.timeScale,this.stopWarping()},a.halt=function(a){return this.warp(this._effectiveTimeScale,0,a)},a.warp=function(g,h,i){var d=this._mixer,e=d.time,f=this.timeScale,a=this._timeScaleInterpolant,b,c;return null===a&&(a=d._lendControlInterpolant(),this._timeScaleInterpolant=a),b=a.parameterPositions,c=a.sampleValues,b[0]=e,b[1]=e+i,c[0]=g/f,c[1]=h/f,this},a.stopWarping=function(){var a=this._timeScaleInterpolant;return null!==a&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(a)),this},a.getMixer=function(){return this._mixer},a.getClip=function(){return this._clip},a.getRoot=function(){return this._localRoot||this._mixer._root},a._update=function(e,k,j,n){var h,f,g,d,c,i,b,l,a,m;if(this.enabled){{if(h=this._startTime,null!==h){if(f=(e-h)*j,f<0||0===j)return;this._startTime=null,k=j*f}if(k*=this._updateTimeScale(e),g=this._updateTime(k),d=this._updateWeight(e),d>0)switch(c=this._interpolants,i=this._propertyBindings,this.blendMode){case ff:for(b=0,l=c.length;b!==l;++b)c[b].evaluate(g),i[b].accumulateAdditive(d);break;case ek:default:for(a=0,m=c.length;a!==m;++a)c[a].evaluate(g),i[a].accumulate(n,d)}}}else this._updateWeight(e)},a._updateWeight=function(c){var a=0,b,d;return this.enabled&&(a=this.weight,b=this._weightInterpolant,null!==b&&(d=b.evaluate(c)[0],a*=d,c>b.parameterPositions[1]&&(this.stopFading(),0===d&&(this.enabled=!1)))),this._effectiveWeight=a,a},a._updateTimeScale=function(c){var a=0,b;return this.paused||(a=this.timeScale,b=this._timeScaleInterpolant,null!==b&&(a*=b.evaluate(c)[0],c>b.parameterPositions[1]&&(this.stopWarping(),0===a?this.paused=!0:this.timeScale=a))),this._effectiveTimeScale=a,a},a._updateTime=function(d){var c=this._clip.duration,g=this.loop,a=this.time+d,b=this._loopCount,e=2202===g,f,h,i;if(0===d)return-1===b?a:e&&1==(1&b)?c-a:a;if(2200===g){-1===b&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(a>=c)a=c;else{if(!(a<0)){this.time=a;break t}a=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:d<0?-1:1})}}else if(-1===b&&(d>=0?(b=0,this._setEndings(!0,0===this.repetitions,e)):this._setEndings(0===this.repetitions,!0,e)),a>=c||a<0?(f=Math.floor(a/c),a-=c*f,b+=Math.abs(f),h=this.repetitions-b,h<=0?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,a=d>0?c:0,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:d>0?1:-1})):(1===h?(i=d<0,this._setEndings(i,!i,e)):this._setEndings(!1,!1,e),this._loopCount=b,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f}))):this.time=a,e&&1==(1&b))return c-a;return a},a._setEndings=function(b,c,d){var a=this._interpolantSettings;d?(a.endingStart=bm,a.endingEnd=bm):(a.endingStart=b?this.zeroSlopeAtStart?bm:bn:cg,a.endingEnd=c?this.zeroSlopeAtEnd?bm:bn:cg)},a._scheduleFading=function(g,h,f){var d=this._mixer,e=d.time,a=this._weightInterpolant,b,c;return null===a&&(a=d._lendControlInterpolant(),this._weightInterpolant=a),b=a.parameterPositions,c=a.sampleValues,b[0]=e,c[0]=h,b[1]=e+g,c[1]=f,this},b}();function hi(a){this._root=a,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}hi.prototype=Object.assign(Object.create(aN.prototype),{constructor:hi,_bindAction:function(f,l){var i=f._localRoot||this._root,k=f._clip.tracks,m=k.length,g=f._propertyBindings,n=f._interpolants,c=i.uuid,j=this._bindingsByRootAndName,e=j[c],b,h,d,a,o;void 0===e&&(e={},j[c]=e);for(b=0;b!==m;++b){if(h=k[b],d=h.name,a=e[d],void 0!==a)g[b]=a;else{if(void 0!==(a=g[b])){null===a._cacheIndex&&(++a.referenceCount,this._addInactiveBinding(a,c,d));continue}o=l&&l._propertyBindings[b].binding.parsedPath,++(a=new hl(I.create(i,d,o),h.ValueTypeName,h.getValueSize())).referenceCount,this._addInactiveBinding(a,c,d),g[b]=a}n[b].resultBuffer=a.buffer}},_activateAction:function(a){var h,d,e,f,c,g,b;if(!this._isActiveAction(a)){null===a._cacheIndex&&(h=(a._localRoot||this._root).uuid,d=a._clip.uuid,e=this._actionsByClip[d],this._bindAction(a,e&&e.knownActions[0]),this._addInactiveAction(a,d,h));for(f=a._propertyBindings,c=0,g=f.length;c!==g;++c)b=f[c],0==b.useCount++&&(this._lendBinding(b),b.saveOriginalState());this._lendAction(a)}},_deactivateAction:function(c){var d,a,e,b;if(this._isActiveAction(c)){for(d=c._propertyBindings,a=0,e=d.length;a!==e;++a)b=d[a],0==--b.useCount&&(b.restoreOriginalState(),this._takeBackBinding(b));this._takeBackAction(c)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var a=this;this.stats={actions:{get total(){return a._actions.length},get inUse(){return a._nActiveActions}},bindings:{get total(){return a._bindings.length},get inUse(){return a._nActiveBindings}},controlInterpolants:{get total(){return a._controlInterpolants.length},get inUse(){return a._nActiveControlInterpolants}}}},_isActiveAction:function(b){var a=b._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(a,c,g){var d=this._actions,e=this._actionsByClip,b=e[c],f;void 0===b?(b={knownActions:[a],actionByRoot:{}},a._byClipCacheIndex=0,e[c]=b):(f=b.knownActions,a._byClipCacheIndex=f.length,f.push(a)),a._cacheIndex=d.length,d.push(a),b.actionByRoot[g]=a},_removeInactiveAction:function(a){var c=this._actions,d=c[c.length-1],e=a._cacheIndex,f,g,h,b,i,j;d._cacheIndex=e,c[e]=d,c.pop(),a._cacheIndex=null,f=a._clip.uuid,g=this._actionsByClip,h=g[f],b=h.knownActions,i=b[b.length-1],j=a._byClipCacheIndex,i._byClipCacheIndex=j,b[j]=i,b.pop(),a._byClipCacheIndex=null,delete h.actionByRoot[(a._localRoot||this._root).uuid],0===b.length&&delete g[f],this._removeInactiveBindingsForAction(a)},_removeInactiveBindingsForAction:function(d){for(var b=d._propertyBindings,a=0,e=b.length,c;a!==e;++a)c=b[a],0==--c.referenceCount&&this._removeInactiveBinding(c)},_lendAction:function(a){var b=this._actions,d=a._cacheIndex,c=this._nActiveActions++,e=b[c];a._cacheIndex=c,b[c]=a,e._cacheIndex=d,b[d]=e},_takeBackAction:function(a){var b=this._actions,d=a._cacheIndex,c=--this._nActiveActions,e=b[c];a._cacheIndex=c,b[c]=a,e._cacheIndex=d,b[d]=e},_addInactiveBinding:function(b,c,f){var d=this._bindingsByRootAndName,e=this._bindings,a=d[c];void 0===a&&(a={},d[c]=a),a[f]=b,b._cacheIndex=e.length,e.push(b)},_removeInactiveBinding:function(b){var a=this._bindings,c=b.binding,d=c.rootNode.uuid,i=c.path,e=this._bindingsByRootAndName,f=e[d],g=a[a.length-1],h=b._cacheIndex;g._cacheIndex=h,a[h]=g,a.pop(),delete f[i],0===Object.keys(f).length&&delete e[d]},_lendBinding:function(a){var b=this._bindings,d=a._cacheIndex,c=this._nActiveBindings++,e=b[c];a._cacheIndex=c,b[c]=a,e._cacheIndex=d,b[d]=e},_takeBackBinding:function(a){var b=this._bindings,d=a._cacheIndex,c=--this._nActiveBindings,e=b[c];a._cacheIndex=c,b[c]=a,e._cacheIndex=d,b[d]=e},_lendControlInterpolant:function(){var c=this._controlInterpolants,b=this._nActiveControlInterpolants++,a=c[b];return void 0===a&&((a=new ej(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=b,c[b]=a),a},_takeBackControlInterpolant:function(a){var b=this._controlInterpolants,d=a.__cacheIndex,c=--this._nActiveControlInterpolants,e=b[c];a.__cacheIndex=c,b[c]=a,e.__cacheIndex=d,b[d]=e},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(b,i,c){var j=i||this._root,k=j.uuid,a="string"==typeof b?X.findByName(j,b):b,h=null!==a?a.uuid:b,d=this._actionsByClip[h],g=null,e,f;if(void 0===c&&(c=null!==a?a.blendMode:ek),void 0!==d){if(e=d.actionByRoot[k],void 0!==e&&e.blendMode===c)return e;g=d.knownActions[0],null===a&&(a=g._clip)}return null===a?null:(f=new jO(this,a,i,c),this._bindAction(f,g),this._addInactiveAction(f,h,k),f)},existingAction:function(a,e){var b=e||this._root,f=b.uuid,c="string"==typeof a?X.findByName(b,a):a,g=c?c.uuid:a,d=this._actionsByClip[g];return void 0!==d&&d.actionByRoot[f]||null},stopAllAction:function(){for(var b=this._actions,a=this._nActiveActions-1;a>=0;--a)b[a].stop();return this},update:function(a){var e,f,j,g,d,c,h,i,b;a*=this.timeScale;for(e=this._actions,f=this._nActiveActions,j=this.time+=a,g=Math.sign(a),d=this._accuIndex^=1,c=0;c!==f;++c)e[c]._update(j,a,g,d);for(h=this._bindings,i=this._nActiveBindings,b=0;b!==i;++b)h[b].apply(d);return this},setTime:function(b){this.time=0;for(var a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(b)},getRoot:function(){return this._root},uncacheClip:function(j){var b=this._actions,g=j.uuid,d=this._actionsByClip,e=d[g],f,c,k,a,h,i;if(void 0!==e){for(f=e.knownActions,c=0,k=f.length;c!==k;++c)a=f[c],this._deactivateAction(a),h=a._cacheIndex,i=b[b.length-1],a._cacheIndex=null,a._byClipCacheIndex=null,i._cacheIndex=h,b[h]=i,b.pop(),this._removeInactiveBindingsForAction(a);delete d[g]}},uncacheRoot:function(f){var c=f.uuid,d=this._actionsByClip,g,a,b,h,e;for(g in d)a=d[g].actionByRoot[c],void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a));if(b=this._bindingsByRootAndName[c],void 0!==b)for(h in b)e=b[h],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(b,c){var a=this.existingAction(b,c);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}}),hh=function(){function a(a){"string"==typeof a&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),a=arguments[1]),this.value=a}return a.prototype.clone=function(){return new a(void 0===this.value.clone?this.value:this.value.clone())},a}();function hg(a,b,c){T.call(this,a,b),this.meshPerAttribute=c||1}function hf(a,b,c,d,e){this.buffer=a,this.type=b,this.itemSize=c,this.elementSize=d,this.count=e,this.version=0}function he(a,b,c,d){this.ray=new bG(a,b),this.near=c||0,this.far=d||1/0,this.camera=null,this.layers=new eE,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function jM(a,b){return a.distance-b.distance}function hd(a,b,d,f){if(a.layers.test(b.layers)&&a.raycast(b,d),!0===f)for(var e=a.children,c=0,g=e.length;c<g;c++)hd(e[c],b,d,!0)}hg.prototype=Object.assign(Object.create(T.prototype),{constructor:hg,isInstancedInterleavedBuffer:!0,copy:function(a){return T.prototype.copy.call(this,a),this.meshPerAttribute=a.meshPerAttribute,this},clone:function(b){var a=T.prototype.clone.call(this,b);return a.meshPerAttribute=this.meshPerAttribute,a},toJSON:function(b){var a=T.prototype.toJSON.call(this,b);return a.isInstancedInterleavedBuffer=!0,a.meshPerAttribute=this.meshPerAttribute,a}}),Object.defineProperty(hf.prototype,"needsUpdate",{set:function(a){!0===a&&this.version++}}),Object.assign(hf.prototype,{isGLBufferAttribute:!0,setBuffer:function(a){return this.buffer=a,this},setType:function(a,b){return this.type=a,this.elementSize=b,this},setItemSize:function(a){return this.itemSize=a,this},setCount:function(a){return this.count=a,this}}),Object.assign(he.prototype,{set:function(a,b){this.ray.set(a,b)},setFromCamera:function(b,a){a&&a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(b.x,b.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a&&a.isOrthographicCamera?(this.ray.origin.set(b.x,b.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("THREE.Raycaster: Unsupported camera type: "+a.type)},intersectObject:function(b,c,d){var a=d||[];return hd(b,this,a,c),a.sort(jM),a},intersectObjects:function(b,d,e){var a=e||[],c,f;if(!1===Array.isArray(b))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),a;for(c=0,f=b.length;c<f;c++)hd(b[c],this,a,d);return a.sort(jM),a}}),ju=function(){function b(a,b,c){return void 0===a&&(a=1),void 0===b&&(b=0),void 0===c&&(c=0),this.radius=a,this.phi=b,this.theta=c,this}var a=b.prototype;return a.set=function(a,b,c){return this.radius=a,this.phi=b,this.theta=c,this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.radius=a.radius,this.phi=a.phi,this.theta=a.theta,this},a.makeSafe=function(){var a=1e-6;return this.phi=Math.max(a,Math.min(Math.PI-a,this.phi)),this},a.setFromVector3=function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},a.setFromCartesianCoords=function(a,b,c){return this.radius=Math.sqrt(a*a+b*b+c*c),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(a,c),this.phi=Math.acos(l.clamp(b/this.radius,-1,1))),this},b}(),jo=function(){function b(a,b,c){return this.radius=void 0!==a?a:1,this.theta=void 0!==b?b:0,this.y=void 0!==c?c:0,this}var a=b.prototype;return a.set=function(a,b,c){return this.radius=a,this.theta=b,this.y=c,this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.radius=a.radius,this.theta=a.theta,this.y=a.y,this},a.setFromVector3=function(a){return this.setFromCartesianCoords(a.x,a.y,a.z)},a.setFromCartesianCoords=function(a,c,b){return this.radius=Math.sqrt(a*a+b*b),this.theta=Math.atan2(a,b),this.y=c,this},b}(),hc=new c,ha=function(){function b(a,b){Object.defineProperty(this,"isBox2",{value:!0}),this.min=void 0!==a?a:new c(1/0,1/0),this.max=void 0!==b?b:new c(-1/0,-1/0)}var a=b.prototype;return a.set=function(a,b){return this.min.copy(a),this.max.copy(b),this},a.setFromPoints=function(b){this.makeEmpty();for(var a=0,c=b.length;a<c;a++)this.expandByPoint(b[a]);return this},a.setFromCenterAndSize=function(a,c){var b=hc.copy(c).multiplyScalar(.5);return this.min.copy(a).sub(b),this.max.copy(a).add(b),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.min.copy(a.min),this.max.copy(a.max),this},a.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},a.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},a.getCenter=function(a){return void 0===a&&(console.warn("THREE.Box2: .getCenter() target is now required"),a=new c),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)},a.getSize=function(a){return void 0===a&&(console.warn("THREE.Box2: .getSize() target is now required"),a=new c),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min)},a.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},a.expandByVector=function(a){return this.min.sub(a),this.max.add(a),this},a.expandByScalar=function(a){return this.min.addScalar(-a),this.max.addScalar(a),this},a.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},a.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},a.getParameter=function(b,a){return void 0===a&&(console.warn("THREE.Box2: .getParameter() target is now required"),a=new c),a.set((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y))},a.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},a.clampPoint=function(b,a){return void 0===a&&(console.warn("THREE.Box2: .clampPoint() target is now required"),a=new c),a.copy(b).clamp(this.min,this.max)},a.distanceToPoint=function(a){return hc.copy(a).clamp(this.min,this.max).sub(a).length()},a.intersect=function(a){return this.min.max(a.min),this.max.min(a.max),this},a.union=function(a){return this.min.min(a.min),this.max.max(a.max),this},a.translate=function(a){return this.min.add(a),this.max.add(a),this},a.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},b}(),g$=new b,dY=new b,gZ=function(){function c(a,c){this.start=void 0!==a?a:new b,this.end=void 0!==c?c:new b}var a=c.prototype;return a.set=function(a,b){return this.start.copy(a),this.end.copy(b),this},a.clone=function(){return(new this.constructor).copy(this)},a.copy=function(a){return this.start.copy(a.start),this.end.copy(a.end),this},a.getCenter=function(a){return void 0===a&&(console.warn("THREE.Line3: .getCenter() target is now required"),a=new b),a.addVectors(this.start,this.end).multiplyScalar(.5)},a.delta=function(a){return void 0===a&&(console.warn("THREE.Line3: .delta() target is now required"),a=new b),a.subVectors(this.end,this.start)},a.distanceSq=function(){return this.start.distanceToSquared(this.end)},a.distance=function(){return this.start.distanceTo(this.end)},a.at=function(c,a){return void 0===a&&(console.warn("THREE.Line3: .at() target is now required"),a=new b),this.delta(a).multiplyScalar(c).add(this.start)},a.closestPointToPointParameter=function(b,c){g$.subVectors(b,this.start),dY.subVectors(this.end,this.start);var d=dY.dot(dY),a=dY.dot(g$)/d;return c&&(a=l.clamp(a,0,1)),a},a.closestPointToPoint=function(c,d,a){var e=this.closestPointToPointParameter(c,d);return void 0===a&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),a=new b),this.delta(a).multiplyScalar(e).add(this.start)},a.applyMatrix4=function(a){return this.start.applyMatrix4(a),this.end.applyMatrix4(a),this},a.equals=function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},c}();function dZ(a){g.call(this),this.material=a,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}dZ.prototype=Object.create(g.prototype),dZ.prototype.constructor=dZ,dZ.prototype.isImmediateRenderObject=!0,gY=new b,i$=function(b){function a(d,l){var a,g,h,c,j,e,k,m;(a=b.call(this)||this).light=d,a.light.updateMatrixWorld(),a.matrix=d.matrixWorld,a.matrixAutoUpdate=!1,a.color=l;for(g=new i,h=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],c=0,j=1;c<32;c++,j++)e=c/32*Math.PI*2,k=j/32*Math.PI*2,h.push(Math.cos(e),Math.sin(e),1,Math.cos(k),Math.sin(k),1);return g.setAttribute("position",new f(h,3)),m=new w({fog:!1,toneMapped:!1}),a.cone=new N(g,m),a.add(a.cone),a.update(),a}m(a,b);var c=a.prototype;return c.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},c.update=function(){this.light.updateMatrixWorld();var a=this.light.distance?this.light.distance:1e3,b=a*Math.tan(this.light.angle);this.cone.scale.set(b,b,a),gY.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(gY),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},a}(g),aV=new b,d$=new o,eH=new o,gW=function(a){function b(c){for(var b,d=iP(c),g=new i,h=[],j=[],k=new e(0,0,1),l=new e(0,1,0),m=0,n,o;m<d.length;m++)n=d[m],n.parent&&n.parent.isBone&&(h.push(0,0,0),h.push(0,0,0),j.push(k.r,k.g,k.b),j.push(l.r,l.g,l.b));return g.setAttribute("position",new f(h,3)),g.setAttribute("color",new f(j,3)),o=new w({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),(b=a.call(this,g,o)||this).type="SkeletonHelper",b.isSkeletonHelper=!0,b.root=c,b.bones=d,b.matrix=c.matrixWorld,b.matrixAutoUpdate=!1,b}return m(b,a),b.prototype.updateMatrixWorld=function(h){var e=this.bones,f=this.geometry,g=f.getAttribute("position"),c,d,b;eH.copy(this.root.matrixWorld).invert();for(c=0,d=0;c<e.length;c++)b=e[c],b.parent&&b.parent.isBone&&(d$.multiplyMatrices(eH,b.matrixWorld),aV.setFromMatrixPosition(d$),g.setXYZ(d,aV.x,aV.y,aV.z),d$.multiplyMatrices(eH,b.parent.matrixWorld),aV.setFromMatrixPosition(d$),g.setXYZ(d+1,aV.x,aV.y,aV.z),d+=2);f.getAttribute("position").needsUpdate=!0,a.prototype.updateMatrixWorld.call(this,h)},b}(N);function iP(a){var b=[],c;a&&a.isBone&&b.push(a);for(c=0;c<a.children.length;c++)b.push.apply(b,iP(a.children[c]));return b}iO=function(b){function a(c,d,e){var a,f=new cv(d,4,2),g=new W({wireframe:!0,fog:!1,toneMapped:!1});return(a=b.call(this,f,g)||this).light=c,a.light.updateMatrixWorld(),a.color=e,a.type="PointLightHelper",a.matrix=a.light.matrixWorld,a.matrixAutoUpdate=!1,a.update(),a}m(a,b);var c=a.prototype;return c.dispose=function(){this.geometry.dispose(),this.material.dispose()},c.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},a}(t),iN=new b,gV=new e,gU=new e,iM=function(b){function a(d,e,f){var a,c,g,h;return(a=b.call(this)||this).light=d,a.light.updateMatrixWorld(),a.matrix=d.matrixWorld,a.matrixAutoUpdate=!1,a.color=f,c=new co(e),c.rotateY(.5*Math.PI),a.material=new W({wireframe:!0,fog:!1,toneMapped:!1}),void 0===a.color&&(a.material.vertexColors=!0),g=c.getAttribute("position"),h=new Float32Array(3*g.count),c.setAttribute("color",new k(h,3)),a.add(new t(c,a.material)),a.update(),a}m(a,b);var c=a.prototype;return c.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},c.update=function(){var d=this.children[0],b,a,e,c;if(void 0!==this.color)this.material.color.set(this.color);else{b=d.geometry.getAttribute("color"),gV.copy(this.light.color),gU.copy(this.light.groundColor);for(a=0,e=b.count;a<e;a++)c=a<e/2?gV:gU,b.setXYZ(a,c.r,c.g,c.b);b.needsUpdate=!0}d.lookAt(iN.setFromMatrixPosition(this.light.matrixWorld).negate())},a}(g),gT=function(a){function b(m,d,g,h){var q,s,r,k,n,c,o,b,j,l,p,t;void 0===m&&(m=10),void 0===d&&(d=10),void 0===g&&(g=4473924),void 0===h&&(h=8947848),g=new e(g),h=new e(h);for(s=d/2,r=m/d,k=m/2,n=[],c=[],o=0,b=0,j=-k;o<=d;o++,j+=r)n.push(-k,0,j,k,0,j),n.push(j,0,-k,j,0,k),l=o===s?g:h,l.toArray(c,b),b+=3,l.toArray(c,b),b+=3,l.toArray(c,b),b+=3,l.toArray(c,b),b+=3;return p=new i,p.setAttribute("position",new f(n,3)),p.setAttribute("color",new f(c,3)),t=new w({vertexColors:!0,toneMapped:!1}),(q=a.call(this,p,t)||this).type="GridHelper",q}return m(b,a),b}(N),iL=function(a){function b(c,r,p,k,d,g){var x,m,j,n,y,z,A,b,s,h,q,o,l,t,v,u,B;void 0===c&&(c=10),void 0===r&&(r=16),void 0===p&&(p=8),void 0===k&&(k=64),void 0===d&&(d=4473924),void 0===g&&(g=8947848),d=new e(d),g=new e(g);for(m=[],j=[],n=0;n<=r;n++)y=n/r*(2*Math.PI),z=Math.sin(y)*c,A=Math.cos(y)*c,m.push(0,0,0),m.push(z,0,A),b=1&n?d:g,j.push(b.r,b.g,b.b),j.push(b.r,b.g,b.b);for(s=0;s<=p;s++)for(h=1&s?d:g,q=c-c/p*s,o=0;o<k;o++)l=o/k*(2*Math.PI),t=Math.sin(l)*q,v=Math.cos(l)*q,m.push(t,0,v),j.push(h.r,h.g,h.b),l=(o+1)/k*(2*Math.PI),t=Math.sin(l)*q,v=Math.cos(l)*q,m.push(t,0,v),j.push(h.r,h.g,h.b);return u=new i,u.setAttribute("position",new f(m,3)),u.setAttribute("color",new f(j,3)),B=new w({vertexColors:!0,toneMapped:!1}),(x=a.call(this,u,B)||this).type="PolarGridHelper",x}return m(b,a),b}(N),gS=new b,eh=new b,gP=new b,iJ=function(b){function a(e,c,h){var a,d,g;return(a=b.call(this)||this).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=h,void 0===c&&(c=1),d=new i,d.setAttribute("position",new f([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3)),g=new w({fog:!1,toneMapped:!1}),a.lightPlane=new $(d,g),a.add(a.lightPlane),(d=new i).setAttribute("position",new f([0,0,0,0,0,1],3)),a.targetLine=new $(d,g),a.add(a.targetLine),a.update(),a}m(a,b);var c=a.prototype;return c.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},c.update=function(){gS.setFromMatrixPosition(this.light.matrixWorld),eh.setFromMatrixPosition(this.light.target.matrixWorld),gP.subVectors(eh,gS),this.lightPlane.lookAt(eh),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(eh),this.targetLine.scale.z=gP.length()},a}(g),el=new b,x=new az,iH=function(b){function a(n){var d,m=new i,r=new w({color:16777215,vertexColors:!0,toneMapped:!1}),k=[],o=[],h={},c=new e(16755200),j=new e(16711680),l=new e(43775),q=new e(16777215),g=new e(3355443);function a(b,c,a){p(b,a),p(c,a)}function p(a,b){k.push(0,0,0),o.push(b.r,b.g,b.b),void 0===h[a]&&(h[a]=[]),h[a].push(k.length/3-1)}return a("n1","n2",c),a("n2","n4",c),a("n4","n3",c),a("n3","n1",c),a("f1","f2",c),a("f2","f4",c),a("f4","f3",c),a("f3","f1",c),a("n1","f1",c),a("n2","f2",c),a("n3","f3",c),a("n4","f4",c),a("p","n1",j),a("p","n2",j),a("p","n3",j),a("p","n4",j),a("u1","u2",l),a("u2","u3",l),a("u3","u1",l),a("c","t",q),a("p","c",g),a("cn1","cn2",g),a("cn3","cn4",g),a("cf1","cf2",g),a("cf3","cf4",g),m.setAttribute("position",new f(k,3)),m.setAttribute("color",new f(o,3)),(d=b.call(this,m,r)||this).type="CameraHelper",d.camera=n,d.camera.updateProjectionMatrix&&d.camera.updateProjectionMatrix(),d.matrix=n.matrixWorld,d.matrixAutoUpdate=!1,d.pointMap=h,d.update(),d}return m(a,b),a.prototype.update=function(){var a=this.geometry,b=this.pointMap;x.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),z("c",b,a,x,0,0,-1),z("t",b,a,x,0,0,1),z("n1",b,a,x,-1,-1,-1),z("n2",b,a,x,1,-1,-1),z("n3",b,a,x,-1,1,-1),z("n4",b,a,x,1,1,-1),z("f1",b,a,x,-1,-1,1),z("f2",b,a,x,1,-1,1),z("f3",b,a,x,-1,1,1),z("f4",b,a,x,1,1,1),z("u1",b,a,x,.7,1.1,-1),z("u2",b,a,x,-.7,1.1,-1),z("u3",b,a,x,0,2,-1),z("cf1",b,a,x,-1,0,1),z("cf2",b,a,x,1,0,1),z("cf3",b,a,x,0,-1,1),z("cf4",b,a,x,0,1,1),z("cn1",b,a,x,-1,0,-1),z("cn2",b,a,x,1,0,-1),z("cn3",b,a,x,0,-1,-1),z("cn4",b,a,x,0,1,-1),a.getAttribute("position").needsUpdate=!0},a}(N);function z(e,h,i,j,k,f,g){var a,c,b,d;if(el.set(k,f,g).unproject(j),a=h[e],void 0!==a)for(c=i.getAttribute("position"),b=0,d=a.length;b<d;b++)c.setXYZ(a[b],el.x,el.y,el.z)}dX=new aF,gK=function(c){function a(e,b){var a,f,g,d;return void 0===b&&(b=16776960),f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(24),d=new i,d.setIndex(new k(f,1)),d.setAttribute("position",new k(g,3)),(a=c.call(this,d,new w({color:b,toneMapped:!1}))||this).object=e,a.type="BoxHelper",a.matrixAutoUpdate=!1,a.update(),a}m(a,c);var b=a.prototype;return b.update=function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&dX.setFromObject(this.object),!dX.isEmpty()){var b=dX.min,c=dX.max,d=this.geometry.attributes.position,a=d.array;a[0]=c.x,a[1]=c.y,a[2]=c.z,a[3]=b.x,a[4]=c.y,a[5]=c.z,a[6]=b.x,a[7]=b.y,a[8]=c.z,a[9]=c.x,a[10]=b.y,a[11]=c.z,a[12]=c.x,a[13]=c.y,a[14]=b.z,a[15]=b.x,a[16]=c.y,a[17]=b.z,a[18]=b.x,a[19]=b.y,a[20]=b.z,a[21]=c.x,a[22]=b.y,a[23]=b.z,d.needsUpdate=!0,this.geometry.computeBoundingSphere()}},b.setFromObject=function(a){return this.object=a,this.update(),this},b.copy=function(a){return N.prototype.copy.call(this,a),this.object=a.object,this},a}(N),iE=function(a){function b(e,c){var b,g,d;return void 0===c&&(c=16776960),g=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new i,d.setIndex(new k(g,1)),d.setAttribute("position",new f([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),(b=a.call(this,d,new w({color:c,toneMapped:!1}))||this).box=e,b.type="Box3Helper",b.geometry.computeBoundingSphere(),b}return m(b,a),b.prototype.updateMatrixWorld=function(c){var b=this.box;b.isEmpty()||(b.getCenter(this.position),b.getSize(this.scale),this.scale.multiplyScalar(.5),a.prototype.updateMatrixWorld.call(this,c))},b}(N),iD=function(a){function b(j,d,e){var b,h,g,c;return void 0===d&&(d=1),void 0===e&&(e=16776960),h=e,g=new i,g.setAttribute("position",new f([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),g.computeBoundingSphere(),(b=a.call(this,g,new w({color:h,toneMapped:!1}))||this).type="PlaneHelper",b.plane=j,b.size=d,c=new i,c.setAttribute("position",new f([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),c.computeBoundingSphere(),b.add(new t(c,new W({color:h,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),b}return m(b,a),b.prototype.updateMatrixWorld=function(c){var b=-this.plane.constant;Math.abs(b)<1e-8&&(b=1e-8),this.scale.set(.5*this.size,.5*this.size,b),this.children[0].material.side=b<0?1:0,this.lookAt(this.plane.normal),a.prototype.updateMatrixWorld.call(this,c)},b}($),gJ=new b,iC=function(c){function d(k,h,d,e,g,j){var a;return(a=c.call(this)||this).type="ArrowHelper",void 0===k&&(k=new b(0,0,1)),void 0===h&&(h=new b(0,0,0)),void 0===d&&(d=1),void 0===e&&(e=16776960),void 0===g&&(g=.2*d),void 0===j&&(j=.2*g),void 0===et&&((et=new i).setAttribute("position",new f([0,0,0,0,1,0],3)),(gN=new ca(0,.5,1,5,1)).translate(0,-.5,0)),a.position.copy(h),a.line=new $(et,new w({color:e,toneMapped:!1})),a.line.matrixAutoUpdate=!1,a.add(a.line),a.cone=new t(gN,new W({color:e,toneMapped:!1})),a.cone.matrixAutoUpdate=!1,a.add(a.cone),a.setDirection(k),a.setLength(d,g,j),a}m(d,c);var a=d.prototype;return a.setDirection=function(a){if(a.y>.99999)this.quaternion.set(0,0,0,1);else if(a.y<-.99999)this.quaternion.set(1,0,0,0);else{gJ.set(a.z,0,-a.x).normalize();var b=Math.acos(a.y);this.quaternion.setFromAxisAngle(gJ,b)}},a.setLength=function(c,a,b){void 0===a&&(a=.2*c),void 0===b&&(b=.2*a),this.line.scale.set(1,Math.max(1e-4,c-a),1),this.line.updateMatrix(),this.cone.scale.set(b,a,b),this.cone.position.y=c,this.cone.updateMatrix()},a.setColor=function(a){this.line.material.color.set(a),this.cone.material.color.set(a)},a.copy=function(a){return c.prototype.copy.call(this,a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this},d}(g),gG=function(a){function b(b){var d,e,c,g;return void 0===b&&(b=1),e=[0,0,0,b,0,0,0,0,0,0,b,0,0,0,0,0,0,b],c=new i,c.setAttribute("position",new f(e,3)),c.setAttribute("color",new f([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),g=new w({vertexColors:!0,toneMapped:!1}),(d=a.call(this,c,g)||this).type="AxesHelper",d}return m(b,a),b}(N),gF=new Float32Array(1),iz=new Int32Array(gF.buffer),iy={toHalfFloat:function(e){gF[0]=e;var c=iz[0],b=c>>16&32768,d=c>>12&2047,a=c>>23&255;return a<103?b:a>142?(b|=31744,b|=(255==a?0:1)&&8388607&c):a<113?b|=((d|=2048)>>114-a)+(d>>113-a&1):(b|=a-112<<10|d>>1,b+=1&d)}},ah=Math.pow(2,8),gE=[.125,.215,.35,.446,.526,.582],gD=5+gE.length,cy=20,an=((aH={})[3e3]=0,aH[3001]=1,aH[3002]=2,aH[3004]=3,aH[3005]=4,aH[3006]=5,aH[3007]=6,aH),bb=new W({side:1,depthWrite:!1,depthTest:!1}),ir=new t(new bf,bb),eM=new cp,eQ=ld(),ck=eQ._lodPlanes,gB=eQ._sizeLods,dQ=eQ._sigmas,gz=new e,e_=null,bk=(1+Math.sqrt(5))/2,bO=1/bk,gq=[new b(1,1,1),new b(-1,1,1),new b(1,1,-1),new b(-1,1,-1),new b(0,bk,bO),new b(0,bk,-bO),new b(bO,0,bk),new b(-bO,0,bk),new b(bk,bO,0),new b(-bk,bO,0)];function ie(a){var c=Math.max(a.r,a.g,a.b),b=Math.min(Math.max(Math.ceil(Math.log2(c)),-128),127);return a.multiplyScalar(Math.pow(2,-b)),(b+128)/255}id=function(){function c(e){var a,c,d;this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=(a=cy,c=new Float32Array(a),d=new b(0,1,0),new aS({name:"SphericalGaussianBlur",defines:{n:a},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:c},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:d},inputEncoding:{value:an[3e3]},outputEncoding:{value:an[3e3]}},vertexShader:"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute vec3 position;\n		attribute vec2 uv;\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	",fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform int samples;\n			uniform float weights[ n ];\n			uniform bool latitudinal;\n			uniform float dTheta;\n			uniform float mipInt;\n			uniform vec3 poleAxis;\n\n			\n\n		uniform int inputEncoding;\n		uniform int outputEncoding;\n\n		#include <encodings_pars_fragment>\n\n		vec4 inputTexelToLinear( vec4 value ) {\n\n			if ( inputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( inputEncoding == 1 ) {\n\n				return sRGBToLinear( value );\n\n			} else if ( inputEncoding == 2 ) {\n\n				return RGBEToLinear( value );\n\n			} else if ( inputEncoding == 3 ) {\n\n				return RGBMToLinear( value, 7.0 );\n\n			} else if ( inputEncoding == 4 ) {\n\n				return RGBMToLinear( value, 16.0 );\n\n			} else if ( inputEncoding == 5 ) {\n\n				return RGBDToLinear( value, 256.0 );\n\n			} else {\n\n				return GammaToLinear( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 linearToOutputTexel( vec4 value ) {\n\n			if ( outputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( outputEncoding == 1 ) {\n\n				return LinearTosRGB( value );\n\n			} else if ( outputEncoding == 2 ) {\n\n				return LinearToRGBE( value );\n\n			} else if ( outputEncoding == 3 ) {\n\n				return LinearToRGBM( value, 7.0 );\n\n			} else if ( outputEncoding == 4 ) {\n\n				return LinearToRGBM( value, 16.0 );\n\n			} else if ( outputEncoding == 5 ) {\n\n				return LinearToRGBD( value, 256.0 );\n\n			} else {\n\n				return LinearToGamma( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 envMapTexelToLinear( vec4 color ) {\n\n			return inputTexelToLinear( color );\n\n		}\n	\n\n			#define ENVMAP_TYPE_CUBE_UV\n			#include <cube_uv_reflection_fragment>\n\n			vec3 getSample( float theta, vec3 axis ) {\n\n				float cosTheta = cos( theta );\n				// Rodrigues' axis-angle rotation\n				vec3 sampleDirection = vOutputDirection * cosTheta\n					+ cross( axis, vOutputDirection ) * sin( theta )\n					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n				return bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n			}\n\n			void main() {\n\n				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n				}\n\n				axis = normalize( axis );\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n				for ( int i = 1; i < n; i++ ) {\n\n					if ( i >= samples ) {\n\n						break;\n\n					}\n\n					float theta = dTheta * float( i );\n					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n				}\n\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var a=c.prototype;return a.fromScene=function(e,b,c,d){void 0===b&&(b=0),void 0===c&&(c=.1),void 0===d&&(d=100),e_=this._renderer.getRenderTarget();var a=this._allocateTargets();return this._sceneToCubeUV(e,c,d,a),b>0&&this._blur(a,0,0,b),this._applyPMREM(a),this._cleanup(a),a},a.fromEquirectangular=function(a){return this._fromTexture(a)},a.fromCubemap=function(a){return this._fromTexture(a)},a.compileCubemapShader=function(){null===this._cubemapShader&&(this._cubemapShader=h$(),this._compileMaterial(this._cubemapShader))},a.compileEquirectangularShader=function(){null===this._equirectShader&&(this._equirectShader=ia(),this._compileMaterial(this._equirectShader))},a.dispose=function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var a=0;a<ck.length;a++)ck[a].dispose()},a._cleanup=function(a){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(e_),a.scissorTest=!1,fW(a,0,0,a.width,a.height)},a._fromTexture=function(b){e_=this._renderer.getRenderTarget();var a=this._allocateTargets(b);return this._textureToCubeUV(b,a),this._applyPMREM(a),this._cleanup(a),a},a._allocateTargets=function(a){var b={magFilter:C,minFilter:C,generateMipmaps:!1,type:bT,format:1023,encoding:lc(a)?a.encoding:fa,depthBuffer:!1},c=ic(b);return c.depthBuffer=!a,this._pingPongRenderTarget=ic(b),c},a._compileMaterial=function(a){var b=new t(ck[0],a);this._renderer.compile(b,eM)},a._sceneToCubeUV=function(d,p,m,j){var c=new A(90,1,p,m),g=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],a=this._renderer,q=a.autoClear,k=a.outputEncoding,l=a.toneMapping,f,e,n,o,b,i;a.getClearColor(gz),a.toneMapping=0,a.outputEncoding=aR,a.autoClear=!1,f=!1,e=d.background,e?e.isColor&&(bb.color.copy(e).convertSRGBToLinear(),d.background=null,n=ie(bb.color),bb.opacity=n,f=!0):(bb.color.copy(gz).convertSRGBToLinear(),o=ie(bb.color),bb.opacity=o,f=!0);for(b=0;b<6;b++)i=b%3,0==i?(c.up.set(0,g[b],0),c.lookAt(h[b],0,0)):1==i?(c.up.set(0,0,g[b]),c.lookAt(0,h[b],0)):(c.up.set(0,g[b],0),c.lookAt(0,0,h[b])),fW(j,i*ah,b>2?ah:0,ah,ah),a.setRenderTarget(j),f&&a.render(ir,c),a.render(d,c);a.toneMapping=l,a.outputEncoding=k,a.autoClear=q},a._textureToCubeUV=function(a,c){var d=this._renderer,e,f,b;a.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=h$()):null==this._equirectShader&&(this._equirectShader=ia()),e=a.isCubeTexture?this._cubemapShader:this._equirectShader,f=new t(ck[0],e),b=e.uniforms,b.envMap.value=a,a.isCubeTexture||b.texelSize.value.set(1/a.image.width,1/a.image.height),b.inputEncoding.value=an[a.encoding],b.outputEncoding.value=an[c.texture.encoding],fW(c,0,0,3*ah,2*ah),d.setRenderTarget(c),d.render(f,eM)},a._applyPMREM=function(c){var b=this._renderer,d=b.autoClear,a,e,f;b.autoClear=!1;for(a=1;a<gD;a++)e=Math.sqrt(dQ[a]*dQ[a]-dQ[a-1]*dQ[a-1]),f=gq[(a-1)%gq.length],this._blur(c,a-1,a,e,f);b.autoClear=d},a._blur=function(b,f,a,c,d){var e=this._pingPongRenderTarget;this._halfBlur(b,e,f,a,c,"latitudinal",d),this._halfBlur(e,b,a,a,c,"longitudinal",d)},a._halfBlur=function(l,o,u,d,h,i,r){var q=this._renderer,p=this._blurMaterial,v,a,w,m,n,g,c,j,b,s,k,e,f;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!"),v=new t(ck[d],p),a=p.uniforms,w=gB[u]-1,m=isFinite(h)?Math.PI/(2*w):2*Math.PI/39,n=h/m,g=isFinite(h)?1+Math.floor(3*n):cy,g>cy&&console.warn("sigmaRadians, "+h+", is too large and will clip, as it requested "+g+" samples when the maximum is set to "+cy);for(c=[],j=0,b=0;b<cy;++b)s=b/n,k=Math.exp(-s*s/2),c.push(k),0==b?j+=k:b<g&&(j+=2*k);for(e=0;e<c.length;e++)c[e]=c[e]/j;a.envMap.value=l.texture,a.samples.value=g,a.weights.value=c,a.latitudinal.value="latitudinal"===i,r&&(a.poleAxis.value=r),a.dTheta.value=m,a.mipInt.value=8-u,a.inputEncoding.value=an[l.texture.encoding],a.outputEncoding.value=an[l.texture.encoding],f=gB[d],fW(o,3*Math.max(0,ah-2*f),(0===d?0:2*ah)+2*f*(d>4?d-8+4:0),3*f,2*f),q.setRenderTarget(o),q.render(v,eM)},c}();function lc(a){return void 0!==a&&a.type===bT&&(a.encoding===aR||a.encoding===dM||a.encoding===fb)}function ld(){for(var m=[],s=[],r=[],l=8,f=0,h,j,q,e,c,v,n,o,p,a,b,d,t,u,g;f<gD;f++){h=Math.pow(2,l),s.push(h),j=1/h,f>4?j=gE[f-8+4-1]:0==f&&(j=0),r.push(j);for(q=1/(h-1),e=-q/2,c=1+q/2,v=[e,e,c,e,c,c,e,e,c,c,e,c],n=new Float32Array(108),o=new Float32Array(72),p=new Float32Array(36),a=0;a<6;a++)b=a%3*2/3-1,d=a>2?0:-1,t=[b,d,0,b+2/3,d,0,b+2/3,d+1,0,b,d,0,b+2/3,d+1,0,b,d+1,0],n.set(t,18*a),o.set(v,12*a),u=[a,a,a,a,a,a],p.set(u,6*a);g=new i,g.setAttribute("position",new k(n,3)),g.setAttribute("uv",new k(o,2)),g.setAttribute("faceIndex",new k(p,1)),m.push(g),l>4&&l--}return{_lodPlanes:m,_sizeLods:s,_sigmas:r}}function ic(b){var a=new aI(3*ah,3*ah,b);return a.texture.mapping=bK,a.texture.name="PMREM.cubeUv",a.scissorTest=!0,a}function fW(a,b,c,d,e){a.viewport.set(b,c,d,e),a.scissor.set(b,c,d,e)}function ia(){return new aS({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new c(1,1)},inputEncoding:{value:an[3e3]},outputEncoding:{value:an[3e3]}},vertexShader:"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute vec3 position;\n		attribute vec2 uv;\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	",fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform sampler2D envMap;\n			uniform vec2 texelSize;\n\n			\n\n		uniform int inputEncoding;\n		uniform int outputEncoding;\n\n		#include <encodings_pars_fragment>\n\n		vec4 inputTexelToLinear( vec4 value ) {\n\n			if ( inputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( inputEncoding == 1 ) {\n\n				return sRGBToLinear( value );\n\n			} else if ( inputEncoding == 2 ) {\n\n				return RGBEToLinear( value );\n\n			} else if ( inputEncoding == 3 ) {\n\n				return RGBMToLinear( value, 7.0 );\n\n			} else if ( inputEncoding == 4 ) {\n\n				return RGBMToLinear( value, 16.0 );\n\n			} else if ( inputEncoding == 5 ) {\n\n				return RGBDToLinear( value, 256.0 );\n\n			} else {\n\n				return GammaToLinear( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 linearToOutputTexel( vec4 value ) {\n\n			if ( outputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( outputEncoding == 1 ) {\n\n				return LinearTosRGB( value );\n\n			} else if ( outputEncoding == 2 ) {\n\n				return LinearToRGBE( value );\n\n			} else if ( outputEncoding == 3 ) {\n\n				return LinearToRGBM( value, 7.0 );\n\n			} else if ( outputEncoding == 4 ) {\n\n				return LinearToRGBM( value, 16.0 );\n\n			} else if ( outputEncoding == 5 ) {\n\n				return LinearToRGBD( value, 256.0 );\n\n			} else {\n\n				return LinearToGamma( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 envMapTexelToLinear( vec4 color ) {\n\n			return inputTexelToLinear( color );\n\n		}\n	\n\n			#include <common>\n\n			void main() {\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n				vec3 outputDirection = normalize( vOutputDirection );\n				vec2 uv = equirectUv( outputDirection );\n\n				vec2 f = fract( uv / texelSize - 0.5 );\n				uv -= f * texelSize;\n				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.x += texelSize.x;\n				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.y += texelSize.y;\n				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n				uv.x -= texelSize.x;\n				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n				vec3 tm = mix( tl, tr, f.x );\n				vec3 bm = mix( bl, br, f.x );\n				gl_FragColor.rgb = mix( tm, bm, f.y );\n\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function h$(){return new aS({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:an[3e3]},outputEncoding:{value:an[3e3]}},vertexShader:"\n\n		precision mediump float;\n		precision mediump int;\n\n		attribute vec3 position;\n		attribute vec2 uv;\n		attribute float faceIndex;\n\n		varying vec3 vOutputDirection;\n\n		// RH coordinate system; PMREM face-indexing convention\n		vec3 getDirection( vec2 uv, float face ) {\n\n			uv = 2.0 * uv - 1.0;\n\n			vec3 direction = vec3( uv, 1.0 );\n\n			if ( face == 0.0 ) {\n\n				direction = direction.zyx; // ( 1, v, u ) pos x\n\n			} else if ( face == 1.0 ) {\n\n				direction = direction.xzy;\n				direction.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n			} else if ( face == 2.0 ) {\n\n				direction.x *= -1.0; // ( -u, v, 1 ) pos z\n\n			} else if ( face == 3.0 ) {\n\n				direction = direction.zyx;\n				direction.xz *= -1.0; // ( -1, v, -u ) neg x\n\n			} else if ( face == 4.0 ) {\n\n				direction = direction.xzy;\n				direction.xy *= -1.0; // ( -u, -1, v ) neg y\n\n			} else if ( face == 5.0 ) {\n\n				direction.z *= -1.0; // ( u, v, -1 ) neg z\n\n			}\n\n			return direction;\n\n		}\n\n		void main() {\n\n			vOutputDirection = getDirection( uv, faceIndex );\n			gl_Position = vec4( position, 1.0 );\n\n		}\n	",fragmentShader:"\n\n			precision mediump float;\n			precision mediump int;\n\n			varying vec3 vOutputDirection;\n\n			uniform samplerCube envMap;\n\n			\n\n		uniform int inputEncoding;\n		uniform int outputEncoding;\n\n		#include <encodings_pars_fragment>\n\n		vec4 inputTexelToLinear( vec4 value ) {\n\n			if ( inputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( inputEncoding == 1 ) {\n\n				return sRGBToLinear( value );\n\n			} else if ( inputEncoding == 2 ) {\n\n				return RGBEToLinear( value );\n\n			} else if ( inputEncoding == 3 ) {\n\n				return RGBMToLinear( value, 7.0 );\n\n			} else if ( inputEncoding == 4 ) {\n\n				return RGBMToLinear( value, 16.0 );\n\n			} else if ( inputEncoding == 5 ) {\n\n				return RGBDToLinear( value, 256.0 );\n\n			} else {\n\n				return GammaToLinear( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 linearToOutputTexel( vec4 value ) {\n\n			if ( outputEncoding == 0 ) {\n\n				return value;\n\n			} else if ( outputEncoding == 1 ) {\n\n				return LinearTosRGB( value );\n\n			} else if ( outputEncoding == 2 ) {\n\n				return LinearToRGBE( value );\n\n			} else if ( outputEncoding == 3 ) {\n\n				return LinearToRGBM( value, 7.0 );\n\n			} else if ( outputEncoding == 4 ) {\n\n				return LinearToRGBM( value, 16.0 );\n\n			} else if ( outputEncoding == 5 ) {\n\n				return LinearToRGBD( value, 256.0 );\n\n			} else {\n\n				return LinearToGamma( value, 2.2 );\n\n			}\n\n		}\n\n		vec4 envMapTexelToLinear( vec4 color ) {\n\n			return inputTexelToLinear( color );\n\n		}\n	\n\n			void main() {\n\n				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n				gl_FragColor = linearToOutputTexel( gl_FragColor );\n\n			}\n		",blending:0,depthTest:!1,depthWrite:!1})}function h_(a){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),H.call(this,a),this.type="catmullrom",this.closed=!0}function hZ(a){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),H.call(this,a),this.type="catmullrom"}function gd(a){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),H.call(this,a),this.type="catmullrom"}h.create=function(a,b){return console.log("THREE.Curve.create() has been deprecated"),a.prototype=Object.create(h.prototype),a.prototype.constructor=a,a.prototype.getPoint=b,a},Object.assign(aj.prototype,{fromPoints:function(a){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(a)}}),h_.prototype=Object.create(H.prototype),hZ.prototype=Object.create(H.prototype),gd.prototype=Object.create(H.prototype),Object.assign(gd.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),gT.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},gW.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(p.prototype,{extractUrlBase:function(a){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),fY.extractUrlBase(a)}}),p.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(ha.prototype,{center:function(a){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(a)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(a){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},size:function(a){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(a)}}),Object.assign(aF.prototype,{center:function(a){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(a)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(a){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},isIntersectionSphere:function(a){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)},size:function(a){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(a)}}),Object.assign(aO.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),cF.prototype.setFromMatrix=function(a){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(a)},gZ.prototype.center=function(a){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(a)},Object.assign(l,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(a){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),l.floorPowerOfTwo(a)},nextPowerOfTwo:function(a){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),l.ceilPowerOfTwo(a)}}),Object.assign(Q.prototype,{flattenToArrayOffset:function(a,b){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,b)},multiplyVector3:function(a){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(a){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),a.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},getInverse:function(a){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()}}),Object.assign(o.prototype,{extractPosition:function(a){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(a)},flattenToArrayOffset:function(a,b){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(a,b)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new b).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(a){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(a)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(a){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},multiplyVector4:function(a){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(a){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),a.transformDirection(this)},crossVector:function(a){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(a){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),a.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(a,b,c,d,e,f){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(a,b,d,c,e,f)},getInverse:function(a){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(a).invert()}}),am.prototype.isIntersectionLine=function(a){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(a)},Object.assign(G.prototype,{multiplyVector3:function(a){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),a.applyQuaternion(this)},inverse:function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()}}),Object.assign(bG.prototype,{isIntersectionBox:function(a){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(a)},isIntersectionPlane:function(a){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(a)},isIntersectionSphere:function(a){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(a)}}),Object.assign(ai.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(a,b){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(a,b)},midpoint:function(a){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(a)},normal:function(a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(a)},plane:function(a){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(a)}}),Object.assign(ai,{barycoordFromPoint:function(a,b,c,d,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ai.getBarycoord(a,b,c,d,e)},normal:function(a,b,c,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ai.getNormal(a,b,c,d)}}),Object.assign(bs.prototype,{extractAllPoints:function(a){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(a)},extrude:function(a){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new bg(this,a)},makeGeometry:function(a){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new cu(this,a)}}),Object.assign(c.prototype,{fromAttribute:function(a,b,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(b.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,b){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(b,a)},applyProjection:function(a){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(a)},fromAttribute:function(a,b,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)},distanceToManhattan:function(a){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(a)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(q.prototype,{fromAttribute:function(a,b,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(a,b,c)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(g.prototype,{getChildByName:function(a){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(a)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(a,b){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(b,a)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(a){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)}}),Object.defineProperties(g.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(a){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=a}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(t.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(t.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(df.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cU.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),db.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(h.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(a){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=a}}),A.prototype.setLens=function(b,a){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==a&&(this.filmGauge=a),this.setFocalLength(b)},Object.defineProperties(v.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(a){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=a}},shadowCameraLeft:{set:function(a){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=a}},shadowCameraRight:{set:function(a){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=a}},shadowCameraTop:{set:function(a){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=a}},shadowCameraBottom:{set:function(a){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=a}},shadowCameraNear:{set:function(a){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=a}},shadowCameraFar:{set:function(a){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=a}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(a){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=a}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(a){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=a}},shadowMapHeight:{set:function(a){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=a}}}),Object.defineProperties(k.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===bh},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(bh)}}}),Object.assign(k.prototype,{setDynamic:function(a){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?bh:cj),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(i.prototype,{addIndex:function(a){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(a)},addAttribute:function(b,a){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),a&&a.isBufferAttribute||a&&a.isInterleavedBufferAttribute?"index"===b?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(a),this):this.setAttribute(b,a):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(b,new k(arguments[1],arguments[2])))},addDrawCall:function(a,b,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(a,b)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(a){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(a)},applyMatrix:function(a){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(a)}}),Object.defineProperties(i.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(dp.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(a){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=a}}}),Object.defineProperties(he.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(a){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=a}}}),Object.defineProperties(T.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===bh},set:function(a){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(a)}}}),Object.assign(T.prototype,{setDynamic:function(a){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===a?bh:cj),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(bg.prototype,{getArrays:function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")}}),Object.assign(fp.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(hh.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(j.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new e}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(a){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(a){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=a}}}),Object.defineProperties(aZ.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(aY.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(a){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=a}}}),Object.defineProperties(M.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(a){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=a}}}),Object.assign(dH.prototype,{clearTarget:function(a,b,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(a),this.clear(b,c,d)},animate:function(a){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(a)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(a){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(a)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(dH.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=a}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(a){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=a}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(a){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===a?dM:aR}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ik.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(aI.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=a}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(a){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=a}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=a}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(a){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=a}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(a){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=a}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(a){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=a}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(a){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=a}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(a){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=a}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(a){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=a}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(a){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=a}}}),Object.defineProperties(eS.prototype,{load:{value:function(a){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var b=this;return(new fg).load(a,function(a){b.setBuffer(a)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),hm.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},bD.prototype.updateCubeMap=function(a,b){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(a,b)},bD.prototype.clear=function(a,b,c,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(a,b,c,d)},ip={merge:function(c,a,d){var b;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),a.isMesh&&(a.matrixAutoUpdate&&a.updateMatrix(),b=a.matrix,a=a.geometry),c.merge(a,b,d)},center:function(a){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),a.center()}},bd.crossOrigin=void 0,bd.loadTexture=function(d,c,e,f){var a,b;return console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead."),a=new eR,a.setCrossOrigin(this.crossOrigin),b=a.load(d,e,void 0,f),c&&(b.mapping=c),b},bd.loadTextureCube=function(d,c,e,f){var a,b;return console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead."),a=new eN,a.setCrossOrigin(this.crossOrigin),b=a.load(d,e,void 0,f),c&&(b.mapping=c),b},bd.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},bd.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},ij={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:fQ}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=fQ),a.ACESFilmicToneMapping=4,a.AddEquation=bA,a.AddOperation=2,a.AdditiveAnimationBlendMode=ff,a.AdditiveBlending=2,a.AlphaFormat=1021,a.AlwaysDepth=1,a.AlwaysStencilFunc=519,a.AmbientLight=fL,a.AmbientLightProbe=ht,a.AnimationClip=X,a.AnimationLoader=hS,a.AnimationMixer=hi,a.AnimationObjectGroup=jN,a.AnimationUtils=u,a.ArcCurve=cH,a.ArrayCamera=fZ,a.ArrowHelper=iC,a.Audio=eS,a.AudioAnalyser=hm,a.AudioContext=fm,a.AudioListener=js,a.AudioLoader=fg,a.AxesHelper=gG,a.AxisHelper=function(a){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new gG(a)},a.BackSide=1,a.BasicDepthPacking=3200,a.BasicShadowMap=0,a.BinaryTextureLoader=function(a){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new eO(a)},a.Bone=da,a.BooleanKeyframeTrack=eC,a.BoundingBoxHelper=function(a,b){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new gK(a,b)},a.Box2=ha,a.Box3=aF,a.Box3Helper=iE,a.BoxBufferGeometry=bf,a.BoxGeometry=bf,a.BoxHelper=gK,a.BufferAttribute=k,a.BufferGeometry=i,a.BufferGeometryLoader=fn,a.ByteType=1010,a.Cache=bt,a.Camera=az,a.CameraHelper=iH,a.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},a.CanvasTexture=dB,a.CatmullRomCurve3=H,a.CineonToneMapping=3,a.CircleBufferGeometry=dE,a.CircleGeometry=dE,a.ClampToEdgeWrapping=L,a.Clock=hq,a.ClosedSplineCurve3=h_,a.Color=e,a.ColorKeyframeTrack=eD,a.CompressedTexture=cD,a.CompressedTextureLoader=hR,a.ConeBufferGeometry=dJ,a.ConeGeometry=dJ,a.CubeCamera=bD,a.CubeReflectionMapping=cN,a.CubeRefractionMapping=cM,a.CubeTexture=aE,a.CubeTextureLoader=eN,a.CubeUVReflectionMapping=bK,a.CubeUVRefractionMapping=cQ,a.CubicBezierCurve=ag,a.CubicBezierCurve3=at,a.CubicInterpolant=ey,a.CullFaceBack=1,a.CullFaceFront=2,a.CullFaceFrontBack=3,a.CullFaceNone=0,a.Curve=h,a.CurvePath=bq,a.CustomBlending=5,a.CustomToneMapping=5,a.CylinderBufferGeometry=ca,a.CylinderGeometry=ca,a.Cylindrical=jo,a.DataTexture=aW,a.DataTexture2DArray=cl,a.DataTexture3D=cn,a.DataTextureLoader=eO,a.DataUtils=iy,a.DecrementStencilOp=7683,a.DecrementWrapStencilOp=34056,a.DefaultLoadingManager=hU,a.DepthFormat=bi,a.DepthStencilFormat=bX,a.DepthTexture=dC,a.DirectionalLight=fK,a.DirectionalLightHelper=iJ,a.DiscreteInterpolant=eB,a.DodecahedronBufferGeometry=cS,a.DodecahedronGeometry=cS,a.DoubleSide=2,a.DstAlphaFactor=206,a.DstColorFactor=208,a.DynamicBufferAttribute=function(a,b){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new k(a,b).setUsage(bh)},a.DynamicCopyUsage=35050,a.DynamicDrawUsage=bh,a.DynamicReadUsage=35049,a.EdgesGeometry=eZ,a.EdgesHelper=function(b,a){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new N(new eZ(b.geometry),new w({color:void 0!==a?a:16777215}))},a.EllipseCurve=V,a.EqualDepth=4,a.EqualStencilFunc=514,a.EquirectangularReflectionMapping=de,a.EquirectangularRefractionMapping=dm,a.Euler=en,a.EventDispatcher=aN,a.ExtrudeBufferGeometry=bg,a.ExtrudeGeometry=bg,a.Face3=fo,a.Face4=function(a,b,c,g,d,e,f){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new fo(a,b,c,d,e,f)},a.FaceColors=1,a.FileLoader=ae,a.FlatShading=1,a.Float16BufferAttribute=ds,a.Float32Attribute=function(a,b){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new f(a,b)},a.Float32BufferAttribute=f,a.Float64Attribute=function(a,b){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new dr(a,b)},a.Float64BufferAttribute=dr,a.FloatType=aw,a.Fog=gt,a.FogExp2=gu,a.Font=hy,a.FontLoader=hx,a.FrontSide=0,a.Frustum=cF,a.GLBufferAttribute=hf,a.GLSL1="100",a.GLSL3=eW,a.GammaEncoding=fb,a.GeometryUtils=ip,a.GreaterDepth=6,a.GreaterEqualDepth=5,a.GreaterEqualStencilFunc=518,a.GreaterStencilFunc=516,a.GridHelper=gT,a.Group=br,a.HalfFloatType=cr,a.HemisphereLight=fC,a.HemisphereLightHelper=iM,a.HemisphereLightProbe=hu,a.IcosahedronBufferGeometry=dU,a.IcosahedronGeometry=dU,a.ImageBitmapLoader=hB,a.ImageLoader=cJ,a.ImageUtils=bd,a.ImmediateRenderObject=dZ,a.IncrementStencilOp=7682,a.IncrementWrapStencilOp=34055,a.InstancedBufferAttribute=fA,a.InstancedBufferGeometry=dp,a.InstancedInterleavedBuffer=hg,a.InstancedMesh=fX,a.Int16Attribute=function(a,b){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new du(a,b)},a.Int16BufferAttribute=du,a.Int32Attribute=function(a,b){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new dt(a,b)},a.Int32BufferAttribute=dt,a.Int8Attribute=function(a,b){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dy(a,b)},a.Int8BufferAttribute=dy,a.IntType=1013,a.InterleavedBuffer=T,a.InterleavedBufferAttribute=bv,a.Interpolant=S,a.InterpolateDiscrete=ch,a.InterpolateLinear=cf,a.InterpolateSmooth=dL,a.InvertStencilOp=5386,a.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},a.KeepStencilOp=dR,a.KeyframeTrack=F,a.LOD=df,a.LatheBufferGeometry=dV,a.LatheGeometry=dV,a.Layers=eE,a.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},a.LessDepth=2,a.LessEqualDepth=3,a.LessEqualStencilFunc=515,a.LessStencilFunc=513,a.Light=v,a.LightProbe=ac,a.Line=$,a.Line3=gZ,a.LineBasicMaterial=w,a.LineCurve=O,a.LineCurve3=ar,a.LineDashedMaterial=bC,a.LineLoop=fO,a.LinePieces=1,a.LineSegments=N,a.LineStrip=0,a.LinearEncoding=aR,a.LinearFilter=D,a.LinearInterpolant=ej,a.LinearMipMapLinearFilter=1008,a.LinearMipMapNearestFilter=1007,a.LinearMipmapLinearFilter=cx,a.LinearMipmapNearestFilter=gw,a.LinearToneMapping=1,a.Loader=p,a.LoaderUtils=fY,a.LoadingManager=f_,a.LogLuvEncoding=3003,a.LoopOnce=2200,a.LoopPingPong=2202,a.LoopRepeat=2201,a.LuminanceAlphaFormat=1025,a.LuminanceFormat=1024,a.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},a.Material=j,a.MaterialLoader=fG,a.Math=l,a.MathUtils=l,a.Matrix3=Q,a.Matrix4=o,a.MaxEquation=104,a.Mesh=t,a.MeshBasicMaterial=W,a.MeshDepthMaterial=bl,a.MeshDistanceMaterial=bx,a.MeshFaceMaterial=function(a){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),a},a.MeshLambertMaterial=bH,a.MeshMatcapMaterial=bE,a.MeshNormalMaterial=bI,a.MeshPhongMaterial=aZ,a.MeshPhysicalMaterial=aY,a.MeshStandardMaterial=aC,a.MeshToonMaterial=bJ,a.MinEquation=103,a.MirroredRepeatWrapping=dA,a.MixOperation=1,a.MultiMaterial=function(a){return void 0===a&&(a=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),a.isMultiMaterial=!0,a.materials=a,a.clone=function(){return a.slice()},a},a.MultiplyBlending=4,a.MultiplyOperation=0,a.NearestFilter=C,a.NearestMipMapLinearFilter=1005,a.NearestMipMapNearestFilter=1004,a.NearestMipmapLinearFilter=fy,a.NearestMipmapNearestFilter=fz,a.NeverDepth=0,a.NeverStencilFunc=512,a.NoBlending=0,a.NoColors=0,a.NoToneMapping=0,a.NormalAnimationBlendMode=ek,a.NormalBlending=1,a.NotEqualDepth=7,a.NotEqualStencilFunc=517,a.NumberKeyframeTrack=cK,a.Object3D=g,a.ObjectLoader=iX,a.ObjectSpaceNormalMap=1,a.OctahedronBufferGeometry=co,a.OctahedronGeometry=co,a.OneFactor=201,a.OneMinusDstAlphaFactor=207,a.OneMinusDstColorFactor=209,a.OneMinusSrcAlphaFactor=205,a.OneMinusSrcColorFactor=203,a.OrthographicCamera=cp,a.PCFShadowMap=1,a.PCFSoftShadowMap=2,a.PMREMGenerator=id,a.ParametricBufferGeometry=bV,a.ParametricGeometry=bV,a.Particle=function(a){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new di(a)},a.ParticleBasicMaterial=function(a){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ak(a)},a.ParticleSystem=function(a,b){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new cL(a,b)},a.ParticleSystemMaterial=function(a){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ak(a)},a.Path=aj,a.PerspectiveCamera=A,a.Plane=am,a.PlaneBufferGeometry=cB,a.PlaneGeometry=cB,a.PlaneHelper=iD,a.PointCloud=function(a,b){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new cL(a,b)},a.PointCloudMaterial=function(a){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ak(a)},a.PointLight=fE,a.PointLightHelper=iO,a.Points=cL,a.PointsMaterial=ak,a.PolarGridHelper=iL,a.PolyhedronBufferGeometry=aT,a.PolyhedronGeometry=aT,a.PositionalAudio=jy,a.PropertyBinding=I,a.PropertyMixer=hl,a.QuadraticBezierCurve=aq,a.QuadraticBezierCurve3=au,a.Quaternion=G,a.QuaternionKeyframeTrack=ec,a.QuaternionLinearInterpolant=eF,a.REVISION=fQ,a.RGBADepthPacking=3201,a.RGBAFormat=Y,a.RGBAIntegerFormat=1033,a.RGBA_ASTC_10x10_Format=37819,a.RGBA_ASTC_10x5_Format=37816,a.RGBA_ASTC_10x6_Format=37817,a.RGBA_ASTC_10x8_Format=37818,a.RGBA_ASTC_12x10_Format=37820,a.RGBA_ASTC_12x12_Format=37821,a.RGBA_ASTC_4x4_Format=37808,a.RGBA_ASTC_5x4_Format=37809,a.RGBA_ASTC_5x5_Format=37810,a.RGBA_ASTC_6x5_Format=37811,a.RGBA_ASTC_6x6_Format=37812,a.RGBA_ASTC_8x5_Format=37813,a.RGBA_ASTC_8x6_Format=37814,a.RGBA_ASTC_8x8_Format=37815,a.RGBA_BPTC_Format=36492,a.RGBA_ETC2_EAC_Format=fh,a.RGBA_PVRTC_2BPPV1_Format=fq,a.RGBA_PVRTC_4BPPV1_Format=fr,a.RGBA_S3TC_DXT1_Format=fw,a.RGBA_S3TC_DXT3_Format=fv,a.RGBA_S3TC_DXT5_Format=fu,a.RGBDEncoding=gA,a.RGBEEncoding=fa,a.RGBEFormat=1023,a.RGBFormat=aK,a.RGBIntegerFormat=1032,a.RGBM16Encoding=gy,a.RGBM7Encoding=gx,a.RGB_ETC1_Format=36196,a.RGB_ETC2_Format=fk,a.RGB_PVRTC_2BPPV1_Format=fs,a.RGB_PVRTC_4BPPV1_Format=ft,a.RGB_S3TC_DXT1_Format=fx,a.RGFormat=1030,a.RGIntegerFormat=1031,a.RawShaderMaterial=aS,a.Ray=bG,a.Raycaster=he,a.RectAreaLight=fT,a.RedFormat=1028,a.RedIntegerFormat=1029,a.ReinhardToneMapping=2,a.RepeatWrapping=dq,a.ReplaceStencilOp=7681,a.ReverseSubtractEquation=102,a.RingBufferGeometry=dW,a.RingGeometry=dW,a.SRGB8_ALPHA8_ASTC_10x10_Format=37851,a.SRGB8_ALPHA8_ASTC_10x5_Format=37848,a.SRGB8_ALPHA8_ASTC_10x6_Format=37849,a.SRGB8_ALPHA8_ASTC_10x8_Format=37850,a.SRGB8_ALPHA8_ASTC_12x10_Format=37852,a.SRGB8_ALPHA8_ASTC_12x12_Format=37853,a.SRGB8_ALPHA8_ASTC_4x4_Format=37840,a.SRGB8_ALPHA8_ASTC_5x4_Format=37841,a.SRGB8_ALPHA8_ASTC_5x5_Format=37842,a.SRGB8_ALPHA8_ASTC_6x5_Format=37843,a.SRGB8_ALPHA8_ASTC_6x6_Format=37844,a.SRGB8_ALPHA8_ASTC_8x5_Format=37845,a.SRGB8_ALPHA8_ASTC_8x6_Format=37846,a.SRGB8_ALPHA8_ASTC_8x8_Format=37847,a.Scene=fp,a.SceneUtils=ij,a.ShaderChunk=n,a.ShaderLib=Z,a.ShaderMaterial=M,a.ShadowMaterial=bN,a.Shape=bs,a.ShapeBufferGeometry=cu,a.ShapeGeometry=cu,a.ShapePath=hA,a.ShapeUtils=aB,a.ShortType=1011,a.Skeleton=cU,a.SkeletonHelper=gW,a.SkinnedMesh=db,a.SmoothShading=2,a.Sphere=aO,a.SphereBufferGeometry=cv,a.SphereGeometry=cv,a.Spherical=ju,a.SphericalHarmonics3=hG,a.Spline=gd,a.SplineCurve=ao,a.SplineCurve3=hZ,a.SpotLight=fD,a.SpotLightHelper=i$,a.Sprite=di,a.SpriteMaterial=bw,a.SrcAlphaFactor=204,a.SrcAlphaSaturateFactor=210,a.SrcColorFactor=202,a.StaticCopyUsage=35046,a.StaticDrawUsage=cj,a.StaticReadUsage=35045,a.StereoCamera=jl,a.StreamCopyUsage=35042,a.StreamDrawUsage=35040,a.StreamReadUsage=35041,a.StringKeyframeTrack=eG,a.SubtractEquation=101,a.SubtractiveBlending=3,a.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},a.TangentSpaceNormalMap=0,a.TetrahedronBufferGeometry=ea,a.TetrahedronGeometry=ea,a.TextBufferGeometry=eb,a.TextGeometry=eb,a.Texture=r,a.TextureLoader=eR,a.TorusBufferGeometry=ed,a.TorusGeometry=ed,a.TorusKnotBufferGeometry=ee,a.TorusKnotGeometry=ee,a.Triangle=ai,a.TriangleFanDrawMode=2,a.TriangleStripDrawMode=1,a.TrianglesDrawMode=0,a.TubeBufferGeometry=eg,a.TubeGeometry=eg,a.UVMapping=dc,a.Uint16Attribute=function(a,b){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new cb(a,b)},a.Uint16BufferAttribute=cb,a.Uint32Attribute=function(a,b){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new b$(a,b)},a.Uint32BufferAttribute=b$,a.Uint8Attribute=function(a,b){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new dx(a,b)},a.Uint8BufferAttribute=dx,a.Uint8ClampedAttribute=function(a,b){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new dw(a,b)},a.Uint8ClampedBufferAttribute=dw,a.Uniform=hh,a.UniformsLib=d,a.UniformsUtils=hH,a.UnsignedByteType=bT,a.UnsignedInt248Type=cd,a.UnsignedIntType=cs,a.UnsignedShort4444Type=1017,a.UnsignedShort5551Type=1018,a.UnsignedShort565Type=1019,a.UnsignedShortType=ct,a.VSMShadowMap=3,a.Vector2=c,a.Vector3=b,a.Vector4=q,a.VectorKeyframeTrack=cO,a.Vertex=function(a,c,d){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new b(a,c,d)},a.VertexColors=2,a.VideoTexture=gr,a.WebGL1Renderer=gv,a.WebGLCubeRenderTarget=fS,a.WebGLMultisampleRenderTarget=ix,a.WebGLRenderTarget=aI,a.WebGLRenderTargetCube=function(a,c,b){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new fS(a,b)},a.WebGLRenderer=dH,a.WebGLUtils=ii,a.WireframeGeometry=eA,a.WireframeHelper=function(b,a){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new N(new eA(b.geometry),new w({color:void 0!==a?a:16777215}))},a.WrapAroundEnding=cg,a.XHRLoader=function(a){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new ae(a)},a.ZeroCurvatureEnding=bn,a.ZeroFactor=200,a.ZeroSlopeEnding=bm,a.ZeroStencilOp=0,a.sRGBEncoding=dM,Object.defineProperty(a,"__esModule",{value:!0})})